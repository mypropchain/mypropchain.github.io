import{j as e,L as ms,c as Xs,r as Zs,f as et,a as Oe,b as hs,d as xs,e as we,g as Te,h as Pe,i as r,u as Re,k as D,M as ae,B as st,C as tt,X as at,Y as lt,T as nt,l as rt,m as it,n as Be,S as We,o as Ke,E as Je,p as pe,P as ot,q as ct,s as dt,F as ut,t as mt,v as ht,H as xt,w as pt,x as je,y as $,z as jt,A as ft,D as gt,G as Fe,I as vt,J as ss,U as Nt,K as yt,O as ps,N as b,Q as Y,R as js,V as fe,W as He,Z as he,_ as X,$ as fs,a0 as gs,a1 as vs,a2 as Xe,a3 as Ns,a4 as ys,a5 as Me,a6 as Z,a7 as be,a8 as Le,a9 as re,aa as ee,ab as W,ac as bt,ad as St,ae as ts,af as Ct,ag as wt,ah as kt,ai as Et,aj as At,ak as It,al as Ft,am as Ot,an as Tt,ao as as,ap as Pt,aq as Rt,ar as ls,as as ns,at as Mt,au as se,av as Lt,aw as Dt,ax as Ut}from"./vendor-BjPm7Gn8.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))x(c);new MutationObserver(c=>{for(const a of c)if(a.type==="childList")for(const n of a.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&x(n)}).observe(document,{childList:!0,subtree:!0});function l(c){const a={};return c.integrity&&(a.integrity=c.integrity),c.referrerPolicy&&(a.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?a.credentials="include":c.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function x(c){if(c.ep)return;c.ep=!0;const a=l(c);fetch(c.href,a)}})();const rs=()=>e.jsx(e.Fragment,{children:e.jsxs("div",{className:"d-flex flex-column justify-content-center align-items-center",children:[e.jsx("h1",{children:"404"}),e.jsx("p",{children:"Page not found"}),e.jsx("br",{className:""}),e.jsx("p",{children:"Something is wrong, the page you trying to acces do not exist"}),e.jsx("p",{children:"Or you have not enought rights"}),e.jsx("br",{className:""}),e.jsx(ms,{to:"/",children:"Go to Home"})]})}),qt="https://hocolapi.joselimardo.com/api",xe=Xs({baseQuery:Zs(et({baseUrl:qt,prepareHeaders:(s,{getState:t})=>{const l=t().auth.token;if(l)return s.set("Authorization",`Bearer ${l}`),s.set("Content-Type","application/json"),s}})),keepUnusedDataFor:60,refetchOnMountOrArgChange:!0,refetchOnFocus:!0,refetchOnReconnect:!0,tagTypes:["Users","Tenants","Assets","Locations"],endpoints:s=>({})}),$t=s=>Oe.create({baseURL:"https://hocolapi.joselimardo.com/api",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`}}),zt=Oe.create({baseURL:"https://hocolapi.joselimardo.com/api",headers:{"Content-Type":"application/json"}}),Bt=s=>Oe.create({baseURL:"https://hocolapi.joselimardo.com/api",headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${s}`}}),Ht=async(s,t,l)=>{try{return await $t(t).post(`/${s}`,l)}catch(x){return x}},Vt=async s=>{try{const t=await zt.post("/auth/login",s);if(t.data.token){const l=hs(t.data.token),x={loading:!1,isLoggedIn:!0,token:t.data.token,active:l.user_active,deleted:l.user_is_deleted,error:null};sessionStorage.setItem("session",JSON.stringify(x,null,2))}return t.data}catch(t){throw t}},bs=async(s,t,l)=>{console.log("DATOS RECIBIDOS",s,t,l);try{return await Bt(t).post(`/${s}`,l)}catch(x){throw x}};let ge=JSON.parse(sessionStorage.getItem("session"));const ze=xs("auth/loginUser",async(s,t)=>{try{return await Vt(s)}catch(l){return t.rejectWithValue(l.response.data)}}),Ss=xs("auth/logoutUser",async(s,t)=>{try{sessionStorage.removeItem("session")}catch(l){return t.rejectWithValue(l.response)}}),Yt={loading:ge?ge.loading:!1,isLoggedIn:ge?ge.isLoggedIn:!1,token:ge?ge.token:null,error:ge?ge.error:null},_t=we({name:"auth",initialState:Yt,extraReducers:s=>{s.addCase(ze.pending,t=>{t.loading=!0,t.isLoggedIn=!1,t.token=null,t.error=null}).addCase(ze.fulfilled,(t,l)=>{t.loading=!1,t.isLoggedIn=!0,t.token=l.payload.token,t.error=null}).addCase(ze.rejected,(t,l)=>{t.loading=!1,t.isLoggedIn=!1,t.token=null,t.error=l.payload}).addCase(Ss.fulfilled,t=>{t.loading=!1,t.isLoggedIn=!1,t.token=null,t.error=null})}}),Gt=_t.reducer,Qt=s=>s.auth.token,Wt=s=>s.auth.isLoggedIn,Cs=Te({}),Jt=Cs.getInitialState(),ne=xe.injectEndpoints({endpoints:s=>({getUsers:s.query({query:()=>"/users",providesTags:["Users"]}),getUser:s.query({query:t=>`/users/${t}`}),getUserId:s.query({query:t=>`/users/${t}`}),getMe:s.query({query:()=>"/users/me",extraOptions:{maxRetries:0}}),addNewUser:s.mutation({query:t=>({url:"/users",method:"POST",body:t}),invalidatesTags:["Users"],extraOptions:{maxRetries:0}}),updateUser:s.mutation({query:t=>({url:`/users/${t.id}`,method:"PUT",body:{...t}}),invalidatesTags:["Users"]}),deleteUser:s.mutation({query:({id:t})=>({url:`/users/${t}`,method:"DELETE"}),invalidatesTags:["Users"]}),softDeleteUser:s.mutation({query:t=>({url:"/users/soft_delete/",method:"PUT",body:{...t}}),invalidatesTags:["Users"]}),changePassword:s.mutation({query:t=>({url:"/users/change_password/",method:"POST",body:{...t}}),invalidatesTags:["Users"]}),resetPassword:s.mutation({query:t=>({url:`/users/reset_password/${t}`,method:"POST"}),invalidatesTags:["Users"]})})}),{useGetUsersQuery:Kt,useGetUserQuery:Xt,useGetUserIdQuery:Zt,useGetMeQuery:rn,useAddNewUserMutation:ea,useUpdateUserMutation:ws,useDeleteUserMutation:on,useSoftDeleteUserMutation:cn,useChangePasswordMutation:dn,useResetPasswordMutation:un}=ne,sa=ne.endpoints.getUsers.select(),ta=Pe(sa,s=>s.data);Cs.getSelectors(s=>ta(s)??Jt);const aa={users:[],user:null,userId:null,loadingId:!1,errorId:null,loading:!1,error:null},ks=we({name:"users",initialState:aa,reducers:{setUser(s,t){s.user=t.payload},setUsers(s,t){s.users=t.payload}},extraReducers:s=>{s.addMatcher(ne.endpoints.getUsers.matchFulfilled,(t,{payload:l})=>{t.users=l.users,t.loading=!1,t.error=null}),s.addMatcher(ne.endpoints.getUsers.matchPending,t=>{t.loading=!0,t.error=null}),s.addMatcher(ne.endpoints.getUsers.matchRejected,(t,{payload:l})=>{t.loading=!1,t.error=l}),s.addMatcher(ne.endpoints.getUser.matchFulfilled,(t,{payload:l})=>{t.user=l[0],t.loading=!1,t.error=null}),s.addMatcher(ne.endpoints.getUserId.matchFulfilled,(t,{payload:l})=>{t.userId=l[0],t.loading=!1,t.error=null}),s.addMatcher(ne.endpoints.getMe.matchPending,t=>{t.loading=!0,t.error=null}),s.addMatcher(ne.endpoints.getMe.matchRejected,(t,{payload:l})=>{t.loading=!1,t.error=l}),s.addMatcher(ne.endpoints.getMe.matchFulfilled,(t,{payload:l})=>{t.user=l.user,t.loading=!1,t.error=null}),s.addMatcher(ne.endpoints.getUser.matchPending,t=>{t.loading=!0,t.error=null}),s.addMatcher(ne.endpoints.getUser.matchRejected,(t,{payload:l})=>{t.loading=!1,t.error=l}),s.addMatcher(ne.endpoints.getUserId.matchPending,t=>{t.loadingId=!0,t.errorId=null}),s.addMatcher(ne.endpoints.getUserId.matchRejected,(t,{payload:l})=>{t.loadingId=!1,t.errorId=l})}}),is=ks.actions,la=ks.reducer,Es=Te({}),na=Es.getInitialState(),me=xe.injectEndpoints({endpoints:s=>({getLocations:s.query({query:()=>"/locations",providesTags:["Locations"]}),getLocation:s.query({query:t=>`/locations/${t}`,providesTags:["Locations"]}),addLocation:s.mutation({query:t=>({url:"/locations",method:"POST",body:t}),invalidatesTags:["Locations"],extraOptions:{maxRetries:0}}),updateLocation:s.mutation({query:t=>({url:`/locations/${t.id}`,method:"PUT",body:{...t}}),invalidatesTags:["Locations"]})})}),{useGetLocationQuery:ra,useGetLocationsQuery:Ye,useAddLocationMutation:ia,useUpdateLocationMutation:As}=me,oa=me.endpoints.getLocations.select(),ca=Pe(oa,s=>s.data);Es.getSelectors(s=>ca(s)??na);const da={locations:[],location:null,loading:!1,error:null},Is=we({name:"locations",initialState:da,reducers:{setLocation(s,t){s.location=t.payload},setLocations(s,t){s.locations=t.payload.data}},extraReducers:s=>{s.addMatcher(me.endpoints.getLocations.matchFulfilled,(t,{payload:l})=>{t.locations=l.data,t.loading=!1,t.error=null}),s.addMatcher(me.endpoints.getLocations.matchPending,t=>{t.loading=!0,t.error=null}),s.addMatcher(me.endpoints.getLocations.matchRejected,(t,{payload:l})=>{t.loading=!1,t.error=l}),s.addMatcher(me.endpoints.getLocation.matchFulfilled,(t,{payload:l})=>{t.location=l.data,t.loading=!1,t.error=null}),s.addMatcher(me.endpoints.getLocation.matchPending,t=>{t.loading=!0,t.error=null}),s.addMatcher(me.endpoints.getLocation.matchRejected,(t,{payload:l})=>{t.loading=!1,t.error=l})}}),os=Is.actions,ua=Is.reducer,Fs=Te({}),ma=Fs.getInitialState(),ve=xe.injectEndpoints({endpoints:s=>({getTenants:s.query({query:()=>"/tenants",providesTags:["Tenants"]}),getTenant:s.query({query:t=>`/tenants/${t}`}),addTenant:s.mutation({query:t=>({url:"/tenants",method:"POST",body:t}),invalidatesTags:["Tenants"],extraOptions:{maxRetries:0}}),deleteTenant:s.mutation({query:t=>({url:`/tenants/${t}`,method:"DELETE"}),invalidatesTags:["Tenants"],extraOptions:{maxRetries:0}}),updateTenant:s.mutation({query:t=>({url:`/tenants/${t.id}`,method:"PUT",body:t}),invalidatesTags:["Tenants"],extraOptions:{maxRetries:0}})})}),{useGetTenantQuery:ha,useGetTenantsQuery:Os,useAddTenantMutation:xa,useDeleteTenantMutation:pa,useUpdateTenantMutation:Ts}=ve,ja=ve.endpoints.getTenants.select(),fa=Pe(ja,s=>s.data);Fs.getSelectors(s=>fa(s)??ma);const ga={tenants:[],tenant:null,loading:!1,error:null},Ps=we({name:"tenants",initialState:ga,reducers:{setTenant(s,t){s.tenant=t.payload},setTenants(s,t){s.tenants=t.payload.data}},extraReducers:s=>{s.addMatcher(ve.endpoints.getTenants.matchFulfilled,(t,{payload:l})=>{t.tenants=l.data,t.loading=!1,t.error=null}),s.addMatcher(ve.endpoints.getTenants.matchPending,t=>{t.loading=!0,t.error=null}),s.addMatcher(ve.endpoints.getTenants.matchRejected,(t,{payload:l})=>{t.loading=!1,t.error=l}),s.addMatcher(ve.endpoints.getTenant.matchFulfilled,(t,{payload:l})=>{t.tenant=l.data,t.loading=!1,t.error=null}),s.addMatcher(ve.endpoints.getTenant.matchPending,t=>{t.loading=!0,t.error=null}),s.addMatcher(ve.endpoints.getTenant.matchRejected,(t,{payload:l})=>{t.loading=!1,t.error=l})}}),cs=Ps.actions,va=Ps.reducer,Rs=Te({}),Na=Rs.getInitialState(),Ne=xe.injectEndpoints({endpoints:s=>({getAssets:s.query({query:()=>"/assets",providesTags:["Assets"]}),getAsset:s.query({query:t=>`/assets/${t}`,providesTags:["Assets"]}),addAsset:s.mutation({query:t=>({url:"/assets",method:"POST",body:t}),invalidatesTags:["Assets"],extraOptions:{maxRetries:0}}),updateAsset:s.mutation({query:t=>({url:`/assets/${t.id}`,method:"PUT",body:{...t}}),invalidatesTags:["Assets"],providesTags:["Assets"]})})}),{useGetAssetQuery:ya,useGetAssetsQuery:Ms,useAddAssetMutation:ba,useUpdateAssetMutation:Ls}=Ne,Sa=Ne.endpoints.getAssets.select(),Ca=Pe(Sa,s=>s.data);Rs.getSelectors(s=>Ca(s)??Na);const wa={assets:[],asset:null,loading:!1,error:null},Ds=we({name:"assets",initialState:wa,reducers:{setAsset(s,t){s.asset=t.payload},setAssets(s,t){s.assets=t.payload.data}},extraReducers:s=>{s.addMatcher(Ne.endpoints.getAssets.matchFulfilled,(t,{payload:l})=>{t.assets=l.data,t.loading=!1,t.error=null}),s.addMatcher(Ne.endpoints.getAssets.matchPending,t=>{t.loading=!0,t.error=null}),s.addMatcher(Ne.endpoints.getAssets.matchRejected,(t,{payload:l})=>{t.loading=!1,t.error=l}),s.addMatcher(Ne.endpoints.getAsset.matchFulfilled,(t,{payload:l})=>{t.asset=l.data,t.loading=!1,t.error=null}),s.addMatcher(Ne.endpoints.getAsset.matchPending,t=>{t.loading=!0,t.error=null}),s.addMatcher(Ne.endpoints.getAsset.matchRejected,(t,{payload:l})=>{t.loading=!1,t.error=l})}}),ds=Ds.actions,ka=Ds.reducer,Us=r.createContext(),qs=r.createContext(),Ea=({children:s})=>{const t=Re(),[l,x]=r.useState(!1),c=D(Wt),a=D(Qt),[n,i]=r.useState(null),[o,d]=r.useState(!0),[h,v]=r.useState(null),[f,p]=r.useState(null),{data:j,error:w,isLoading:k,isSuccess:u}=Xt(f,{skip:o});r.useEffect(()=>{const I=()=>{const T=window.matchMedia("(max-width: 768px)");x(T.matches)};return I(),window.addEventListener("resize",I),()=>window.removeEventListener("resize",I)},[]),r.useEffect(()=>{if(a){const I=hs(a);v({role:I.role,email:I.email,tenantId:I.tenantId}),p(I.id),d(!1)}},[a]),r.useEffect(()=>{u&&(i(j),n&&n.name&&n.lastName?v({...h,name:j[0].name,lastName:j[0].lastname}):console.error("User object or user.name or user.lastName is undefined."))},[u,j]);const g=async I=>{await t(ze(I)).then(T=>{var P;console.log("login",T),((P=T.error)==null?void 0:P.message)==="Rejected"&&ae.error({title:"Invalid login attempt",content:`${T.payload.message}`})})},m=()=>{d(!0),t(ds.setAssets([])),t(ds.setAsset(null)),t(os.setLocations([])),t(os.setLocation(null)),t(cs.setTenants([])),t(cs.setTenant(null)),t(is.setUsers([])),t(is.setUser(null)),t(xe.util.resetApiState())},S=async()=>{await t(Ss()).then(()=>{d(!0),m()})};if(k)return e.jsx("div",{children:"We are loading data, please wait..."});const N={isLoggedIn:c,token:a,login:g,logout:S,credentials:h},A={isMobile:l};return e.jsx(Us.Provider,{value:N,children:e.jsx(qs.Provider,{value:A,children:s})})},oe=()=>r.useContext(Us),Aa=[{name:"Enero",permisos:4e3,pv:2400,amt:2400},{name:"Febrero",permisos:3e3,pv:1398,amt:2210},{name:"Marzo",permisos:2e3,pv:9800,amt:2290},{name:"Abril",permisos:2780,pv:3908,amt:2e3},{name:"Mayo",permisos:1890,pv:4800,amt:2181},{name:"Junio",permisos:2390,pv:3800,amt:2500}];function $s(){return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"h-100 w-100 p-3",children:[" ",e.jsx("h6",{className:"text-start ",children:"Cantidad de permisos por mes"}),e.jsxs(st,{width:400,height:200,data:Aa,margin:{top:5,right:30,left:20,bottom:5},children:[e.jsx(tt,{strokeDasharray:"3 3"}),e.jsx(at,{dataKey:"name"}),e.jsx(lt,{}),e.jsx(nt,{}),e.jsx(rt,{}),e.jsx(it,{dataKey:"permisos",fill:"#82ca9d"})]})]})})}const Ia=()=>e.jsxs("div",{className:"row",children:[e.jsx("h6",{className:"mb-3",children:"Estadísticas en tiempo real"}),e.jsx("div",{className:"col",children:e.jsx("div",{className:"d-flex justify-content-center",children:e.jsx(Be,{bordered:!0,style:{width:300},children:e.jsx(We,{title:"Completados",value:2e4,precision:0,valueStyle:{color:"#3f8600"},prefix:e.jsx(Ke,{}),suffix:""})})})}),e.jsx("div",{className:"col",children:e.jsx("div",{className:"d-flex justify-content-center",children:e.jsx(Be,{bordered:!0,style:{width:300},children:e.jsx(We,{title:"En proceso",value:560,precision:0,valueStyle:{color:"#cf1322"},prefix:e.jsx(Je,{}),suffix:""})})})})]}),Fa=()=>{const c=[{impreso:{permisos:2e4,hojas:1e5,impresas:1e5}},{digital:{permisos:2e4,hojas:1e5,impresas:2e4}}].map((n,i)=>({key:i,modo:Object.keys(n)[0],permisos:n[Object.keys(n)[0]].permisos,hojas:n[Object.keys(n)[0]].hojas,impresas:n[Object.keys(n)[0]].impresas})).map(n=>({...n,resmas:(n.impresas/500).toFixed(2),peso:(n.impresas/500*2.3).toFixed(2),co2:(n.impresas/500*2.3*1.84/1e3).toFixed(2)})),a=[{title:"Modo",dataIndex:"modo",key:"modo",render:n=>e.jsx("a",{style:{color:"blue",fontWeight:600},children:n+" -->"})},{title:"Permisos",dataIndex:"permisos",key:"permisos",render:n=>e.jsx("a",{children:n})},{title:"Hojas",dataIndex:"hojas",key:"hojas",render:n=>e.jsx("a",{children:n})},{title:"Impresas",dataIndex:"impresas",key:"impresas",render:n=>e.jsx("a",{children:n})},{title:"Resmas",dataIndex:"resmas",key:"resmas",render:n=>e.jsx("a",{children:n})},{title:"Peso (kg)",dataIndex:"peso",key:"peso",render:n=>e.jsx("a",{children:n})},{title:"CO2 (kg)",dataIndex:"co2",key:"co2",render:n=>e.jsx("a",{style:{color:"green",fontWeight:600},children:n})}];return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"p-3",children:[e.jsx("h6",{className:"mb-3",children:"Reduccion en huella de carbono"}),e.jsx("div",{className:"row justify-content-center",children:e.jsx("div",{className:"col-10",children:e.jsx(pe,{columns:a,dataSource:c,pagination:!1})})})]})})};function qe(s){const{title:t,value:l,color:x,prefix:c,sufix:a}=s;return e.jsx("div",{className:"col-md-6 p-3 h-50",children:e.jsx("div",{className:"box-shadow w-100 h-100",children:e.jsx(We,{className:"statistic",title:t,value:l,precision:0,valueStyle:{color:x},prefix:c,suffix:a})})})}const Oa=()=>{const c=[{impreso:{permisos:2e4,hojas:1e5,impresas:1e5}},{digital:{permisos:2e4,hojas:1e5,impresas:2e4}}].map((a,n)=>({key:n,modo:Object.keys(a)[0],permisos:a[Object.keys(a)[0]].permisos,hojas:a[Object.keys(a)[0]].hojas,impresas:a[Object.keys(a)[0]].impresas})).map(a=>({...a,resmas:(a.impresas/500).toFixed(2),peso:(a.impresas/500*2.3).toFixed(2),co2:(a.impresas/500*2.3*1.84/1e3).toFixed(2)}));return e.jsx(e.Fragment,{children:e.jsx("div",{className:"container h-100 p-3",children:e.jsxs("div",{className:"h-100 d-flex flex-wrap",children:[e.jsxs("div",{className:"w-100  d-flex flex-wrap h-50",children:[e.jsxs("div",{className:"d-flex col-md-7 flex-wrap",children:[e.jsx(qe,{title:"Completados",value:2e4,color:"#3f8600",prefix:e.jsx(Ke,{})}),e.jsx(qe,{title:"En proceso",value:560,color:"#cf1322",prefix:e.jsx(Je,{})}),e.jsx(qe,{title:"En proceso",value:560,color:"#cf1322",prefix:e.jsx(Je,{})}),e.jsx(qe,{title:"Porcentaje de reducción de huella de carbono:",value:((c[0].co2-c[1].co2)/c[0].co2*100).toFixed(2),color:"#cf1322",prefix:"",sufix:e.jsx(ot,{})})]}),e.jsx("div",{className:"col-md-5 p-3",children:e.jsx("div",{className:"box-shadow w-100 h-100",children:e.jsx($s,{})})})]}),e.jsx("div",{className:"w-100 d-flex flex-wrap h-50",children:e.jsx("div",{className:"col-md-12 p-3",children:e.jsx("div",{className:"box-shadow w-100 h-100",children:e.jsx(Fa,{})})})})]})})})},Ta=()=>e.jsx(e.Fragment,{children:e.jsx("div",{className:"container",children:e.jsxs("div",{className:"",style:{marginTop:"20px"},children:[e.jsx("h3",{style:{color:"blue"},children:"Estadísticas"}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col box1 me-1",children:e.jsx("div",{className:"d-flex justify-content-center mt-5",children:e.jsx($s,{})})}),e.jsx("div",{className:"col box1 ms-1",children:e.jsx("div",{className:"mt-5",children:e.jsx(Ia,{})})})]})]})})}),Pa=()=>{const{credentials:s}=oe(),t=s==null?void 0:s.role;return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"h-100 ",children:[t==="root"&&e.jsx(Oa,{}),t==="autoridadArea"&&e.jsx(Ta,{})]})})};function Ra(){const s=ct();return console.error(s),e.jsxs("div",{id:"error-page",children:[e.jsx("h1",{children:"Oops!"}),e.jsx("p",{children:"Sorry, an unexpected error has occurred."}),e.jsx("p",{children:e.jsx("i",{children:s.statusText||s.message})})]})}const Ma=()=>r.useContext(qs),La=[{label:"Settings",key:"settings",icon:e.jsx(dt,{style:{fontSize:20}}),children:[]}],Da=[{label:"Permisos",key:"permissions",icon:e.jsx(ut,{style:{fontSize:20}}),children:[]}],Ua=[{label:"Reports",key:"reports",icon:e.jsx(mt,{style:{fontSize:20}}),children:[]}],qa=[{label:"Logout",key:"logout",icon:e.jsx(ht,{style:{fontSize:20,color:"#faad14"}}),children:[]}],$a=[{label:"Home",key:"/",icon:e.jsx(xt,{style:{fontSize:20}}),children:[]}],za=[{label:"Assets",key:"assets-settings",icon:e.jsx(pt,{style:{fontSize:20}}),children:[]}],ke=(s,t,l,x,c,a)=>({key:t,icon:l,children:x,label:s,type:c,disabled:a}),Ba=Da.map(s=>ke(s.label,s.key,s.icon)),Ha=Ua.map(s=>ke(s.label,s.key,s.icon)),Va=La.map(s=>ke(s.label,s.key,s.icon)),Ya=qa.map(s=>ke(s.label,s.key,s.icon)),_a=$a.map(s=>ke(s.label,s.key,s.icon)),Ga=za.map(s=>ke(s.label,s.key,s.icon)),{Sider:Qa}=Fe,Wa=[_a[0],Va[0],Ga[0],Ba[0],Ha[0],Ya[0]],Ja=()=>{const s=je(),{logout:t}=oe(),[l,x]=r.useState(!0);let c={};l?c={backgroundColor:"#2E202F",textAlign:"center",paddingTop:20,paddingBottom:10}:c={backgroundColor:"#2E202F",textAlign:"right",paddingTop:20,paddingBottom:10};const a={backgroundColor:"#fff",height:"100vh",zIndex:1},n={backgroundColor:"#2E202F",color:"#fff",borderRadius:"0px 0px 20px 0px",maxWidth:200,minHeight:"95%"},i=d=>{x(d)},o=()=>{s("/"),t()};return e.jsxs(Qa,{breackpoint:"md",trigger:null,collapsible:!0,collapsed:l,onCollapse:i,style:a,children:[e.jsx("div",{style:c,className:"itemButton",children:e.jsx($,{type:"text",icon:l?e.jsx(jt,{style:{fontSize:20,color:"#fff "}}):e.jsx(ft,{style:{fontSize:20,color:"#fff"}}),onClick:()=>x(!l)})}),e.jsx(gt,{theme:"dark",style:n,mode:"inline",items:Wa,onClick:({key:d})=>{d==="logout"?o():d==="openClose"?x(!l):s(d)},selectable:!0})]})},Ka="/assets/LogoHorizontal-aIQiJSsu.png",Xa=()=>{const s=je(),t=D(a=>a.permits.permits),l=t.some(a=>a.status==="waiting"),x=t.some(a=>a.status==="approved"),c=()=>{s("/permissions")};return e.jsxs("div",{className:"d-flex gap-3",children:[l&&e.jsx($,{className:"notification",onClick:c,children:"¡Hay permisos pendientes de autorización!"}),x&&e.jsx($,{className:"notification",onClick:c,children:"¡Hay permisos para Completar!"})]})},{Header:Za}=Fe,$e=["#f56a00","#7265e6","#ffbf00","#00a2ae"],el=()=>{const[s,t]=r.useState("U"),[l,x]=r.useState($e[1]);je();const{isLoggedIn:c,credentials:a}=oe(),n=()=>{const o=Math.floor(Math.random()*4);x(o<$e.length-1?$e[o+1]:$e[0])},i=o=>o.split(" ").map(v=>v[0].toUpperCase()).join("");return r.useEffect(()=>{a!=null&&a.name&&(a!=null&&a.lastName)?t(i(`${a==null?void 0:a.name} ${a==null?void 0:a.lastName}`)):t("U")},[c,a]),e.jsxs(Za,{className:"header",children:[e.jsx(ms,{to:"/",children:e.jsx(vt,{preview:!1,width:150,src:Ka})}),e.jsx(Xa,{}),e.jsx("div",{className:"",style:{paddingRight:20,paddingLeft:20},children:c?e.jsx(ss,{style:{backgroundColor:l,cursor:"pointer"},size:35,onClick:n,children:s}):e.jsx(ss,{style:{backgroundColor:l,cursor:"pointer"},size:35,icon:e.jsx(Nt,{style:{fontSize:35}}),onClick:n})})]})},sl=()=>{const{isMobile:s}=Ma();console.log("isMobile::: ",s);const{Header:t,Content:l,Footer:x}=Fe,{token:{colorBgContainer:c}}=yt.useToken(),a={margin:"0px",textAlign:"center",height:"85vh",width:"100%"},n={background:c,width:"100%"},i={background:c,textAlign:"center",display:"flex",justifyContent:"center",alignItems:"center"},o={display:"flex",alignContent:"center",alignItems:"center",background:"#fff"};return e.jsxs(Fe,{className:"conatiner-fluid layout",children:[e.jsx(el,{}),e.jsxs(Fe,{style:o,children:[e.jsx(Ja,{}),e.jsx("div",{style:n,children:e.jsx(l,{style:a,children:e.jsx(ps,{})})})]}),e.jsx(x,{style:i,children:"MyPropChain © 2024 all rights reserved"})]})},{RangePicker:zs}=fe,De=({fields:s,onFinish:t,formName:l,name:x,buttonTitle:c,layout:a})=>{a||(a="vertical");const n="DD/MM/YYYY HH:mm",i={borderRadius:"5px",height:"35px",border:"none"};return e.jsxs(b,{form:l,name:x,onFinish:t,layout:a,labelCol:{span:10},wrapperCol:{span:24},style:{maxWidth:600},children:[s.map((o,d)=>e.jsxs(b.Item,{label:x==="login"?e.jsx("label",{className:"font-label",children:o.label}):o.label,name:o.name,rules:o.type==="confirmPassword"?[{required:!0,message:`Please input a ${o.label}`},{min:8,message:"Password must be at least 8 characters"},({getFieldValue:h})=>({validator(v,f){return!f||h("password")===f?Promise.resolve():Promise.reject(new Error("The two passwords that you entered do not match!"))}})]:x==="userForm"&&o.name==="location"?[{required:!1},{type:`${o.type}`}]:[{required:!0,message:`Please input ${o.label}`},{type:`${o.type}`},o.type==="password"&&{min:8,message:"Password must be at least 8 characters"}],children:[o.type==="text"&&e.jsx(Y,{id:o.name,placeholder:o.placeholder,style:{...i}}),o.type==="inputnumber"&&e.jsx(js,{min:"0",max:"1",step:"0.01",stringMode:!0,style:{...i,width:"100%"},id:o.name,placeholder:o.placeholder}),o.type==="number"&&e.jsx(Y,{type:"number",id:o.name,placeholder:o.placeholder,style:{...i}}),o.type==="email"&&e.jsx(Y,{type:"email",id:o.name,placeholder:o.placeholder,style:{...i}}),o.type==="date"&&e.jsx(fe,{id:o.name,format:n,style:{...i}}),o.type==="datetime"&&e.jsx(zs,{id:o.name,placeholder:o.placeholder,style:{...i}}),o.type==="password"&&e.jsx(Y.Password,{id:o.name,placeholder:o.placeholder,style:{...i}}),o.type==="confirmPassword"&&e.jsx(Y.Password,{id:o.name,placeholder:o.placeholder,style:{...i}}),o.type==="textarea"&&e.jsx(Y.TextArea,{id:o.name,style:{...i}}),o.type==="select"&&e.jsx(He,{id:o.name,options:o.options,placeholder:o.placeholder,style:{...i}}),o.type==="radio"&&e.jsx(he,{id:o.name,style:{...i}}),o.type==="checkbox"&&e.jsx(X,{id:o.name,style:{...i}}),o.type==="switch"&&e.jsx(fs,{id:o.name,style:{...i}}),o.type==="slider"&&e.jsx(gs,{id:o.name,style:{...i}}),o.type==="rate"&&e.jsx(vs,{id:o.name,style:{...i}}),o.type==="upload"&&e.jsx(Xe,{id:o.name,style:{...i}}),o.type==="button"&&e.jsx($,{id:o.name,style:{...i}}),o.type==="treeselect"&&e.jsx(Ns,{id:o.name,style:{...i}}),o.type==="timepicker"&&e.jsx(ys,{id:o.name,style:{...i}})]},d)),e.jsx(b.Item,{children:x==="login"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mt-4 d-flex justify-content-center",style:{display:"flex",flexDirection:"row"},children:e.jsx($,{htmlType:"submit",className:"button-login",children:c})}),e.jsx("div",{className:"d-flex justify-content-center",children:e.jsxs("p",{className:"forget-password",children:["¿Olvisate tu contraseña? ",e.jsx("span",{className:"get-password",children:"¡Recupérala!"})]})})]}):e.jsxs("div",{className:"",style:{display:"flex",flexDirection:"row"},children:[e.jsx($,{type:"primary",htmlType:"submit",children:c}),e.jsx($,{type:"",htmlType:"reset",style:{marginLeft:"20px"},children:"Reset"})]})})]})},_e=({fields:s,onFinish:t,formName:l,initialValues:x,buttonTitle:c,form:a,layout:n,disabled:i})=>{n||(n="vertical");const o=async()=>{await a.setFieldsValue(x)};return r.useEffect(()=>{x?o():a.resetFields()},[x,a]),e.jsxs(b,{form:a,name:l,onFinish:t,initialValues:x,layout:n,labelCol:{span:8},wrapperCol:{span:24},style:{maxWidth:600},children:[s.map((d,h)=>e.jsxs(b.Item,{label:d.label,name:d.name,rules:[{required:!0,message:`Please input ${d.label}`},{type:`${d.type}`}],children:[d.type==="text"&&e.jsx(Y,{disabled:i||!1}),d.type==="inputnumber"&&e.jsx(js,{min:"0",max:"1",step:"0.01",stringMode:!0,style:{width:"100%"},id:d.name}),d.type==="number"&&e.jsx(Y,{type:"number",id:d.name,value:d.value}),d.type==="email"&&e.jsx(Y,{type:"email",id:d.name,value:d.value,disabled:i||!1}),d.type==="date"&&e.jsx(fe,{id:d.name,value:d.value}),d.type==="datetime"&&e.jsx(zs,{id:d.name,value:d.value}),d.type==="password"&&e.jsx(Y.Password,{id:d.name,value:d.value}),d.type==="textarea"&&e.jsx(Y.TextArea,{id:d.name}),d.type==="select"&&e.jsx(He,{id:d.name,value:d.value,options:d.options,disabled:i||!1}),d.type==="radio"&&e.jsx(he,{id:d.name,value:d.value}),d.type==="checkbox"&&e.jsx(X,{id:d.name,value:d.value}),d.type==="switch"&&e.jsx(fs,{id:d.name,value:d.value}),d.type==="slider"&&e.jsx(gs,{id:d.name,value:d.value}),d.type==="rate"&&e.jsx(vs,{id:d.name,value:d.value}),d.type==="upload"&&e.jsx(Xe,{id:d.name,value:d.value}),d.type==="button"&&e.jsx($,{id:d.name,value:d.value}),d.type==="treeselect"&&e.jsx(Ns,{id:d.name,value:d.value}),d.type==="timepicker"&&e.jsx(ys,{id:d.name,value:d.value})]},h)),e.jsx(b.Item,{children:e.jsxs("div",{className:"",style:{display:"flex",flexDirection:"row"},children:[e.jsx($,{type:"primary",htmlType:"submit",children:c}),e.jsx($,{type:"",htmlType:"reset",style:{marginLeft:"20px"},children:"Reset"})]})})]})},te=({title:s,content:t})=>{ae.error({title:s,content:t})},J=({title:s,content:t})=>{ae.success({title:s,content:t})},tl=({title:s,content:t})=>{ae.info({title:s,content:t})},Ge=({title:s,content:t,onCancel:l,onOk:x,isModalOpen:c,buttonTitle:a,cancelTitle:n})=>e.jsx(ae,{title:s,open:c,onCancel:l,footer:[e.jsx($,{onClick:l,children:n||"Cancelar"},"cancel"),e.jsx($,{type:"primary",onClick:x,className:"button-add",children:a||"Ok"},"ok")],children:e.jsx("p",{children:t})}),Bs=()=>{var _;const s=D(M=>M.tenants.tenants),[t]=b.useForm(),[l,x]=r.useState(!1);r.useState(null);const[c,a]=r.useState(!1),[n,i]=r.useState(!1),[o,d]=r.useState(null),[h,{isSuccess:v,error:f,reset:p}]=ea(),{data:j=[],isSuccessLocation:w,errorLocation:k,isFetching:u,refetch:g}=Ye({}),m=(_=j==null?void 0:j.data)==null?void 0:_.map(M=>({value:M._id,label:M.locationName+"-"+M.city})),S=[{value:"admin",label:"Admin"},{value:"user",label:"User"},{value:"root",label:"Root"},{value:"operator",label:"Operator"},{value:"contractor",label:"Contractor"},{value:"autoridadEstatal",label:"Autoridad Estatal"},{value:"autoridadMunicipal",label:"Autoridad Municipal"},{value:"autoridadArea",label:"Autoridad de Area"},{value:"autoridadAreaLocal",label:"Autoridad de Area Local"},{value:"otraAutoridad",label:"Otra Autoridad"}],A=[{label:"Tenant",name:"tenant",type:"select",placeholder:"Tenant",options:s==null?void 0:s.map(M=>({value:M._id,label:M.name}))},{label:"Nombre",name:"name",type:"text",placeholder:"Nombre"},{label:"Apellido",name:"lastname",type:"text",placeholder:"Apellido"},{label:"Role",name:"role",type:"select",placeholder:"Role",options:S},{label:"Location",name:"location",type:"select",placeholder:"Location",options:m},{label:"Email",name:"email",type:"email",placeholder:"Email"},{label:"Password",name:"password",type:"password",placeholder:"Password"},{label:"Confirm password",name:"confirmPassword",type:"confirmPassword",placeholder:"Confirm password"}],I=()=>{i(!1),a(!1),x(!0)},T=()=>{i(!1),a(!1),t.resetFields(),x(!1)},P=()=>{i(!1),a(!1),t.resetFields(),x(!1)},G=M=>{const E={...M,isActive:!0};h(E).unwrap(),p()};return r.useEffect(()=>{v&&(a(!0),d("User added successfully"),x(!1),J({title:"Success",content:"User added successfully"}))},[v]),r.useEffect(()=>{f&&(i(!0),d("Error adding user"),x(!1),te({title:"Error",content:"Error adding user"}))},[f]),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"",children:e.jsx("div",{className:"col-md",children:e.jsx($,{type:"primary",className:"button-add",onClick:I,children:"Add User"})})}),e.jsx(ae,{open:l,forceRender:!0,title:"Add user",onOk:T,onCancel:P,cancelButtonProps:{form:t,key:"cancel",htmlType:"reset"},footer:[e.jsx($,{type:"default",onClick:P,children:"Exit"},"exit")],children:e.jsx(De,{fields:A,onFinish:G,name:"userForm",buttonTitle:"Submit",formName:t})})]})},al=({userId:s,setUserId:t})=>{var R;const l=D(O=>O.tenants.tenants),[x]=b.useForm(),[c,a]=r.useState(!1),[n,i]=r.useState(!1),[o,d]=r.useState(!0),[h,v]=r.useState(!1),[f,p]=r.useState(null),[j,w]=r.useState(null),[k,u]=r.useState(!1),{data:g,isSuccess:m,isError:S}=Zt(s,{skip:o}),[N,{isSuccess:A,error:I,reset:T}]=ws(),{data:P=[],isSuccessLocation:G,errorLocation:_,isFetching:M,refetch:E}=Ye({}),y=(R=P==null?void 0:P.data)==null?void 0:R.map(O=>({value:O._id,label:O.locationName+"-"+O.city}));r.useEffect(()=>{s&&d(!1),console.log("record:::::",s)},[s]);const U=[{value:"admin",label:"Admin"},{value:"user",label:"User"},{value:"root",label:"Root"},{value:"operator",label:"Operator"},{value:"contractor",label:"Contractor"},{value:"autoridadEstatal",label:"Autoridad Estatal"},{value:"autoridadMunicipal",label:"Autoridad Municipal"},{value:"autoridadArea",label:"Autoridad de Area"},{value:"autoridadAreaLocal",label:"Autoridad de Area Local"},{value:"otraAutoridad",label:"Otra Autoridad"}],q=[{label:"Tenant",name:"tenant",type:"select",placeholder:"Tenant",options:l==null?void 0:l.map(O=>({value:O._id,label:O.name}))},{label:"Nombre",name:"name",type:"text",placeholder:"Nombre"},{label:"Apellido",name:"lastname",type:"text",placeholder:"Apellido"},{label:"Role",name:"role",type:"select",placeholder:"Role",options:U},{label:"Location",name:"location",type:"select",placeholder:"Location",options:y},{label:"Email",name:"email",type:"email",placeholder:"Email"}],H=()=>{v(!1),i(!1),a(!0)},z=()=>{v(!1),i(!1),x.resetFields(),t(null),a(!1)},F=()=>{v(!1),i(!1),x.resetFields(),a(!1),t(null)},C=()=>{x.validateFields().then(O=>{var le,Se,Ce,V;let Q={};(le=O.location)!=null&&le.value&&((Se=O.tenant)!=null&&Se.value)?Q={...O,id:s,tenant:O.tenant.value,location:O.location.value}:(Ce=O.location)!=null&&Ce.value?Q={...O,id:s,location:O.location.value}:(V=O.tenant)!=null&&V.value?Q={...O,id:s,tenant:O.tenant.value}:Q={...O,id:s},u(!0),T(),N(Q).unwrap()}).catch(O=>{te({title:"Error",content:"Error updating user"})})};return r.useEffect(()=>{var O;if(m){const Q={...g[0],tenant:{label:g[0].tenant.name,value:g[0].tenant._id}};(O=g[0])!=null&&O.location?p({...Q,location:y.find(le=>le.value===g[0].location._id)}):p({...Q}),H()}S&&w("Error getting user"),A&&(w("User updated successfully"),i(!0),t(null),a(!1),J({title:"Success",content:"User updated successfully"})),I&&(w("Error updating user"),v(!0),t(null),a(!1),te({title:"Error",content:"Error updating user"}))},[m,S,A,I]),e.jsx(e.Fragment,{children:e.jsx(ae,{open:c,forceRender:!0,title:"Add user",onOk:z,onCancel:F,cancelButtonProps:{form:userForm,key:"cancel",htmlType:"reset"},footer:[e.jsx($,{type:"default",onClick:F,children:"Exit"},"exit")],children:e.jsx(_e,{form:x,formName:"userUpdateForm",fields:q,initialValues:f,buttonTitle:"Update",onFinish:C,disabled:k})})})},ll=()=>{var F;r.useState([]);const[s,t]=r.useState(null),[l,x]=r.useState(""),[c,a]=r.useState(""),[n,i]=r.useState(!1),[o,d]=r.useState(null),h=D(C=>C.users.user),v=D(C=>C.tenants.tenants);r.useState(!0);const[f,p]=r.useState(!1);Re();const[j,w]=r.useState({}),[k,u]=r.useState({}),g=(C,R,O)=>{console.log("Various parameters",C,R,O),w(R),u(O)},{data:m=[],isSuccess:S,error:N,isFetching:A,refetch:I}=Kt({}),[T,{isSuccess:P,error:G,reset:_}]=ws(),M=v==null?void 0:v.map(C=>({text:C.name,value:C.name})),E=(F=m==null?void 0:m.users)==null?void 0:F.map(C=>{var R,O;return{key:C._id,name:C.name+" "+C.lastname,email:C.email,role:C.role,tenant:(R=C.tenant)==null?void 0:R.name,location:((O=C.location)==null?void 0:O.locationName)||"No aplica",enabled:C.isActive}}),y=[{title:"Name",dataIndex:"name",key:"name",render:C=>e.jsx("a",{children:C}),sorter:(C,R)=>{var O,Q;return((O=C.name)==null?void 0:O.length)-((Q=R.name)==null?void 0:Q.length)}},{title:"Email",dataIndex:"email",key:"email"},{title:"Role",dataIndex:"role",key:"role"},{title:"Location",dataIndex:"location",key:"location"},{title:"Organizacion",dataIndex:"tenant",key:"tenant",filters:M,filteredValue:j.tenant||null,onFilter:(C,R)=>R.tenant.includes(C),sorter:(C,R)=>{var O,Q;return((O=C.tenant)==null?void 0:O.length)-((Q=R.tenant)==null?void 0:Q.length)},sortOrder:k.columnKey==="tenant"?k.order:null,ellipsis:!0},(h==null?void 0:h.role)==="root"&&{title:"Action",key:"action",render:(C,R)=>R.email!=="root@mail.com"?e.jsxs(Me,{size:"middle",children:[R.enabled===!1?e.jsx(Z,{title:"Activar usuario",children:e.jsx(be,{style:{fontSize:20,color:"#FF0000",marginRight:10},onClick:()=>z("Activar usuario","activar",!0,R)})}):e.jsx(Z,{title:"Desactivar usuario",children:e.jsx(be,{style:{fontSize:20,color:"#00CC99",marginRight:10},onClick:()=>z("Desactivar usuario","desactivar",!1,R)})}),e.jsx(Z,{title:"Editar usuario",children:e.jsx(Le,{style:{fontSize:20,color:"#333F50",marginRight:10},onClick:()=>U(R)})})]}):null}].filter(Boolean),U=C=>{t(C.key)},B=C=>{p(!1),T({id:C.key,isActive:!1}).unwrap(),J({title:"Success",content:"User deactivated successfully"})},q=C=>{p(!1),T({id:C.key,isActive:!0}).unwrap(),J({title:"Success",content:"User activated successfully"})},H=C=>C.enabled?"":"inactive-row",z=(C,R,O,Q)=>{p(!0),x(C),a(R),i(O),d(Q)};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"container",children:e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-12",children:e.jsx(pe,{dataSource:E,columns:y,onChange:g,handleUpdate:U,rowClassName:H,scroll:{y:300,x:1e3}})})})}),s&&e.jsx(al,{userId:s,setUserId:()=>t()}),e.jsx(Ge,{title:l,content:`¿Está seguro que desea ${c} al usuario ${o==null?void 0:o.name}?`,isModalOpen:f,onCancel:()=>p(!1),onOk:n?()=>q(o):()=>B(o),buttonTitle:c.charAt(0).toUpperCase()+c.slice(1)}),";"]})},nl=()=>(Os(),e.jsxs(e.Fragment,{children:[e.jsxs(re,{children:[e.jsx(ee,{span:12,className:"text-center",children:e.jsx("h4",{style:{fontFamily:"Montserrat"},children:"Users administration"})}),e.jsx(ee,{span:12,className:"text-center",children:e.jsx(Bs,{})})]}),e.jsx(re,{className:"pt-3",children:e.jsx(ee,{span:24,children:e.jsx(ll,{})})})]})),ye=["autoridadArea","autoridadMunicipal","autoridadEstatal","autoridadAreaLocal","otraAutoridad","contractor","root"],Hs=["owner","contractor","client"],rl=()=>{const[s]=b.useForm(),[t,l]=r.useState(!1),[x,c]=r.useState(!1),[a,n]=r.useState(!1),[i,o]=r.useState(null),[d,{isSuccess:h,error:v,reset:f}]=xa(),j=[{label:"Tipo",name:"tenantType",type:"select",placeholder:"Tipo",options:Hs.map(m=>({label:m,value:m}))},{label:"Nombre",name:"tenantName",type:"text",placeholder:"Nombre"},{label:"Nombre Legal",name:"tenantLegalname",type:"text",placeholder:"Nombre"},{label:"Email",name:"tenantEmail",type:"email",placeholder:"Email"}],w=()=>{n(!1),c(!1),l(!0)},k=()=>{n(!1),c(!1),s.resetFields(),l(!1)},u=()=>{n(!1),c(!1),s.resetFields(),l(!1)},g=m=>{const S={name:m.tenantName,legalName:m.tenantLegalname,email:m.tenantEmail,isActive:!0,type:m.tenantType};d(S).unwrap(),f()};return r.useEffect(()=>{h&&(c(!0),o("Tenant added successfully"),l(!1),J({title:"Success",content:"Tenant added successfully"}))},[h]),r.useEffect(()=>{v&&(n(!0),o("Error adding tenant"),l(!1),te({title:"Error",content:"Error adding tenant"}))},[v]),e.jsxs(e.Fragment,{children:[e.jsx($,{type:"primary",className:"button-add",onClick:w,children:"Add new tenant"}),e.jsx(ae,{open:t,forceRender:!0,title:"Add tenant",onOk:k,onCancel:u,cancelButtonProps:{form:s,key:"cancel",htmlType:"reset"},footer:[e.jsx($,{type:"default",onClick:u,children:"Exit"},"exit")],children:e.jsx(De,{fields:j,onFinish:g,name:"tenantForm",buttonTitle:"Submit",formName:s})})]})},il=({tenantId:s,setTenantId:t})=>{const[l]=b.useForm(),[x,c]=r.useState(!1),[a,n]=r.useState(null),[i,o]=r.useState(null),[d,h]=r.useState(!0),[v,f]=r.useState(!1),[p,j]=r.useState(!1),{data:w,isSuccess:k,isError:u}=ha(s,{skip:d}),[g,m]=r.useState(!1),[S,{isSuccess:N,error:A,reset:I}]=Ts(),P=[{label:"Tipo",name:"type",type:"select",placeholder:"Tipo",options:Hs.map(E=>({label:E,value:E}))},{label:"Nombre",name:"name",type:"text",placeholder:"Nombre"},{label:"Nombre Legal",name:"legalName",type:"text",placeholder:"Nombre"},{label:"Email",name:"email",type:"email",placeholder:"Email"}];r.useEffect(()=>{s&&(h(!1),G())},[s]);const G=()=>{j(!1),f(!1),c(!0)},_=()=>{l.validateFields().then(E=>{const y={...E,id:s,more:{type:E.type}};m(!0),I(),S(y).unwrap()}).catch(E=>{console.log("Validate Failed:",E)})},M=()=>{j(!1),f(!1),c(!1),t(null),l.resetFields()};return r.useEffect(()=>{k&&n({...w[0],type:w[0].more.type}),u&&o("Error getting tenant"),N&&(o("Tenant updated successfully"),f(!0),c(!1),t(null),J({title:"Success",content:"Tenant updated successfully"})),A&&(o("Error updating tenant"),j(!0),c(!1),t(null),te({title:"Error",content:"Error updating tenant"}))},[k,u,N,A]),e.jsx("div",{children:e.jsx(ae,{title:"Update Tenant",open:x,onOk:_,onCancel:M,cancelButtonProps:{form:l,key:"cancel",htmlType:"reset"},footer:[e.jsx($,{type:"default",onClick:M,children:"Exit"},"exit")],children:e.jsx(_e,{form:l,formName:"tenantEditForm",fields:P,initialValues:a,buttonTitle:"Update",onFinish:_,disabled:g})})})},ol=()=>{var B;const[s,t]=r.useState(null),[l,x]=r.useState(""),[c,a]=r.useState(""),[n,i]=r.useState(!1),[o,d]=r.useState(!1),[h,v]=r.useState(null),f=D(q=>q.users.user),{data:p=[],isSuccess:j,error:w,isFetching:k,refetch:u}=Os({}),[g,{isSuccess:m,isError:S}]=pa(),[N,{isSuccess:A,error:I,reset:T}]=Ts(),P=(B=p==null?void 0:p.data)==null?void 0:B.map(q=>({key:q._id,name:q.name,email:q.email,enabled:q.isActive})),G=[{title:"Name",dataIndex:"name",key:"name",render:q=>e.jsx("a",{children:q})},{title:"Email",dataIndex:"email",key:"email"},(f==null?void 0:f.role)==="root"&&{title:"Action",key:"action",render:(q,H)=>H.email!=="root@mail.com"?e.jsxs(Me,{size:"middle",children:[H.enabled===!1?e.jsx(Z,{title:"Activar tenant",children:e.jsx(be,{style:{fontSize:20,color:"#FF0000",marginRight:10},onClick:()=>y("Activar tenant","activar",!0,H)})}):e.jsx(Z,{title:"Desactivar tenant",children:e.jsx(be,{style:{fontSize:20,color:"#00CC99",marginRight:10},onClick:()=>y("Desactivar tenant","desactivar",!1,H)})}),e.jsx(Z,{title:"Editar usuario",children:e.jsx(Le,{style:{fontSize:20,color:"#333F50",marginRight:10},onClick:()=>_(H)})})]}):null}],_=q=>{t(q.key)},M=q=>{i(!1),N({id:q.key,isActive:!1}).unwrap(),J({title:"Success",content:"Tenant deactivated successfully"})},E=q=>{i(!1),N({id:q.key,isActive:!0}).unwrap(),J({title:"Success",content:"Tenant activated successfully"})},y=(q,H,z,F)=>{i(!0),x(q),a(H),d(z),v(F)},U=q=>q.enabled?"":"inactive-row";return r.useEffect(()=>{m?(J({title:"Success",content:"Tenant deleted successfully"}),u()):S&&te({title:"Error",content:"Error deleting tenant"})},[m,S]),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"container",children:e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-12",children:e.jsx(pe,{dataSource:P,columns:G,rowClassName:U})})})}),s&&e.jsx(il,{tenantId:s,setTenantId:()=>t()}),e.jsx(Ge,{title:l,content:`¿Está seguro que desea ${c} al tenant ${h==null?void 0:h.name}?`,isModalOpen:n,onCancel:()=>i(!1),onOk:o?()=>E(h):()=>M(h),buttonTitle:c.charAt(0).toUpperCase()+c.slice(1)}),";"]})},cl=()=>e.jsxs(e.Fragment,{children:[e.jsxs(re,{children:[e.jsx(ee,{span:12,className:"text-center",children:e.jsx("h4",{children:"Tenants administration"})}),e.jsx(ee,{span:12,className:"text-center",children:e.jsx(rl,{})})]}),e.jsx(re,{className:"pt-3",children:e.jsx(ee,{span:24,children:e.jsx(ol,{})})})]}),dl=()=>{const s=D(T=>T.tenants.tenants),[t]=b.useForm(),{credentials:l}=oe(),[x,c]=r.useState(!1),a=D(T=>T.users.user);r.useState(null);const[n,i]=r.useState(!1),[o,d]=r.useState(!1),[h,v]=r.useState(null),[f,{isSuccess:p,error:j,reset:w}]=ia(),k=l==null?void 0:l.role,g={label:"Tenant",name:"tenant",type:"select",placeholder:"Tenant",options:s==null?void 0:s.map(T=>({value:T._id,label:T.name}))},m=[{label:"Nombre",name:"locationName",type:"text",placeholder:"Nombre"},{label:"Descripción",name:"description",type:"text",placeholder:"Descripcion"},{label:"Ciudad",name:"city",type:"text",placeholder:"Ciudad"},{label:"Departamento",name:"state",type:"text",placeholder:"Departamento"},{label:"Pais",name:"country",type:"text",placeholder:"Pais"}];k==="root"&&m.unshift(g);const S=()=>{d(!1),i(!1),c(!0)},N=()=>{d(!1),i(!1),t.resetFields(),c(!1)},A=()=>{d(!1),i(!1),t.resetFields(),c(!1)},I=T=>{console.log(T);const P={...T,more:{isActive:!0}};a.role!="root"&&(P.tenant=l==null?void 0:l.tenantId),f(P).unwrap(),w()};return r.useEffect(()=>{p&&(i(!0),v("Location added successfully"),c(!1),J({title:"Success",content:"Location added successfully"}))},[p]),r.useEffect(()=>{j&&(d(!0),v("Error adding location"),c(!1),te({title:"Error",content:"Error adding location"}))},[j]),e.jsxs(e.Fragment,{children:[e.jsx($,{type:"primary",className:"button-add",onClick:S,children:"Add location"}),e.jsx(ae,{open:x,forceRender:!0,title:"Add location",onOk:N,onCancel:A,cancelButtonProps:{form:t,key:"cancel",htmlType:"reset"},footer:[e.jsx($,{type:"default",onClick:A,children:"Exit"},"exit")],children:e.jsx(De,{fields:m,onFinish:I,name:"locationForm",buttonTitle:"Submit",formName:t})})]})},ul=({locationId:s,setLocationId:t})=>{const l=D(H=>H.tenants.tenants),[x]=b.useForm(),{credentials:c}=oe(),[a,n]=r.useState(!1);D(H=>H.users.user),r.useState(null);const[i,o]=r.useState(!0),[d,h]=r.useState(null),[v,f]=r.useState(!1),{data:p,isSuccess:j,isError:w}=ra(s,{skip:i}),[k,u]=r.useState(!1),[g,m]=r.useState(!1),[S,N]=r.useState(null),[A,{isSuccess:I,error:T,reset:P}]=As(),G=c==null?void 0:c.role;r.useEffect(()=>{s&&o(!1),console.log("record:::::",s)},[s]);const M={label:"Tenant",name:"tenant",type:"select",placeholder:"Tenant",options:l==null?void 0:l.map(H=>({value:H._id,label:H.name}))},E=[{label:"Nombre",name:"locationName",type:"text",placeholder:"Nombre"},{label:"Descripción",name:"description",type:"text",placeholder:"Descripcion"},{label:"Ciudad",name:"city",type:"text",placeholder:"Ciudad"},{label:"Departamento",name:"state",type:"text",placeholder:"Departamento"},{label:"Pais",name:"country",type:"text",placeholder:"Pais"}];G==="root"&&E.unshift(M);const y=()=>{m(!1),u(!1),n(!0)},U=()=>{m(!1),u(!1),userUpdateForm.resetFields(),t(null),n(!1)},B=()=>{m(!1),u(!1),x.resetFields(),n(!1),t(null)},q=()=>{x.validateFields().then(H=>{let z={};z={...H,id:s},f(!0),P(),A(z).unwrap()}).catch(H=>{te({title:"Error",content:"Error updating user"})})};return r.useEffect(()=>{if(j){console.log("location:::::",p);const H={...p};h({...H}),y()}w&&N("Error getting location"),I&&(N("Location updated successfully"),u(!0),t(null),n(!1),J({title:"Success",content:"Location updated successfully"})),T&&(N("Error updating location"),m(!0),t(null),n(!1),te({title:"Error",content:"Error updating location"}))},[I,T,j,w]),e.jsx(e.Fragment,{children:e.jsx(ae,{open:a,forceRender:!0,title:"Update location",onOk:U,onCancel:B,cancelButtonProps:{form:x,key:"cancel",htmlType:"reset"},footer:[e.jsx($,{type:"default",onClick:B,children:"Exit"},"exit")],children:e.jsx(_e,{form:x,formName:"loactionForm",fields:E,initialValues:d,buttonTitle:"Update",onFinish:q,disabled:v})})})},ml=()=>{var E;const[s,t]=r.useState(""),[l,x]=r.useState(""),[c,a]=r.useState(!1),[n,i]=r.useState(null),[o,d]=r.useState(!1),h=D(y=>y.users.user),[v,f]=r.useState(null),{data:p=[],isSuccess:j,error:w,isFetching:k,refetch:u}=Ye({}),[g,{isSuccess:m,error:S,reset:N}]=As(),A=(E=p==null?void 0:p.data)==null?void 0:E.map(y=>({key:y._id,name:y.locationName,city:y.city,state:y.state,country:y.country,enabled:(y==null?void 0:y.isActive)||!1})),I=[{title:"Name",dataIndex:"name",key:"name",render:y=>e.jsx("a",{children:y})},{title:"Ciudad",dataIndex:"city",key:"city"},{title:"Departamento",dataIndex:"state",key:"state"},(h==null?void 0:h.role)==="root"&&{title:"Action",key:"action",render:(y,U)=>U.email!=="root@mail.com"?e.jsxs(Me,{size:"middle",children:[U.enabled===!1?e.jsx(Z,{title:"Activar localización",children:e.jsx(be,{style:{fontSize:20,color:"#FF0000",marginRight:10},onClick:()=>_("Activar usuario","activar",!0,U)})}):e.jsx(Z,{title:"Desactivar localización",children:e.jsx(be,{style:{fontSize:20,color:"#00CC99",marginRight:10},onClick:()=>_("Desactivar localización","desactivar",!1,U)})}),e.jsx(Z,{title:"Editar localización",children:e.jsx(Le,{style:{fontSize:20,color:"#333F50",marginRight:10},onClick:()=>T(U)})})]}):null}].filter(Boolean),T=y=>{f(y.key)},P=y=>{d(!1),g({id:y.key,isActive:!1}).unwrap(),J({title:"Success",content:"Location deactivated successfully"})},G=y=>{d(!1),g({id:y.key,isActive:!0}).unwrap(),J({title:"Success",content:"Location activated successfully"})},_=(y,U,B,q)=>{d(!0),t(y),x(U),a(B),i(q)},M=y=>y.enabled?"":"inactive-row";return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"container",children:e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-12",children:e.jsx(pe,{dataSource:A,columns:I,rowClassName:M})})})}),v&&e.jsx(ul,{locationId:v,setLocationId:()=>f()}),e.jsx(Ge,{title:s,content:`¿Está seguro que desea ${l} la localización ${n==null?void 0:n.name}?`,isModalOpen:o,onCancel:()=>d(!1),onOk:c?()=>G(n):()=>P(n),buttonTitle:l.charAt(0).toUpperCase()+l.slice(1)}),";"]})},hl=()=>e.jsxs(e.Fragment,{children:[e.jsxs(re,{children:[e.jsx(ee,{span:12,className:"text-center",children:e.jsx("h4",{children:"Location administration"})}),e.jsx(ee,{span:12,className:"text-center",children:e.jsx(dl,{})})]}),e.jsx(re,{className:"pt-3",children:e.jsx(ee,{span:24,children:e.jsx(ml,{})})})]}),xl=()=>{const s=D(o=>o.users.user),[t,l]=r.useState(!0),[x,c]=r.useState(!1),[a,n]=r.useState(!1);console.log("USER",s);const i=o=>{switch(o){case 1:l(!0),c(!1),n(!1);break;case 2:l(!1),c(!0),n(!1);break;case 3:l(!1),c(!1),n(!0);break;default:l(!0),c(!1),n(!1);break}};return e.jsxs("div",{className:"container-fluid",children:[e.jsx("div",{className:"tabs",children:e.jsxs("ul",{className:"tab-container",children:[e.jsx("li",{id:"tab1",className:t?"tab activeItem activeList":"tab",children:e.jsx("a",{onClick:()=>i(1),children:"Users settings"})}),(s==null?void 0:s.role)==="root"&&e.jsx("li",{id:"tab2",className:x?"tab activeItem activeList":"tab",children:e.jsx("a",{onClick:()=>i(2),children:"Tenants settings"})}),(s==null?void 0:s.role)==="root"&&e.jsx("li",{id:"tab3",className:a?"tab activeItem activeList":"tab",children:e.jsx("a",{onClick:()=>i(3),children:"Location settings"})})]})}),e.jsxs("div",{className:"blockBorder",children:[t&&e.jsx(nl,{}),x&&(s==null?void 0:s.role)==="root"&&e.jsx(cl,{}),a&&(s==null?void 0:s.role)==="root"&&e.jsx(hl,{})]})]})},pl=()=>e.jsx("div",{children:"Reports"}),Vs=Te({}),jl=Vs.getInitialState(),ie=xe.injectEndpoints({endpoints:s=>({getPermits:s.query({query:()=>"/permits",providesTags:["Permits"]}),getPermit:s.query({query:t=>`/permits/${t}`,providesTags:["Permits"]}),addPermit:s.mutation({query:t=>({url:"/permits",method:"POST",body:t}),invalidatesTags:["Permits"],extraOptions:{maxRetries:0}}),updatePermit:s.mutation({query:({id:t,data:l})=>({url:`/permits/${t}`,method:"PUT",body:l}),invalidatesTags:["Permits"],extraOptions:{maxRetries:0}})})}),{useGetPermitQuery:fl,useGetPermitsQuery:gl,useAddPermitMutation:vl,useUpdatePermitMutation:ce}=ie,Nl=ie.endpoints.getPermits.select(),yl=Pe(Nl,s=>s.data);Vs.getSelectors(s=>yl(s)??jl);const bl={permits:[],permit:null,loading:!1,error:null},Ys=we({name:"permits",initialState:bl,reducers:{setPermit(s,t){s.permit=t.payload},setPermits(s,t){s.permits=t.payload.data}},extraReducers:s=>{s.addMatcher(ie.endpoints.getPermits.matchFulfilled,(t,{payload:l})=>{t.permits=l.data,t.loading=!1,t.error=null}),s.addMatcher(ie.endpoints.getPermits.matchPending,t=>{t.loading=!0,t.error=null}),s.addMatcher(ie.endpoints.getPermits.matchRejected,(t,{payload:l})=>{t.loading=!1,t.error=l}),s.addMatcher(ie.endpoints.getPermit.matchFulfilled,(t,{payload:l})=>{t.permit=l,t.loading=!1,t.error=null}),s.addMatcher(ie.endpoints.getPermit.matchPending,t=>{t.loading=!0,t.error=null}),s.addMatcher(ie.endpoints.getPermit.matchRejected,(t,{payload:l})=>{t.loading=!1,t.error=l}),s.addMatcher(ie.endpoints.updatePermit.matchFulfilled,(t,{payload:l})=>{t.permit=l.data,t.loading=!1,t.error=null}),s.addMatcher(ie.endpoints.updatePermit.matchPending,t=>{t.loading=!0,t.error=null}),s.addMatcher(ie.endpoints.updatePermit.matchRejected,(t,{payload:l})=>{t.loading=!1,t.error=l})}}),Qe=Ys.actions,Sl=Ys.reducer,Cl=({setValue:s,number:t,setShow:l,show:x})=>{var Se,Ce;const[c]=b.useForm();Re();const a=D(V=>V.permits.permit),n=D(V=>V.users.user),[i,o]=r.useState({}),[d,h]=r.useState(t),[v,f]=r.useState(null);r.useState(!0);const[p,j]=r.useState([]),[w,k]=r.useState(null),[u,g]=r.useState(!1),[m,{isSuccess:S,error:N,reset:A}]=ce(),{data:I,isSuccess:T,error:P,isFetching:G,refetch:_}=Ms({}),{data:M=[],isSuccessLocation:E,errorLocation:y,isFetching:U,refetch:B}=Ye({}),q="DD/MM/YYYY HH:mm",H=(Se=I==null?void 0:I.data)==null?void 0:Se.map(V=>{var K,L;return{key:V._id,name:V.assetName,internalId:V.internalId,location:(K=V.location)==null?void 0:K._id,city:(L=V.location)==null?void 0:L.city}});r.useEffect(()=>{var V,K;if((a==null?void 0:a.formNumber)===parseInt(t)){const L={...a==null?void 0:a.section1,date:W((V=a==null?void 0:a.section1)==null?void 0:V.date),equipment:(K=a==null?void 0:a.section1)==null?void 0:K.equipment};(a==null?void 0:a.status)==="waiting"&&ye.includes(n==null?void 0:n.role)?g(!0):g(!1),c.setFieldsValue(L)}},[]);const z=V=>{let K={},L={};typeof V.area=="object"?(K=V.area,L=V.equipment):(K=F.find(ue=>ue.value===V.area),L=p.find(ue=>ue.value===V.equipment));const de={...a,section1:{...V,area:K,equipment:L,completed:!0},location:K.value};m({id:a._id,data:de}).then(ue=>{ue.data.status===200&&(l(2),s("2"))}),u&&(l(2),s("2"))},F=(Ce=M==null?void 0:M.data)==null?void 0:Ce.map(V=>({value:V._id,label:V.city})),C=[{label:"Alto",value:"alto",style:{color:"red"}},{label:"Medio",value:"medio",style:{color:"orange"}}],R=V=>{f(V.target.value)},O=V=>{if(!V)k(null),j([]);else if(H.length>0){k(null),j([]);const L=Q(V).map(de=>({value:de.key,label:de.name,internalId:de.internalId}));j(L),console.log(L)}},Q=V=>H.filter(K=>K.location===V),le=(V,K)=>((K==null?void 0:K.label)??"").toLowerCase().includes(V.toLowerCase());return e.jsxs("div",{className:"container-fluid pageContainer",children:[e.jsx("hr",{}),e.jsxs("div",{className:"d-flex justify-content-between ps-2 pe-2",children:[e.jsx("div",{className:"textSubtitle",children:"INFORMACION GENERAL"}),e.jsxs("div",{className:"textSubtitle",children:["Permiso Número: ",d]})]}),e.jsx("hr",{}),e.jsx("div",{style:{marginRight:50,marginTop:30},children:e.jsxs(b,{form:c,name:"seccion1",layout:"vertical",onFinish:z,initialValues:i,children:[e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col",children:e.jsx("div",{className:"d-flex flex-row justify-content-start",children:e.jsx(b.Item,{label:"Fecha de Solicitud",name:"date",rules:[{required:!0,message:"Please input!"}],children:e.jsx(fe,{format:q,disabled:u})})})}),e.jsx("div",{className:"col",children:e.jsx(b.Item,{label:"Compañía que requiere el servicio",name:"company",rules:[{required:!0,message:"Please input!"}],children:e.jsx(Y,{disabled:u})})})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col",children:e.jsx(b.Item,{label:"Instalación",name:"location",rules:[{required:!0,message:"Please input!"}],children:e.jsx(Y,{disabled:u})})}),e.jsx("div",{className:"col",children:e.jsx(b.Item,{label:"Area",name:"area",rules:[{required:!0,message:"Please input!"}],children:e.jsx(He,{showSearch:!0,options:F,placeholder:"Seleccione área",style:{textAlign:"left"},disabled:u,onChange:O,filterOption:le})})})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col",children:e.jsx(b.Item,{label:"Equipos a intervenir",name:"equipment",rules:[{required:!0,message:"Please input!"}],children:e.jsx(He,{options:p,placeholder:"Seleccion equipo",style:{textAlign:"left"},disabled:u})})}),e.jsx("div",{className:"col",children:e.jsx(b.Item,{label:"Alcance del trabajo",name:"alcance",rules:[{required:!0,message:"Please input!"}],children:e.jsx(Y,{disabled:u})})})]}),e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col",children:[e.jsx("div",{className:"d-flex flex-row justify-content-start",children:e.jsx(b.Item,{label:"Nivel Potencial de Peligro Identificado",name:"warning",rules:[{required:!0,message:"Please input!"}],children:e.jsx(he.Group,{options:C,optionType:"button",onChange:R,disabled:u})})}),e.jsxs(bt,{children:[v==="alto"&&e.jsxs("p",{className:"textSubtitle",children:["Nivel de Peligro:"," ",e.jsx("span",{style:{color:"red"},children:v.toUpperCase()})]}),v==="medio"&&e.jsxs("p",{className:"textSubtitle",children:["Nivel de Peligro:"," ",e.jsx("span",{style:{color:"orange"},children:v.toUpperCase()})]})]})]}),e.jsx("div",{className:"col",children:e.jsx(b.Item,{label:"Equipos y Herramientas a Usar",name:"tools",rules:[{required:!0,message:"Please input!"}],children:e.jsx(Y,{disabled:u})})})]}),e.jsx("div",{className:"d-flex justify-content-end mt-4",children:e.jsx(b.Item,{children:e.jsx($,{type:"primary",htmlType:"submit",className:"float-right",children:"Seguir"})})})]})})]})},wl=({value:s,setValue:t,number:l,setShow:x,show:c})=>{const[a,n]=b.useForm(),i=D(L=>L.permits.permit),o=D(L=>L.users.user),d=D(L=>L.auth.token),[h,v]=r.useState(l);r.useState(!1);const[f,p]=r.useState(!1),[j,w]=r.useState(!1),[k,u]=r.useState(!1),[g,m]=r.useState(!1),[S,N]=r.useState(!1),[A,I]=r.useState(!1),[T,P]=r.useState(!1),[G,_]=r.useState(!1),[M,E]=r.useState(!1),[y,U]=r.useState(!1),[B,q]=r.useState(!1),[H,z]=r.useState(!1),[F,{isSuccess:C,error:R,reset:O}]=ce();r.useEffect(()=>{if((i==null?void 0:i.formNumber)===parseInt(l)){const L={...i==null?void 0:i.section2};a.setFieldsValue(L),p(L.check1),_(L.check2),w(L.check3),u(L.check4),m(L.check5),N(L.check6),I(L.check7),P(L.check8),E(L.check9),U(L.check10),(i==null?void 0:i.status)==="waiting"&&ye.includes(o==null?void 0:o.role)?q(!0):q(!1)}},[]);const Q=L=>{const de={...i,section2:{...L,completed:!0}};F({id:i._id,data:de}).then(ue=>{ue.data.status===200&&(x(3),t("3"))}),B&&(x(3),t("3"))},le=()=>{z(!0)},Se=()=>{z(!1)},Ce=()=>{z(!1)},V=async L=>{const{onSuccess:de,onError:ue,file:Ze}=L;try{const Ee=new FormData;Ee.append("file",Ze);for(const[Ue,Ae]of Ee.entries())Ae instanceof File?(console.log(`${Ue}: ${Ae.name}`),console.log(`${Ue}: ${Ae.size} bytes`),console.log(`${Ue}: ${Ae.type}`)):console.log(`${Ue}: ${Ae}`);const es=await bs("upload",d,Ee);console.log("file upload: >>> ",es),de(es.data,Ze)}catch(Ee){ue(Ee)}},K=L=>{L.file.status!=="uploading"&&console.log(L.file,L.fileList),L.file.status==="done"?ts.success(`${L.file.name} file uploaded successfully`):L.file.status==="error"&&ts.error(`${L.file.name} file upload failed.`)};return e.jsxs("div",{className:"container-fluid pageContainer",children:[e.jsx("hr",{}),e.jsxs("div",{className:"d-flex justify-content-between ps-2 pe-2",children:[e.jsx("div",{className:"textSubtitle",children:"ANALISIS DE RIESGOS, CERTIFICADOS DE APOYO Y DOCUMENTOS SOPORTE REQUERIDOS"}),e.jsxs("div",{className:"textSubtitle",children:["Permiso Número: ",h]})]}),e.jsx("hr",{}),e.jsx("div",{style:{marginRight:10},children:e.jsxs(b,{form:a,name:"seccion2",layout:"horizontal",onFinish:Q,children:[e.jsxs("div",{children:[e.jsx("p",{className:"textFormItalic w-100",children:"ANALISIS DE RIESGOS REQUERIDOS"}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col",children:e.jsxs("div",{className:"d-flex flex-row",children:[e.jsx(b.Item,{label:"Análisis de Seguridad en el Trabajo - AST",name:"check1",valuePropName:"checked",rules:[{required:!1,message:"Please input!"}],children:e.jsx(X,{onChange:()=>p(!f),checked:f,disabled:B})}),e.jsx(b.Item,{label:"Nro.",name:"astNumber",style:{paddingLeft:20},rules:[f&&{required:!0,message:"Please input!"}],children:e.jsx(Y,{disabled:!f})})]})}),e.jsx("div",{className:"col",children:e.jsx("div",{className:"d-flex flex-row",children:e.jsx(b.Item,{label:"Análisis de Peligro en la Etapa de Planificación - APEP",name:"apep",children:e.jsxs(he.Group,{disabled:B,children:[e.jsx(he,{value:"si",children:" Si "}),e.jsx(he,{value:"no",children:" No "})]})})})})]})]}),e.jsx("div",{className:"row",children:e.jsx("div",{className:"col",children:e.jsxs("div",{className:"d-flex flex-row",children:[e.jsx(b.Item,{label:"Otro",name:"check2",valuePropName:"checked",rules:[{required:!1,message:"Please input!"}],children:e.jsx(X,{onChange:()=>_(!G),checked:G,disabled:B})}),e.jsx(b.Item,{label:"Cual?",name:"oAnalysisDescription",style:{paddingLeft:20},rules:[G&&{required:!0,message:"Please input!"}],children:e.jsx(Y,{disabled:!G})})]})})}),e.jsxs("div",{children:[e.jsx("p",{className:"textFormItalic w-100",children:"CERTIFICADOS DE APOYO REQUERIDOS"}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col",children:e.jsxs("div",{className:"d-flex flex-row",children:[e.jsx(b.Item,{label:"Certificado Apoyo de Trabajo en Caliente",name:"check3",valuePropName:"checked",rules:[{required:!1,message:"Please input!"}],children:e.jsx(X,{onChange:()=>w(!j),checked:j,disabled:B})}),e.jsx(b.Item,{label:"Nro.",name:"atcNumber",style:{paddingLeft:20},rules:[j&&{required:!0,message:"Please input!"}],children:e.jsx(Y,{disabled:!j})})]})}),e.jsx("div",{className:"col",children:e.jsxs("div",{className:"d-flex flex-row",children:[" ",e.jsx(b.Item,{label:"Certificado Apoyo de Radiaciones",name:"check4",valuePropName:"checked",rules:[{required:!1,message:"Please input!"}],children:e.jsx(X,{onChange:()=>u(!k),checked:k,disabled:B})}),e.jsx(b.Item,{label:"Nro.",name:"certARNumber",style:{paddingLeft:20},rules:[k&&{required:!0,message:"Please input!"}],children:e.jsx(Y,{disabled:!k})})]})})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col",children:e.jsxs("div",{className:"d-flex flex-row",children:[e.jsx(b.Item,{label:"Certificado Apoyo de Excavación",name:"check5",valuePropName:"checked",rules:[{required:!1,message:"Please input!"}],children:e.jsx(X,{onChange:()=>m(!g),checked:g,disabled:B})}),e.jsx(b.Item,{label:"Nro.",name:"certAENumber",style:{paddingLeft:20},rules:[g&&{required:!0,message:"Please input!"}],children:e.jsx(Y,{disabled:!g})})]})}),e.jsx("div",{className:"col",children:e.jsxs("div",{className:"d-flex flex-row",children:[" ",e.jsx(b.Item,{label:"Certificado Apoyo Trabajo en Altura",name:"check6",valuePropName:"checked",rules:[{required:!1,message:"Please input!"}],children:e.jsx(X,{onChange:()=>N(!S),checked:S,disabled:B})}),e.jsx(b.Item,{label:"Nro.",name:"certATANumber",style:{paddingLeft:20},rules:[S&&{required:!0,message:"Please input!"}],children:e.jsx(Y,{disabled:!S})})]})})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col",children:e.jsxs("div",{className:"d-flex flex-row",children:[e.jsx(b.Item,{label:"Certificado Apoyo Izaje de Carga",name:"check7",valuePropName:"checked",rules:[{required:!1,message:"Please input!"}],children:e.jsx(X,{onChange:()=>I(!A),checked:A,disabled:B})}),e.jsx(b.Item,{label:"Nro.",name:"certAICNumber",style:{paddingLeft:20},rules:[A&&{required:!0,message:"Please input!"}],children:e.jsx(Y,{disabled:!A})})]})}),e.jsx("div",{className:"col",children:e.jsxs("div",{className:"d-flex flex-row",children:[" ",e.jsx(b.Item,{label:"Certificado Apoyo de Espacios Confinados",name:"check8",valuePropName:"checked",rules:[{required:!1,message:"Please input!"}],children:e.jsx(X,{onChange:()=>P(!T),checked:T,disabled:B})}),e.jsx(b.Item,{label:"Nro.",name:"certAECNumber",style:{paddingLeft:20},rules:[T&&{required:!0,message:"Please input!"}],children:e.jsx(Y,{disabled:!T})})]})})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col",children:e.jsxs("div",{className:"d-flex flex-row",children:[e.jsx(b.Item,{label:"Certificado Apoyo Ahislamiento de Energías",name:"check9",valuePropName:"checked",rules:[{required:!1,message:"Please input!"}],children:e.jsx(X,{onChange:()=>E(!M),checked:M,disabled:B})}),e.jsx(b.Item,{label:"Nro.",name:"certAAENumber",style:{paddingLeft:20},rules:[M&&{required:!0,message:"Please input!"}],children:e.jsx(Y,{disabled:!M})})]})}),e.jsx("div",{className:"col",children:e.jsxs("div",{className:"d-flex flex-row",children:[" ",e.jsx(b.Item,{label:"Otro",name:"check10",valuePropName:"checked",rules:[{required:!1,message:"Please input!"}],children:e.jsx(X,{onChange:()=>U(!y),checked:y,disabled:B})}),e.jsx(b.Item,{label:"Cual",name:"certOtherDesc",style:{paddingLeft:20},rules:[y&&{required:!0,message:"Please input!"}],children:e.jsx(Y,{disabled:!y})})]})})]}),e.jsxs("div",{className:"",children:[e.jsx("p",{className:"textFormItalic w-100",children:"DOCUMENTOS SOPORTE REQUERIDOS"}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col",children:e.jsx("div",{className:"d-flex flex-row",children:e.jsx(b.Item,{label:"Preoperacionales Equipos y Herramientas",name:"reqDocsPEH",valuePropName:"checked",rules:[{required:!1,message:"Please input!"}],children:e.jsx(X,{disabled:B})})})}),e.jsx("div",{className:"col",children:e.jsxs("div",{className:"d-flex flex-row",children:[" ",e.jsx(b.Item,{label:"Procedimientos/Instructivos",name:"reqDocsPI",valuePropName:"checked",rules:[{required:!1,message:"Please input!"}],children:e.jsx(X,{disabled:B})})]})}),e.jsx("div",{className:"col",children:e.jsxs("div",{className:"d-flex flex-row",children:[" ",e.jsx(b.Item,{label:"FDS Productos químicos",name:"reqDocsFDS",valuePropName:"checked",rules:[{required:!1,message:"Please input!"}],children:e.jsx(X,{disabled:B})})]})}),e.jsx("div",{className:"col",children:e.jsx("div",{className:"d-flex flex-row",children:e.jsx(b.Item,{label:"Otro",name:"reqDocsOther",valuePropName:"checked",rules:[{required:!1,message:"Please input!"}],children:e.jsx(X,{disabled:B})})})})]})]})]}),e.jsxs("div",{className:"d-flex justify-content-between mt-5",children:[e.jsx("div",{className:"",children:e.jsx($,{style:{borderColor:"blue",color:"blue"},onClick:le,children:"Subir Documentos de Apoyo"})}),e.jsx("div",{className:"",children:e.jsx(b.Item,{children:e.jsx($,{type:"primary",htmlType:"submit",className:"float-right",children:"Seguir"})})})]})]})}),e.jsx(ae,{title:"Seleccionar Documentos de Apoyo",open:H,onOk:Se,onCancel:Ce,children:e.jsx(Xe,{customRequest:V,onChange:K,maxCount:5,children:e.jsx($,{icon:e.jsx(St,{}),children:"Clic para seleccionar"})})})]})},kl=({value:s,setValue:t,number:l,show:x,setShow:c})=>{const[a]=b.useForm(),n=D(m=>m.permits.permit),i=D(m=>m.users.user),[o,d]=r.useState(l);r.useState(!1),r.useState(!0);const[h,v]=r.useState(!1),f="DD/MM/YYYY HH:mm",[p,{isSuccess:j,error:w,reset:k}]=ce();r.useEffect(()=>{var m,S,N,A,I,T,P,G,_,M,E,y,U,B;if((n==null?void 0:n.formNumber)===parseInt(l)){const q={calibrationDate:(m=n==null?void 0:n.section3)!=null&&m.calibrationDate?W((S=n==null?void 0:n.section3)==null?void 0:S.calibrationDate):null,verificationDate:(N=n==null?void 0:n.section3)!=null&&N.verificationDate?W((A=n==null?void 0:n.section3)==null?void 0:A.verificationDate):null,row1Col1:(I=n==null?void 0:n.section3)!=null&&I.row1Col1?W((T=n==null?void 0:n.section3)==null?void 0:T.row1Col1):null,row1Col2:(P=n==null?void 0:n.section3)!=null&&P.row1Col2?W((G=n==null?void 0:n.section3)==null?void 0:G.row1Col2):null,row1Col3:(_=n==null?void 0:n.section3)!=null&&_.row1Col3?W((M=n==null?void 0:n.section3)==null?void 0:M.row1Col3):null,row1Col4:(E=n==null?void 0:n.section3)!=null&&E.row1Col4?W((y=n==null?void 0:n.section3)==null?void 0:y.row1Col4):null,row1Col5:(U=n==null?void 0:n.section3)!=null&&U.row1Col5?W((B=n==null?void 0:n.section3)==null?void 0:B.row1Col5):null},H={...n==null?void 0:n.section3,...q};a.setFieldsValue(H),(n==null?void 0:n.status)==="waiting"&&ye.includes(i==null?void 0:i.role)?v(!0):v(!1)}},[]);const u=(m,S,N,A,I,T,P)=>e.jsx(e.Fragment,{children:N==="checkbox"?e.jsx(b.Item,{label:m,name:S,valuePropName:"checked",rules:[{type:N,message:`The input is not valid ${N}`},{required:I,message:`Please input a ${m}`}],children:e.jsx(X,{onChange:T,indeterminate:!1,disabled:P})},S):e.jsxs(b.Item,{name:S,label:m,rules:[{type:N,message:`The input is not valid ${N}`},{required:I,message:`Please input a ${m}`}],children:[N==="select"&&e.jsx(Select,{placeholder:`Input ${m}`,options:A,disabled:select}),N==="text"&&S!=="idEquipment"&&e.jsx(Y,{placeholder:`Input ${m||"data"}`,disabled:P}),N==="text"&&S==="idEquipment"&&e.jsx(Y,{placeholder:`Input ${m||"data"}`,disabled:P}),N==="radio"&&e.jsx(he.Group,{options:A,disabled:P}),N==="date"&&e.jsx(fe,{format:f,disabled:P})]},S)}),g=m=>{const S={...n,status:"pending",section3:{...m,completed:!0}};p({id:n._id,data:S}).then(N=>{N.data.status===200&&(c(4),t("4"))}),h&&(c(4),t("4"))};return e.jsxs("div",{className:"container-fluid pageContainer",children:[e.jsx("hr",{}),e.jsxs("div",{className:"d-flex justify-content-between ps-2 pe-2",children:[e.jsx("div",{className:"textSubtitle",children:"MONITOREO DE GASES"}),e.jsxs("div",{className:"textSubtitle",children:["Permiso Número: ",o]})]}),e.jsx("hr",{}),e.jsx("div",{style:{marginRight:10},children:e.jsxs(b,{form:a,name:"section3",onFinish:g,layout:"horizontal",initialValues:{idEquipment:n==null?void 0:n.section1.equipment.internalId},children:[e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col",children:e.jsx("div",{className:"d-flex",children:u("No Requerido","noRequired","checkbox",null,!1,null,h)})}),e.jsx("div",{className:"col",children:e.jsx("div",{className:"d-flex",children:u("Inicial","starter","checkbox",null,!1,null,h)})}),e.jsx("div",{className:"col",children:e.jsx("div",{className:"d-flex",children:u("Aleatorio","random","checkbox",null,!1,null,h)})}),e.jsx("div",{className:"col",children:e.jsx("div",{className:"d-flex",children:u("Continuo","continue","checkbox",null,!1,null,h)})}),e.jsx("div",{className:"col",children:e.jsx("div",{className:"d-flex",children:u("Registro cada(Min)","byMinutes","checkbox",null,!1,null,h)})})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-4",children:e.jsx("div",{className:"d-flex",children:u("Nombre Inspector de Atmósfera","atmInspector","text",null,null,null,h)})}),e.jsx("div",{className:"col-3",children:e.jsx("div",{className:"d-flex",children:u("#Serial Equipo","idEquipment","text",null,null,null,h)})}),e.jsx("div",{className:"col",children:e.jsx("div",{className:"d-flex",children:u("Fecha Calibración","calibrationDate","date",null,null,null,h)})}),e.jsx("div",{className:"col",children:e.jsx("div",{className:"d-flex",children:u("Fecha Verificación","verificationDate","date",null,null,null,h)})})]}),e.jsxs("div",{className:"row gasHeight",children:[e.jsx("div",{className:"col-2",children:e.jsx("div",{className:"",children:"Fecha y Hora:"})}),e.jsxs("div",{className:"col-10",children:[" ",e.jsxs("div",{className:"d-flex flex-row justify-content-end",children:[u(null,"row1Col1","date",null,null,null,h),u(null,"row1Col2","date",null,null,null,h),u(null,"row1Col3","date",null,null,null,h),u(null,"row1Col4","date",null,null,null,h),u(null,"row1Col5","date",null,null,null,h)]})]})]}),e.jsxs("div",{className:"row gasHeight",children:[e.jsx("div",{className:"col-2",children:e.jsx("div",{className:"",children:"%LEL | 0%"})}),e.jsxs("div",{className:"col-10",children:[" ",e.jsxs("div",{className:"d-flex flex-row justify-content-end",children:[u(null,"row2Col1","text",null,null,null,h),u(null,"row2Col2","text",null,null,null,h),u(null,"row2Col3","text",null,null,null,h),u(null,"row2Col4","text",null,null,null,h),u(null,"row2Col5","text",null,null,null,h)]})]})]}),e.jsxs("div",{className:"row gasHeight",children:[e.jsx("div",{className:"col-2",children:e.jsx("div",{className:"",children:"%02 | 19.5% a 22.5%"})}),e.jsxs("div",{className:"col-10",children:[" ",e.jsxs("div",{className:"d-flex flex-row justify-content-end",children:[u(null,"row3Col1","text",null,null,null,h),u(null,"row3Col2","text",null,null,null,h),u(null,"row3Col3","text",null,null,null,h),u(null,"row3Col4","text",null,null,null,h),u(null,"row3Col5","text",null,null,null,h)]})]})]}),e.jsxs("div",{className:"row gasHeight",children:[e.jsx("div",{className:"col-2",children:e.jsx("div",{className:"",children:"CO (ppm) | s25"})}),e.jsxs("div",{className:"col-10",children:[" ",e.jsxs("div",{className:"d-flex flex-row justify-content-end",children:[u(null,"row4Col1","text",null,null,null,h),u(null,"row4Col2","text",null,null,null,h),u(null,"row4Col3","text",null,null,null,h),u(null,"row4Col4","text",null,null,null,h),u(null,"row4Col5","text",null,null,null,h)]})]})]}),e.jsxs("div",{className:"row gasHeight",children:[e.jsx("div",{className:"col-2",children:e.jsx("div",{className:"",children:"H2s (ppm) | s1"})}),e.jsxs("div",{className:"col-10",children:[" ",e.jsxs("div",{className:"d-flex flex-row justify-content-end",children:[u(null,"row5Col1","text",null,null,null,h),u(null,"row5Col2","text",null,null,null,h),u(null,"row5Col3","text",null,null,null,h),u(null,"row5Col4","text",null,null,null,h),u(null,"row5Col5","text",null,null,null,h)]})]})]}),e.jsxs("div",{className:"row gasHeight",children:[e.jsx("div",{className:"col-2",children:e.jsx("div",{className:"",children:"OTRO"})}),e.jsxs("div",{className:"col-10",children:[" ",e.jsxs("div",{className:"d-flex flex-row justify-content-end",children:[u(null,"row6Col1","text",null,null,null,h),u(null,"row6Col2","text",null,null,null,h),u(null,"row6Col3","text",null,null,null,h),u(null,"row6Col4","text",null,null,null,h),u(null,"row6Col5","text",null,null,null,h)]})]})]}),e.jsxs("div",{className:"row gasHeight",children:[e.jsx("div",{className:"col-2",children:e.jsx("div",{className:"",children:"FIRMA INSPECTOR"})}),e.jsxs("div",{className:"col-10",children:[" ",e.jsxs("div",{className:"d-flex flex-row justify-content-end",children:[u(null,"row7Col1","text",null,null,null,h),u(null,"row7Col2","text",null,null,null,h),u(null,"row7Col3","text",null,null,null,h),u(null,"row7Col4","text",null,null,null,h),u(null,"row7Col5","text",null,null,null,h)]})]})]}),e.jsx("div",{className:"d-flex justify-content-end mt-5",children:e.jsx(b.Item,{children:e.jsx($,{type:"primary",htmlType:"submit",className:"float-right",children:"Seguir"})})})]})})]})};function Ie(s){function t(T,P){return T>>>P|T<<32-P}for(var l=Math.pow,x=l(2,32),c="length",a,n,i="",o=[],d=s[c]*8,h=Ie.h=Ie.h||[],v=Ie.k=Ie.k||[],f=v[c],p={},j=2;f<64;j++)if(!p[j]){for(a=0;a<313;a+=j)p[a]=j;h[f]=l(j,.5)*x|0,v[f++]=l(j,1/3)*x|0}for(s+="";s[c]%64-56;)s+="\0";for(a=0;a<s[c];a++){if(n=s.charCodeAt(a),n>>8)return;o[a>>2]|=n<<(3-a)%4*8}for(o[o[c]]=d/x|0,o[o[c]]=d,n=0;n<o[c];){var w=o.slice(n,n+=16),k=h;for(h=h.slice(0,8),a=0;a<64;a++){var u=w[a-15],g=w[a-2],m=h[0],S=h[4],N=h[7]+(t(S,6)^t(S,11)^t(S,25))+(S&h[5]^~S&h[6])+v[a]+(w[a]=a<16?w[a]:w[a-16]+(t(u,7)^t(u,18)^u>>>3)+w[a-7]+(t(g,17)^t(g,19)^g>>>10)|0),A=(t(m,2)^t(m,13)^t(m,22))+(m&h[1]^m&h[2]^h[1]&h[2]);h=[N+A|0].concat(h),h[4]=h[4]+N|0}for(a=0;a<8;a++)h[a]=h[a]+k[a]|0}for(a=0;a<8;a++)for(n=3;n+1;n--){var I=h[a]>>n*8&255;i+=(I<16?0:"")+I.toString(16)}return i}const _s=({prefix:s,user:t,initialValues:l,onSubmit:x,disabled:c})=>{const[a,n]=r.useState({}),[i,o]=r.useState(!1),[d]=b.useForm();r.useEffect(()=>{if(l===null&&c===!1){n(!1);const v={[`name${s}`]:t==null?void 0:t.name,[`sign${s}`]:t.name,[`date${s}`]:W()};console.log("entrooooo",v),n(v),d.setFieldsValue(v),o(!0)}else n(!1),n(l),d.setFieldsValue(l),o(!0)},[s,t,l,c]);const h=(v,f,p,j)=>e.jsxs(b.Item,{name:`${f}${s}`,label:v,rules:[{required:j,message:`Please input a ${v}`}],className:"field-input-content",children:[p==="text"&&e.jsx(Y,{placeholder:`Input ${v||"data"}`,disabled:c}),p==="date"&&e.jsx(fe,{disabled:c,placeholder:"dd/mm/aaaa",className:"px-3"})]},`${f}${s}`);return i&&e.jsxs(b,{form:d,name:"signForm",className:"w-100 h-100 d-flex row justify-content-center",layout:"vertical",onFinish:x,children:[h("Nombre","name","text",!0),h("Firma","sign","text",!0),h("Fecha","date","date",!0),c&&l!==null?e.jsx("span",{children:"Firmado"}):e.jsx($,{className:"buton-card-singing",type:"primary",htmlType:"submit",disabled:c,children:"Firmar"})]})},Gs=({section1:s})=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"d-flex flex-direction-row",children:[e.jsx("span",{className:"p-1 bg-secondary text-white text-center section-title",style:{width:"13%"},children:"SECCION 1"}),e.jsxs("div",{className:"section-title d-flex justify-content-start align-items-center",style:{width:"87%"},children:[" ","INFORMACIÓN GENERAL"]})]}),e.jsxs("div",{className:"row section-label",children:[e.jsxs("div",{className:"col",children:[e.jsxs("p",{children:["Fecha de solicitud:"," ",e.jsx("span",{children:W(s==null?void 0:s.updatedAt).format("DD/MM/YYYY")})]}),e.jsxs("p",{className:"ps-2",children:["Hora: ",e.jsx("span",{children:W(s==null?void 0:s.updatedAt).format("HH:mm")})]})]}),e.jsx("div",{className:"col",children:e.jsxs("p",{children:["Compañia que requiere el servicio: ",e.jsx("span",{children:s==null?void 0:s.company})]})}),e.jsx("div",{className:"col",children:e.jsxs("p",{children:["Instalación: ",e.jsx("span",{children:s==null?void 0:s.location})]})}),e.jsx("div",{className:"col",children:e.jsxs("p",{children:["Area: ",e.jsx("span",{children:s==null?void 0:s.area.label})]})})]}),e.jsxs("div",{className:"row section-label mt-2",children:[e.jsx("div",{className:"col",children:e.jsxs("p",{children:["Equipos a intervenir: ",e.jsx("span",{children:s==null?void 0:s.equipment.label})]})}),e.jsx("div",{className:"col",children:e.jsxs("p",{children:["Alcance del trabajo: ",e.jsx("span",{children:s==null?void 0:s.alcance})]})}),e.jsx("div",{className:"col",children:e.jsxs("p",{children:["Nivel potencial de peligro identificado:"," ",e.jsx("span",{children:s==null?void 0:s.warning})]})}),e.jsx("div",{className:"col",children:e.jsxs("p",{children:["Equipos y herramientas a usar: ",e.jsx("span",{children:s==null?void 0:s.tools})]})})]})]}),Qs=({section2:s})=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"d-flex flex-direction-row",children:[e.jsx("span",{className:"p-1 bg-secondary text-white text-center section-title",style:{width:"13%"},children:"SECCION 2"}),e.jsxs("div",{className:"section-title d-flex justify-content-start align-items-center",style:{width:"87%"},children:[" ","ANÁLISIS DE RIESGOS, CERTIFICADOS DE APOYO Y DOCUMENTO DE APOYO REQUERIDOS"]})]}),e.jsx("div",{className:"section-subtitle",children:"ANÁLISIS DE RIESGOS REQUERIDOS"}),e.jsxs("div",{className:"row section-label mb-2",children:[e.jsx("div",{className:"col",children:e.jsxs("p",{children:["Análisis de seguridad en el trabajo - AST:"," ",e.jsxs("span",{className:"",children:[s!=null&&s.check1?"si":"No aplica"," ",s==null?void 0:s.astNumber]})]})}),e.jsx("div",{className:"col",children:e.jsxs("p",{children:["Análisis de peligro en la etapa de Planificación - APP:"," ",e.jsx("span",{className:"",children:s!=null&&s.apep?s.apep:"No aplica"})]})}),e.jsx("div",{className:"col",children:e.jsxs("p",{children:["Otro: ",s!=null&&s.check2?"si":"N/A",e.jsxs("span",{className:"ps-2",children:["Cual? : ",s!=null&&s.oAnalysisDescription?s.oAnalysisDescription:"No aplica"]})]})})]}),e.jsx("div",{className:"section-subtitle",children:"CERTIFICADOS DE APOYO REQUERIDOS"}),e.jsxs("div",{className:"row section-label mt-2",children:[e.jsx("div",{className:"col",children:e.jsxs("p",{children:["Certificado de apoyo Trabajo en Caliente: ",e.jsx("span",{children:s!=null&&s.caliente?s==null?void 0:s.caliente:"No aplica"})]})}),e.jsx("div",{className:"col",children:e.jsxs("p",{children:["Certificado de apoyo de Raciaciones: ",e.jsx("span",{children:s!=null&&s.raciaciones?s==null?void 0:s.raciaciones:"No aplica"})]})}),e.jsx("div",{className:"col",children:e.jsxs("p",{children:["Certificado de apoyo de Excavación: ",e.jsx("span",{children:s!=null&&s.excavacion?s==null?void 0:s.excavacion:"No aplica"})]})})]}),e.jsxs("div",{className:"row section-label mt-2",children:[e.jsx("div",{className:"col",children:e.jsxs("p",{children:["Certificado de apoyo Trabajo en Altura: ",e.jsx("span",{children:s!=null&&s.altura?s==null?void 0:s.altura:"No aplica"})]})}),e.jsx("div",{className:"col",children:e.jsxs("p",{children:["Certificado de apoyo Izaje de Carga: ",e.jsx("span",{children:s!=null&&s.izaje?s==null?void 0:s.izaje:"No aplica"})]})}),e.jsx("div",{className:"col",children:e.jsxs("p",{children:["Certificado de apoyo Espacios Confinados: ",e.jsx("span",{children:s!=null&&s.confinados?s==null?void 0:s.confinados:"No aplica"})]})})]}),e.jsxs("div",{className:"row section-label mt-2",children:[e.jsx("div",{className:"col",children:e.jsxs("p",{children:["Otro? : ",e.jsx("span",{children:s!=null&&s.check3?"si":"N/A"})]})}),(s==null?void 0:s.oSupportDescription)&&e.jsx("div",{className:"col",children:e.jsxs("p",{children:["Cual? : ",e.jsx("span",{children:s==null?void 0:s.oSupportDescription})]})})]})]}),Ws=({section3:s})=>{const t="DD/MM/YYYY",l=s.row1Col1!==null,x=["Fecha y Hora:","%LEL | 0%","%02 | 19.5% a 22.5%","CO (ppm) | s25","H2s (ppm) | s1","OTRO","FIRMA INSPECTOR"],c=[];for(let i=1;i<=7;i++){const o=[x[i-1],i===1?s[`row${i}Col1`]?W(s[`row${i}Col1`]).format(t):"":s[`row${i}Col1`],i===1?s[`row${i}Col2`]?W(s[`row${i}Col2`]).format(t):"":s[`row${i}Col2`],i===1?s[`row${i}Col3`]?W(s[`row${i}Col3`]).format(t):"":s[`row${i}Col3`],i===1?s[`row${i}Col4`]?W(s[`row${i}Col4`]).format(t):"":s[`row${i}Col4`],i===1?s[`row${i}Col5`]?W(s[`row${i}Col5`]).format(t):"":s[`row${i}Col5`]];o.pop(),c.push(o)}const a=[{title:"",dataIndex:"label",key:"label",width:200},{title:"",dataIndex:"0",key:"0"},{title:"",dataIndex:"1",key:"1"},{title:"",dataIndex:"2",key:"2"},{title:"",dataIndex:"3",key:"3"},{title:"",dataIndex:"4",key:"4"}],n=c.map((i,o)=>({key:o,label:i[0],...i.slice(1)}));return l&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"d-flex flex-direction-row",children:[e.jsx("span",{className:"p-1 bg-secondary text-white text-center section-title",style:{width:"13%"},children:"SECCION 3"}),e.jsx("div",{className:"section-title d-flex justify-content-start align-items-center",style:{width:"87%"},children:"MONITOREO DE GASES"})]}),e.jsxs("div",{className:"row section-label mb-2",children:[e.jsxs("div",{className:"col",children:[e.jsx("p",{children:"No requerido :"}),e.jsx("span",{children:s!=null&&s.noRequired?"Si":"No aplica"})]}),e.jsxs("div",{className:"col",children:[e.jsx("p",{children:"Inicial :"}),e.jsx("span",{children:s!=null&&s.starter?"Si":"No aplica"})]}),e.jsxs("div",{className:"col",children:[e.jsx("p",{children:"Aleatorio :"}),e.jsx("span",{children:s!=null&&s.random?"Si":"No aplica"})]}),e.jsxs("div",{className:"col",children:[e.jsx("p",{children:"Continuo:"}),e.jsx("span",{children:s!=null&&s.continue?"Si":"No aplica"})]}),e.jsxs("div",{className:"col",children:[e.jsx("p",{children:"Registro cada(Min) :"}),e.jsx("span",{children:s!=null&&s.byMinutes?"Si":"No aplica"})]})]}),e.jsxs("div",{className:"row section-label mb-2",children:[e.jsxs("div",{className:"col",children:[e.jsx("p",{children:"Nombre Inspector de Atmósfera :"}),e.jsx("span",{children:s!=null&&s.atmInspector?s.atmInspector:"No aplica"})]}),e.jsxs("div",{className:"col",children:[e.jsx("p",{children:"#Serial Equipo :"}),e.jsx("span",{children:s!=null&&s.idEquipment?s.idEquipment:"No aplica"})]}),e.jsxs("div",{className:"col",children:[e.jsx("p",{children:"Fecha Calibración :"}),e.jsx("span",{children:s!=null&&s.calibrationDate?W(s.calibrationDate).format(t):"No aplica"})]}),e.jsxs("div",{className:"col",children:[e.jsx("p",{children:"Fecha Verificación :"}),e.jsx("span",{children:s!=null&&s.verificationDate?s.verificationDate:"No aplica"})]})]}),e.jsx("div",{className:"container-fluid pageContainer",children:e.jsx("div",{style:{marginRight:10},children:e.jsx(pe,{dataSource:n,columns:a,pagination:!1,bordered:!0,size:"small"})})})]})},Js=({section4:s})=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"d-flex flex-direction-row",children:[e.jsx("span",{className:"p-1 bg-secondary text-white text-center section-title",style:{width:"13%"},children:"SECCION 4"}),e.jsxs("div",{className:"section-title d-flex justify-content-start align-items-center",style:{width:"87%"},children:[" ","REVISIÓN CONDICIONES PREINICIO DE TRABAJO"]})]}),e.jsxs("div",{className:"row section-label",children:[e.jsx("div",{className:"",children:e.jsxs("p",{children:["El personal manfiesta encontrase en buenas condiciones de salud:"," ",e.jsx("span",{children:(s==null?void 0:s.healthy)===!0?"Si":"No aplica"})]})}),e.jsx("div",{className:"",children:e.jsxs("p",{children:["Se ha completado el aislamiento, bloqueo y etiquetado: ",e.jsx("span",{children:(s==null?void 0:s.isnulate)==="si"?"Si":"No aplica"})]})}),e.jsx("div",{className:"row section-label",children:e.jsx("div",{className:"",children:e.jsxs("p",{children:["Los equipos se encuentran en condiciones seguras para se intervenidos: ",e.jsx("span",{children:(s==null?void 0:s.safety)==="si"?"Si":"No aplica"})]})})})]})]}),El=({user:s,initialValues:t,values:l})=>{je();const[x,{isSuccess:c,error:a,reset:n}]=ce(),i=D(f=>f.permits.permit),[o,d]=r.useState(!!t),h=(f,p)=>{const j={...i,status:"pending",section5:{...i.section5,[p]:{...f},completed:!0}};x({id:i._id,data:j}).then(w=>{w.data.status===200&&(d(!0),console.log("Received values of form: ",w.data),J({content:"Se ha firmado exitosamente",title:"Permiso Aprobado"}),n())})},v={nameAe:s==null?void 0:s.name,signAe:s==null?void 0:s.name,dateAe:W()};return e.jsxs(e.Fragment,{children:[e.jsx("div",{children:e.jsx(Gs,{section1:i==null?void 0:i.section1})}),e.jsx("div",{children:e.jsx(Qs,{section2:i==null?void 0:i.section2})}),e.jsx("div",{children:e.jsx(Ws,{section3:i==null?void 0:i.section3})}),e.jsx("div",{children:e.jsx(Js,{section4:i!=null&&i.section4.completed?i==null?void 0:i.section4:l})}),e.jsx("div",{className:"d-flex mt-3",style:{justifyContent:"center"},children:e.jsx(Be,{style:{width:300},children:e.jsx(_s,{prefix:"Ae",user:s,initialValues:t?{...t,dateAe:W(t==null?void 0:t.dateAe)}:v,onSubmit:f=>h(f,"section53"),disabled:o})})})]})},Al=({value:s,setValue:t,number:l,show:x,setShow:c})=>{var U,B,q,H;const a=je(),[n,i]=r.useState(!1),[o,d]=r.useState({}),[h,v]=r.useState(null),[f]=b.useForm(),p=D(z=>z.permits.permit),j=D(z=>z.users.user),[w,k]=r.useState({}),[u,g]=r.useState(l);r.useState(!1);const[m,S]=r.useState(!1),N="DD/MM/YYYY HH:mm",[A,{isSuccess:I,error:T,reset:P}]=ce();r.useEffect(()=>{if((p==null?void 0:p.formNumber)===parseInt(l)){const z={...p==null?void 0:p.section4};f.setFieldsValue(z),(p==null?void 0:p.status)==="waiting"&&ye.includes(j==null?void 0:j.role),S(!1)}},[]);const G=[{label:"Si",value:"si"},{label:"N/A",value:"na"}],_=(z,F,C,R,O,Q,le)=>e.jsx(e.Fragment,{children:C==="checkbox"?e.jsx(b.Item,{label:z,name:F,valuePropName:"checked",rules:[{type:C,message:`The input is not valid ${C}`},{required:O,message:`Please input a ${z}`}],children:e.jsx(X,{onChange:Q,indeterminate:!1,disabled:le})},F):e.jsxs(b.Item,{name:F,label:z,rules:[{type:C,message:`The input is not valid ${C}`},{required:O,message:`Please input a ${z}`}],children:[C==="select"&&e.jsx(Select,{placeholder:`Input ${z}`,options:R,disabled:select}),C==="text"&&e.jsx(Y,{placeholder:`Input ${z||"data"}`,disabled:le}),C==="radio"&&e.jsx(he,{disabled:le}),C==="radiogroup"&&e.jsx(he.Group,{options:R,disabled:le}),C==="date"&&e.jsx(fe,{format:N,disabled:le})]},F)}),M=z=>{var Q;const F=[p==null?void 0:p.formNumber],C=[(Q=p==null?void 0:p.section1.equipment)==null?void 0:Q.label.trim().split(" ").join("")],R=F.concat(C),O=Ie(R);d(z),v(O),i(!0)},E=(z,F)=>{const C=`https://api.stamping.io/util/keys/create/?pwd=${z}&token=1ff366eb140491c61d626af1238b09b5a284e143bf713026f3b8ca4038d`;fetch(C).then(R=>R.json()).then(R=>{const O={...p,status:"waiting",section4:{...F,completed:!0},more:{publicKey:R.RSA.publicKey,privateKey:R.RSA.privateKey}};y(O)})},y=z=>{A({id:p._id,data:z}).then(F=>{F.data.status===200&&(J({title:"Solicitud Enviada",content:"La solicitud fue enviada exitosamente"}),a("/permissions"))}),P()};return e.jsxs("div",{className:"container-fluid pageContainer",children:[e.jsx("hr",{}),e.jsxs("div",{className:"d-flex justify-content-between ps-2 pe-2",children:[e.jsx("div",{className:"textSubtitle",children:"REVISION CONDICIONES PREINICIO DE TRABAJO"}),e.jsxs("div",{className:"textSubtitle",children:["Permiso Número: ",u]})]}),e.jsx("hr",{}),e.jsx("div",{style:{marginRight:10},children:e.jsxs(b,{form:f,layout:"horizonatl",name:"section4",initialValues:w,onValuesChange:()=>{k(f.getFieldsValue())},onFinish:M,children:[e.jsx("div",{className:"row",children:e.jsx("div",{className:"col",children:e.jsxs("div",{className:"d-flex justify-content-start align-items-baseline",children:[e.jsx("div",{className:"",children:"EL PERSONAL MANIFIESTA ENCONTRARSE EN BUENAS CONDICIONES DE SALUD"}),e.jsx("div",{className:"ms-4",children:_("","healthy","checkbox",null,!0,null,m)})]})})}),e.jsx("div",{className:"row",children:e.jsx("div",{className:"col",children:e.jsxs("div",{className:"d-flex justify-content-start align-items-baseline",children:[e.jsx("div",{className:"",children:"SE HA COMPLETADO EL AISLAMIENTO, BLOQUEO Y ETIQUETADO"}),e.jsx("div",{className:"ms-4",children:_("","isnulate","radiogroup",G,!0,null,m)})]})})}),e.jsx("div",{className:"row",children:e.jsx("div",{className:"col",children:e.jsxs("div",{className:"d-flex justify-content-start align-items-baseline",children:[e.jsx("div",{className:"",children:"LOS EQUIPOS SE ENCUENTRAN EN CONDICIONES SEGURAS PARA SER ITERVENIDOS"}),e.jsx("div",{className:"ms-4",children:_("","safety","radiogroup",G,!1,null,m)})]})})}),e.jsx("div",{className:"d-flex justify-content-end mt-5",children:e.jsx(b.Item,{children:e.jsx($,{type:"primary",htmlType:"submit",className:"float-right",children:"Enviar Solicitud"})})})]})}),e.jsx(ae,{title:e.jsx("h2",{className:"d-flex justify-content-center mb-4",children:"Resumen permiso de trabajo general"}),centered:!0,open:n,onOk:()=>E(h,o),onCancel:()=>i(!1),width:1e3,okText:"Enviar solicitud",cancelText:"Editar",okButtonProps:{disabled:(U=p==null?void 0:p.section4)==null?void 0:U.completed},cancelButtonProps:{disabled:(B=p==null?void 0:p.section4)==null?void 0:B.completed},children:e.jsx(El,{user:j,initialValues:(q=p==null?void 0:p.section5)!=null&&q.section53?(H=p==null?void 0:p.section5)==null?void 0:H.section53:null,values:o})})]})},Il=()=>{const s=je(),t=D(f=>f.permits.permit),l=D(f=>f.users.user),[x,c]=r.useState({}),[a,{isSuccess:n,error:i,reset:o}]=ce();r.useEffect(()=>{d(l==null?void 0:l.role)},[l]);const d=f=>{const p={};switch(f){case"autoridadArea":p.disabledAda=!1,p.disabledAal=!0,p.disabledAe=!0,p.disabledOa=!0;break;case"autoridadMunicipal":p.disabledAda=!0,p.disabledAal=!1,p.disabledAe=!0,p.disabledOa=!0;break;case"contractor":p.disabledAda=!0,p.disabledAal=!0,p.disabledAe=!1,p.disabledOa=!0;break;default:p.disabledAda=!0,p.disabledAal=!0,p.disabledAe=!0,p.disabledOa=!1;break}c(p)},h=(f,p)=>{const j={...t,status:"approved",section5:{...t.section5,[p]:{...f},completed:!0}};t.section4.completed?a({id:t._id,data:j}).then(w=>{w.data.status===200&&(console.log("Received values of form: ",w.data),J({content:"Se ha aprobado el permiso",title:"Permiso Aprobado"}),o(),s("/permissions"))}):te({content:"El formulario no está completo",title:"Firma denegada"})},v=[{prefix:"Ada",label:"Autoridad de Area",section:"section51"},{prefix:"Aal",label:"Autoridad de Area Local",section:"section52"},{prefix:"Ae",label:"Autoridad Ejecutante",section:"section53"},{prefix:"Oa",label:"Otra Autoridad",section:"section54"}];return e.jsxs("div",{className:"container-fluid pageContainer p-0 h-100 ",children:[e.jsx("hr",{}),e.jsxs("div",{className:"d-flex justify-content-between ps-2 pe-2",children:[e.jsx("div",{className:"textSubtitle",children:"APROBACION"}),e.jsxs("div",{className:"textSubtitle",children:["Permiso Número: ",t==null?void 0:t.formNumber]})]}),e.jsx("hr",{}),e.jsx("div",{className:"d-flex column h-75 w-100 justify-content-center ",children:e.jsx("div",{className:"row gap-4 align-content-center flex-nowrap overflow-hidden overflow-x-scroll p-3 scroll-myProp",style:{width:"90%",height:"98%"},children:v.map(f=>{var w,k,u;const p={...(w=t==null?void 0:t.section5)==null?void 0:w[f.section]};let j=!1;return p&&((k=t==null?void 0:t.section5)!=null&&k[f.section])&&(p[`date${f.prefix}`]=W(p[`date${f.prefix}`])||"",j=Object.keys(p).length>0),e.jsxs("div",{className:`col box-shadow p-3 col-md-4 card-container-singing ${j||x[`disabled${f.prefix}`]?"disabled":""}`,children:[e.jsxs("h6",{className:"title-card-singing",children:[f.label," ",j&&e.jsx(Ct,{})," "]}),e.jsx("div",{className:"bar-card-singing"}),e.jsx(_s,{className:" ",prefix:f.prefix,user:l,initialValues:(u=t==null?void 0:t.section5)!=null&&u[f.section]?p:null,onSubmit:g=>h(g,f.section),disabled:j||x[`disabled${f.prefix}`]})]},f.prefix)})})})]})},Fl=()=>{b.useForm();const s=D(x=>x.permits.permit);D(x=>x.users.user),r.useState({}),ce(),r.useEffect(()=>{},[]);const t=[{title:"Motivo",dataIndex:"motivo",key:"motivo"},{title:"Hora",dataIndex:"date",key:"date"},{title:"Firma AE",dataIndex:"signAe",key:"signAe"},{title:"Firma AAL",dataIndex:"signAal",key:"signAal"}],l=[{title:"Fecha",dataIndex:"rdate",key:"rdate"},{title:"Hora Inicio",dataIndex:"rstart",key:"rstart"},{title:"Hora Fin",dataIndex:"rend",key:"rend"},{title:"Firma AE",dataIndex:"signAe",key:"signAe"},{title:"Firma AAL",dataIndex:"signAal",key:"signAal"}];return e.jsxs("div",{className:"container-fluid pageContainer",children:[e.jsx("hr",{}),e.jsxs("div",{className:"d-flex justify-content-between ps-2 pe-2",children:[e.jsx("div",{className:"textSubtitle",children:"SUSPENSIONES Y REVALIDACIONES"}),e.jsxs("div",{className:"textSubtitle",children:["Permiso Número: ",s==null?void 0:s.formNumber]})]}),e.jsx("hr",{}),e.jsxs("div",{style:{marginRight:10},children:[e.jsxs("div",{className:"row",children:[e.jsx("p",{className:"mb-2",children:"Suspenciones"}),e.jsx(pe,{columns:t,dataSource:s==null?void 0:s.suspensions,pagination:!1})]}),e.jsxs("div",{className:"row",children:[e.jsx("p",{className:"mb-2 mt-2",children:"Revalidaciones"}),e.jsx(pe,{columns:l,dataSource:s==null?void 0:s.suspensions,pagination:!1})]}),e.jsxs("div",{className:"d-flex justify-content-around mt-5",children:[e.jsx($,{type:"primary",htmlType:"submit",className:"float-right",children:"Suspenciones"}),e.jsx($,{type:"primary",htmlType:"submit",className:"float-right",children:"Revalidaciones"})]})]})]})},Ol=()=>{const[s]=b.useForm(),t=D(k=>k.permits.permit);D(k=>k.users.user);const[l,x]=r.useState({}),[c,a]=r.useState(!1),[n,i]=r.useState(!0),[o,d]=r.useState(!0),[h,v]=r.useState(!0);ce();const f="DD/MM/YYYY HH:mm",p=k=>{k==="check1"&&i(!n),k==="check2"&&d(!o),k==="check3"&&v(!h)};r.useEffect(()=>{},[]);const j=(k,u,g,m,S,N,A)=>e.jsx(e.Fragment,{children:g==="checkbox"?e.jsx(b.Item,{label:k,name:u,valuePropName:"checked",rules:[{type:g,message:`The input is not valid ${g}`},{required:S,message:`Please input a ${k}`}],children:e.jsx(X,{onChange:()=>p(N),indeterminate:!1,disabled:A})},u):e.jsxs(b.Item,{name:u,label:k,rules:[{type:g,message:`The input is not valid ${g}`},{required:S,message:`Please input a ${k}`}],children:[g==="text"&&e.jsx(Y,{placeholder:`Input ${k||"data"}`,disabled:A}),g==="date"&&e.jsx(fe,{format:f,disabled:A})]},u)}),w=k=>{console.log("Submit: ",k),{...t,section7:{...k}}};return e.jsxs("div",{className:"container-fluid pageContainer",children:[e.jsx("hr",{}),e.jsxs("div",{className:"d-flex justify-content-between ps-2 pe-2",children:[e.jsx("div",{className:"textSubtitle",children:"REGISTRO ACOMPAÑAMIENTO DURANTE EJECUCION"}),e.jsxs("div",{className:"textSubtitle",children:["Permiso Número: ",t==null?void 0:t.formNumber]})]}),e.jsx("hr",{}),e.jsx("div",{style:{marginRight:10},children:e.jsxs(b,{form:s,layout:"horizonatl",name:"section7",initialValues:l,onValuesChange:()=>{x(s.getFieldsValue())},onFinish:w,children:[e.jsx("div",{className:"row",children:e.jsx("div",{className:"col",children:e.jsxs("div",{className:"d-flex justify-content-start align-items-baseline",children:[e.jsx("div",{className:"",children:"VISITA LIDERAZGO"}),e.jsx("div",{className:"ms-4",children:j("","visit","checkbox",null,!1,"check1",c)}),e.jsx("div",{className:"ms-4",children:j("Nombre","vname","text",null,!1,null,n)}),e.jsx("div",{className:"ms-4",children:j("Firma","vsign","text",null,!1,null,n)}),e.jsx("div",{className:"ms-4",children:j("Fecha","vdate","date",null,!0,null,n)})]})})}),e.jsx("div",{className:"row",children:e.jsx("div",{className:"col",children:e.jsxs("div",{className:"d-flex justify-content-start align-items-baseline",children:[e.jsx("div",{className:"",children:"CONVERSACION Y/O REFLEXXION"}),e.jsx("div",{className:"ms-4",children:j("","reflection","checkbox",null,!0,"check2",c)}),e.jsx("div",{className:"ms-4",children:j("Nombre","rname","text",null,!1,null,o)}),e.jsx("div",{className:"ms-4",children:j("Firma","rsign","text",null,!1,null,o)}),e.jsx("div",{className:"ms-4",children:j("Fecha","rdate","date",null,!1,null,o)})]})})}),e.jsx("div",{className:"row",children:e.jsx("div",{className:"col",children:e.jsxs("div",{className:"d-flex justify-content-start align-items-baseline",children:[e.jsx("div",{className:"",children:"REVISION DEL PERMISO"}),e.jsx("div",{className:"ms-4",children:j("","check","checkbox",null,!1,"check3",c)}),e.jsx("div",{className:"ms-4",children:j("Nombre","cname","text",null,!1,null,h)}),e.jsx("div",{className:"ms-4",children:j("Firma","csign","text",null,!1,null,h)}),e.jsx("div",{className:"ms-4",children:j("Fecha","cdate","date",null,!1,null,h)})]})})}),e.jsx("div",{className:"d-flex justify-content-end mt-5",children:e.jsx(b.Item,{children:e.jsx($,{type:"primary",htmlType:"submit",className:"float-right",children:"Enviar Registro"})})})]})})]})},Tl=()=>{const s=je(),[t,l,x,c]=b.useForm(),a=D(m=>m.permits.permit),n=D(m=>m.users.user),[i,o]=r.useState({});r.useState(""),r.useState([]);const[d,{isSuccess:h,error:v,reset:f}]=ce(),p="DD/MM/YYYY HH:mm";r.useEffect(()=>{const m={nameAda:n==null?void 0:n.name,signAda:n==null?void 0:n.name,dateAda:W(),nameAal:n==null?void 0:n.name,signAal:n==null?void 0:n.name,dateAal:W(),nameAe:n==null?void 0:n.name,signAe:n==null?void 0:n.name,dateAe:W(),nameOa:n==null?void 0:n.name,signOa:n==null?void 0:n.name,dateOa:W()};t.setFieldsValue(m),o(m)},[]);const j=(m,S,N,A,I,T,P)=>e.jsx(e.Fragment,{children:e.jsxs(b.Item,{name:S,label:m,rules:[{type:N,message:`The input is not valid ${N}`},{required:I,message:`Please input a ${m}`}],className:"field-input-content",children:[N==="text"&&e.jsx(Y,{placeholder:`Input ${m||"data"}`,disabled:P}),N==="date"&&e.jsx(fe,{format:p,disabled:P})]},S)}),w=m=>{const S={...a,status:"completed",section8:{...m,completed:!0}};d({id:a._id,data:S}).then(N=>{N.data.status===200&&(J({title:"Trabajo completado",content:"El trabajo ha sido completado con éxito"}),s(`/preview/${a==null?void 0:a.formNumber}`))})},k=m=>{console.log("Received values of form: ",m)},u=m=>{console.log("Received values of form: ",m)},g=m=>{console.log("Received values of form: ",m)};return e.jsxs("div",{className:"container-fluid pageContainer",children:[e.jsx("hr",{}),e.jsxs("div",{className:"d-flex justify-content-between ps-2 pe-2",children:[e.jsx("div",{className:"textSubtitle",children:"CIERRE"}),e.jsxs("div",{className:"textSubtitle",children:["Permiso Número: ",a==null?void 0:a.formNumber]})]}),e.jsx("hr",{}),e.jsx("div",{className:"d-flex column h-75 w-100 justify-content-center ",children:e.jsxs("div",{className:"row gap-4 align-content-center flex-nowrap overflow-hidden overflow-x-scroll p-3 scroll-myProp",style:{width:"90%",height:"98%"},children:[e.jsxs("div",{className:"col box-shadow p-3 col-md-4 card-container-singing",children:[e.jsx("h6",{className:"title-card-singing",children:"Autoridad de Area"}),e.jsx("div",{className:"bar-card-singing"}),e.jsxs(b,{form:t,name:"section81",layout:"vertical",initialValues:i,onFinish:w,className:"w-100 h-100 d-flex row justify-content-center",children:[j("Nombre","nameAda","text","",!0,"",!1),j("Firma","signAda","text","",!0,"",!1),j("Fecha","dateAda","date","",!0,"",!1),e.jsx($,{className:"buton-card-singing",type:"primary",htmlType:"submit",children:"Firmar"})]})]}),e.jsxs("div",{className:"col box-shadow p-3 col-md-4 card-container-singing ",children:[e.jsx("h6",{className:"title-card-singing",children:"Autoridad de Area Local"}),e.jsx("div",{className:"bar-card-singing"}),e.jsxs(b,{form:l,name:"section82",layout:"vertical",initialValues:i,onFinish:k,className:"w-100 h-100 d-flex row justify-content-center",children:[j("Nombre","nameAal","text","",!0,"",!1),j("Firma","signAal","text","",!0,"",!1),j("Fecha","dateAal","date","",!0,"",!1),e.jsx($,{className:"buton-card-singing",type:"primary",htmlType:"submit",children:"Firmar"})]})]}),e.jsxs("div",{className:"col box-shadow p-3 col-md-4 card-container-singing ",children:[e.jsx("h6",{className:"title-card-singing",children:"Autoridad Ejecutante"}),e.jsx("div",{className:"bar-card-singing"}),e.jsxs(b,{form:x,name:"section83",layout:"vertical",initialValues:i,onFinish:u,className:"w-100 h-100 d-flex row justify-content-center",children:[j("Nombre","nameAe","text","",!0,"",!1),j("Firma","signAe","text","",!0,"",!1),j("Fecha","dateAe","date","",!0,"",!1),e.jsx($,{className:"buton-card-singing",type:"primary",htmlType:"submit",children:"Firmar"})]})]}),e.jsxs("div",{className:"col box-shadow p-3 col-md-4 card-container-singing ",children:[e.jsx("h6",{className:"title-card-singing",children:"Otra Autoridad"}),e.jsx("div",{className:"bar-card-singing"}),e.jsxs(b,{form:c,name:"section84",layout:"vertical",initialValues:i,onFinish:g,className:"w-100 h-100 d-flex row justify-content-center",children:[j("Nombre","nameOa","text","",!0,"",!1),j("Firma","signOa","text","",!0,"",!1),j("Fecha","dateOa","date","",!0,"",!1),e.jsx($,{className:"buton-card-singing",type:"primary",htmlType:"submit",children:"Firmar"})]})]})]})})]})},Pl=()=>{const{id:s}=wt();D(I=>I.users.user);const[t,l]=r.useState("1"),[x,c]=r.useState(1),a=JSON.parse(s),[n,i]=r.useState(!0),[o,d]=r.useState(!1),[h,v]=r.useState(!1),[f,p]=r.useState(!1),[j,w]=r.useState(!1),[k,u]=r.useState(!1),[g,m]=r.useState(!1),[S,N]=r.useState(!1),A=I=>{switch(I){case 1:i(!0),d(!1),v(!1),p(!1),w(!1),u(!1),m(!1),N(!1);break;case 2:i(!1),d(!0),v(!1),p(!1),w(!1),u(!1),m(!1),N(!1);break;case 3:i(!1),d(!1),v(!0),p(!1),w(!1),u(!1),m(!1),N(!1);break;case 4:i(!1),d(!1),v(!1),p(!0),w(!1),u(!1),m(!1),N(!1);break;case 5:i(!1),d(!1),v(!1),p(!1),w(!0),u(!1),m(!1),N(!1);break;case 6:i(!1),d(!1),v(!1),p(!1),w(!1),u(!0),m(!1),N(!1);break;case 7:i(!1),d(!1),v(!1),p(!1),w(!1),u(!1),m(!0),N(!1);break;case 8:i(!1),d(!1),v(!1),p(!1),w(!1),u(!1),m(!1),N(!0);break;default:i(!0),d(!1);break}};return r.useEffect(()=>{a!=null&&a.value&&(l(a.value),c(parseInt(a.value)))},[a.value]),r.useEffect(()=>{A(x)},[x]),r.useState("small"),e.jsx("div",{className:"w-100 h-100 d-flex justify-content-center align-items-cente",children:e.jsxs("div",{className:"",style:{width:"90%",height:"80%"},children:[e.jsx("div",{className:"tabs",children:e.jsxs("ul",{className:"tab-container ",children:[e.jsx("li",{id:"tab1",className:n?"tab permission activeItem activeList":"tab permission",children:e.jsx("a",{className:"sectionRed",onClick:()=>A(1),children:"Sección 1"})}),e.jsx("li",{id:"tab2",className:o?"tab permission activeItem activeList":"tab permission ",children:e.jsx("a",{className:"sectionRed",onClick:()=>A(2),children:"Sección 2"})}),e.jsx("li",{id:"tab3",className:h?"tab permission  activeItem activeList":"tab permission ",children:e.jsx("a",{className:"sectionRed",onClick:()=>A(3),children:"Sección 3"})}),e.jsx("li",{id:"tab4",className:f?"tab permission  activeItem activeList":"tab permission ",children:e.jsx("a",{className:"sectionRed",onClick:()=>A(4),children:"Sección 4"})}),e.jsx("li",{id:"tab5",className:j?"tab permission  activeItem activeList":"tab permission ",children:e.jsx("a",{className:"sectionGreen",onClick:()=>A(5),children:"Sección 5"})}),e.jsx("li",{id:"tab6",className:k?"tab permission  activeItem activeList":"tab permission ",children:e.jsx("a",{className:"sectionGreen",onClick:()=>A(6),children:"Sección 6"})}),e.jsx("li",{id:"tab7",className:g?"tab permission  activeItem activeList":"tab permission ",children:e.jsx("a",{className:"sectionBlue",onClick:()=>A(7),children:"Sección 7"})}),e.jsx("li",{id:"tab8",className:S?"tab permission  activeItem activeList":"tab permission ",children:e.jsx("a",{className:"sectionBlue",onClick:()=>A(8),children:"Sección 8"})})]})}),e.jsxs("div",{className:"blockBorder",children:[n&&e.jsx(Cl,{value:t,setValue:l,number:a==null?void 0:a.id,show:x,setShow:c}),o&&e.jsx(wl,{value:t,setValue:l,number:a==null?void 0:a.id,show:x,setShow:c}),h&&e.jsx(kl,{value:t,setValue:l,number:a==null?void 0:a.id,show:x,setShow:c}),f&&e.jsx(Al,{value:t,setValue:l,number:a==null?void 0:a.id,show:x,setShow:c}),j&&e.jsx(Il,{value:t,setValue:l,number:a==null?void 0:a.id,show:x,setShow:c}),k&&e.jsx(Fl,{value:t,setValue:l,number:a==null?void 0:a.id,show:x,setShow:c}),g&&e.jsx(Ol,{value:t,setValue:l,number:a==null?void 0:a.id,show:x,setShow:c}),S&&e.jsx(Tl,{value:t,setValue:l,number:a==null?void 0:a.id,show:x,setShow:c})]})]})})},Rl="/assets/LogoHorizontal-5AtYdVo8.svg",Ml=({children:s})=>e.jsx(e.Fragment,{children:e.jsx("div",{className:"container-fluid layoutContainer",children:e.jsx("div",{className:"subContent",children:e.jsx("div",{className:"abs-center",children:e.jsxs(re,{children:[e.jsx(ee,{className:"colStyle",children:e.jsx("div",{className:"",style:{marginBottom:20,marginTop:20},children:e.jsx("img",{src:Rl,alt:"",className:"brandLogo"})})}),e.jsx(ee,{className:"colStyle",children:e.jsxs(Be,{className:"card-login",children:[e.jsx("p",{className:"montserrat-login",children:"¡Bienvenido!"}),e.jsx("p",{className:"text-login",children:"Inicia sesión a continuación con tu usuario y contraseña"}),e.jsx("div",{className:"formContainer login-form ",children:s})]})})]})})})})}),Ll=()=>{const{loading:s}=D(a=>a.auth),{login:t}=oe(),[l]=b.useForm(),x=[{label:"Correo",name:"email",type:"email",placeholder:"Correo"},{label:"Contraseña",name:"password",type:"password",placeholder:"Contraseña"}],c=a=>{const n={email:a.email,password:a.password};t(n)};return e.jsx(e.Fragment,{children:e.jsx(De,{fields:x,onFinish:c,formName:l,buttonTitle:s?"Iniciando...":"INICIAR SESIÓN",name:"login"})})},Dl=()=>e.jsx(e.Fragment,{children:e.jsx(Ml,{children:e.jsx(Ll,{})})}),Ul=["vehicle","property","equipment","machinery","other"],ql=({assetId:s,setAssetId:t})=>{const[l]=b.useForm();oe();const x=D(y=>y.locations.locations),[c,a]=r.useState(!1),[n,i]=r.useState(!0),[o,d]=r.useState(!1),[h,v]=r.useState(null),[f,p]=r.useState(!1),[j,w]=r.useState(null);r.useState(null);const[k,u]=r.useState(!1),{data:g,isSuccess:m,isError:S}=ya(s,{skip:n}),[N,{isSuccess:A,error:I,reset:T}]=Ls();x==null||x.map(y=>({label:y.locationName,value:y._id})),r.useEffect(()=>{s&&i(!1)},[s]);const P=[{label:"Nombre",name:"assetName",type:"text",placeholder:"Nombre"},{label:"Serial Equipo",name:"internalId",type:"text",placeholder:"Serial del equipo"},{label:"Tipo",name:"assetType",type:"select",placeholder:"Tipo",options:Ul.map(y=>({label:y,value:y}))},{label:"Ubicacion",name:"location",type:"select",placeholder:"Ubicacion",options:x.map(y=>({label:y.locationName,value:y._id}))}],G=()=>{d(!1),u(!1),a(!0)},_=()=>{d(!1),u(!1),l.resetFields(),t(null),a(!1)},M=()=>{d(!1),u(!1),l.resetFields(),a(!1),t(null)},E=()=>{l.validateFields().then(y=>{p(!0),T(),N({...y,id:s}).unwrap()}).catch(y=>{te({title:"Error",content:"Error updating asset"})})};return r.useEffect(()=>{var y;if(m){const U={...g[0],location:(y=g[0])==null?void 0:y.location._id};v({...U}),console.log("assetsss::::",g),G()}S&&w("Error getting asset"),A&&(w("Asset updated successfully"),u(!0),t(null),a(!1),J({title:"Success",content:"User updated successfully"})),I&&(w("Error updating asset"),d(!0),t(null),a(!1),te({title:"Error",content:"Error updating asset"}))},[m,S,A,I]),e.jsx(e.Fragment,{children:e.jsx(ae,{open:c,forceRender:!0,title:"Updat assets",onOk:_,onCancel:M,cancelButtonProps:{form:l,key:"cancel",htmlType:"reset"},footer:[e.jsx($,{type:"default",onClick:M,children:"Exit"},"exit")],children:e.jsx(_e,{form:l,formName:"assetForm",fields:P,initialValues:h,buttonTitle:"Update",onFinish:E,disabled:f})})})},Ks=()=>{var z;r.useState([]);const s=D(F=>F.tenants.tenants),[t,l]=r.useState(null),[x,c]=r.useState(""),[a,n]=r.useState(""),[i,o]=r.useState(!1),[d,h]=r.useState(null),v=D(F=>F.users.user),[f,p]=r.useState(!1);r.useState(!0),Re();const{data:j,isSuccess:w,error:k,isFetching:u,refetch:g}=Ms({}),[m,S]=r.useState({}),[N,A]=r.useState({}),[I,{isSuccess:T,error:P,reset:G}]=Ls(),_=(F,C,R)=>{console.log("Various parameters",F,C,R),S(C),A(R)};s==null||s.map(F=>({text:F.name,value:F.name}));const M=(z=j==null?void 0:j.data)==null?void 0:z.map(F=>{var C,R;return{key:F._id,name:F.assetName,internalId:F.internalId,location:(C=F.location)==null?void 0:C.locationName,city:(R=F.location)==null?void 0:R.city,enabled:F.isActive}}),E=[{title:"Name",dataIndex:"name",key:"name",render:F=>e.jsx("a",{children:F}),sorter:(F,C)=>{var R,O;return((R=F.name)==null?void 0:R.length)-((O=C.name)==null?void 0:O.length)}},{title:"Serial Equipo",dataIndex:"internalId",key:"internalId"},{title:"Ubicación",dataIndex:"location",key:"location"},{title:"Ciudad",dataIndex:"city",key:"city"},(v==null?void 0:v.role)==="root"&&{title:"Action",key:"action",render:(F,C)=>C.email!=="root@mail.com"?e.jsxs(Me,{size:"middle",children:[C.enabled===!1?e.jsx(Z,{title:"Activar equipo",children:e.jsx(be,{style:{fontSize:20,color:"#FF0000",marginRight:10},onClick:()=>H("Activar equipo","activar",!0,C)})}):e.jsx(Z,{title:"Desactivar equipo",children:e.jsx(be,{style:{fontSize:20,color:"#00CC99",marginRight:10},onClick:()=>H("Desactivar equipo","desactivar",!1,C)})}),e.jsx(Z,{title:"Editar equipo",children:e.jsx(Le,{style:{fontSize:20,color:"#333F50",marginRight:10},onClick:()=>y(C)})})]}):null}].filter(Boolean),y=F=>{l(F.key)},U=F=>{p(!1),I({id:F.key,isActive:!1}).unwrap(),J({title:"Success",content:"User deactivated successfully"})},B=F=>{p(!1),I({id:F.key,isActive:!0}).unwrap(),J({title:"Success",content:"User activated successfully"})},q=F=>F.enabled?"":"inactive-row",H=(F,C,R,O)=>{p(!0),c(F),n(C),o(R),h(O)};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"container",children:e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-12",children:e.jsx(pe,{dataSource:M,columns:E,onChange:_,rowClassName:q})})})}),t&&e.jsx(ql,{assetId:t,setAssetId:()=>l()}),e.jsx(Ge,{title:x,content:`¿Está seguro que desea ${a} al equipo ${d==null?void 0:d.name}?`,isModalOpen:f,onCancel:()=>p(!1),onOk:i?()=>B(d):()=>U(d),buttonTitle:a.charAt(0).toUpperCase()+a.slice(1)}),";"]})},$l=["vehicle","property","equipment","machinery","other"],zl=()=>{const[s]=b.useForm(),{credentials:t}=oe(),l=D(N=>N.locations.locations),[x,c]=r.useState(!1);r.useState(null);const[a,n]=r.useState(!1),[i,o]=r.useState(!1),[d,h]=r.useState(null),[v,{isSuccess:f,error:p,reset:j}]=ba();console.log("Credentials",t);const w=l==null?void 0:l.map(N=>({label:N.locationName,value:N._id}));console.log("locations",w);const k=[{label:"Nombre",name:"assetName",type:"text",placeholder:"Nombre"},{label:"Serial Equipo",name:"internalId",type:"text",placeholder:"Serial del equipo"},{label:"Tipo",name:"assetType",type:"select",placeholder:"Tipo",options:$l.map(N=>({label:N,value:N}))},{label:"Ubicacion",name:"location",type:"select",placeholder:"Ubicacion",options:l.map(N=>({label:N.locationName,value:N._id}))}],u=()=>{o(!1),n(!1),c(!0)},g=()=>{o(!1),n(!1),s.resetFields(),c(!1)},m=()=>{o(!1),n(!1),s.resetFields(),c(!1)},S=N=>{const A={...N,isActive:!0,tenant:t==null?void 0:t.tenantId};v(A).unwrap(),j()};return r.useEffect(()=>{f&&(n(!0),h("Asset created successfully"),c(!1),J({title:"Success",content:"Asset created successfully"})),p&&(o(!0),h("Error creating asset"),c(!1),te({title:"Error",content:"Error creating user"}))},[f,p]),e.jsxs(e.Fragment,{children:[e.jsx($,{type:"primary",onClick:u,className:"button-add",children:"Add Asset"}),e.jsx(ae,{open:x,forceRender:!0,title:"Add assets",onOk:g,onCancel:m,cancelButtonProps:{form:s,key:"cancel",htmlType:"reset"},footer:[e.jsx($,{type:"default",onClick:m,children:"Exit"},"exit")],children:e.jsx(De,{fields:k,onFinish:S,name:"assetForm",buttonTitle:"Submit",formName:s})})]})},Bl=()=>e.jsxs(e.Fragment,{children:[e.jsxs(re,{children:[e.jsx(ee,{span:12,className:"text-center",children:e.jsx("h4",{children:"Assets administration"})}),e.jsx(ee,{span:12,className:"text-center",children:e.jsx(zl,{})})]}),e.jsx(re,{className:"pt-3",children:e.jsx(ee,{span:24,children:e.jsx(Ks,{})})})]}),Hl=()=>e.jsx("div",{children:"Maintenance"}),Vl=()=>e.jsxs(e.Fragment,{children:[e.jsxs(re,{children:[e.jsx(ee,{span:12,className:"text-center",children:e.jsx("h4",{children:"Assets maintenance"})}),e.jsx(ee,{span:12,className:"text-center",children:e.jsx(Hl,{})})]}),e.jsx(re,{className:"pt-3",children:e.jsx(ee,{span:24,children:e.jsx(Ks,{})})})]}),Yl=()=>{const[s,t]=r.useState(!0),[l,x]=r.useState(!1),c=a=>{switch(a){case 1:t(!0),x(!1);break;case 2:t(!1),x(!0);break;default:t(!0),x(!1);break}};return e.jsx("div",{className:"w-100 h-100 d-flex justify-content-center align-items-cente",children:e.jsxs("div",{className:"",style:{width:"90%",height:"80%"},children:[e.jsx("div",{className:"tabs",children:e.jsxs("ul",{className:"tab-container",children:[e.jsx("li",{id:"tab1",className:s?"tab activeItem activeList":"tab",children:e.jsx("a",{onClick:()=>c(1),children:"Administración"})}),e.jsx("li",{id:"tab2",className:l?"tab activeItem activeList":"tab",children:e.jsx("a",{onClick:()=>c(2),children:"Mantenimiento"})})]})}),e.jsxs("div",{className:"blockBorder",children:[s&&e.jsx(Bl,{}),l&&e.jsx(Vl,{})]})]})})},Ve=kt({reducer:{auth:Gt,users:la,tenants:va,assets:ka,locations:ua,permits:Sl,[xe.reducerPath]:xe.reducer},middleware:s=>s().concat(xe.middleware),devTools:!0});Et(Ve.dispatch);const _l=()=>(r.useEffect(()=>{console.log("subscribing");const s=Ve.dispatch(me.endpoints.getLocations.initiate()),t=Ve.dispatch(ie.endpoints.getPermits.initiate());return()=>{console.log("unsubscribing"),s.unsubscribe(),t.unsubscribe()}},[]),e.jsx(ps,{})),Gl=()=>e.jsx("div",{className:"pageContainer",children:e.jsx("div",{className:"tabs",children:e.jsxs("div",{className:"tab-container",children:[e.jsxs("div",{id:"tab1",className:"tab",children:[e.jsx("a",{href:"#tab1",children:"Seccion 1"}),e.jsx("div",{className:"tab-content",children:e.jsx("p",{className:"textSubtitle",children:"INFORMACION GENERAL"})})]}),e.jsxs("div",{id:"tab2",className:"tab",children:[e.jsx("a",{href:"#tab2",children:"Seccion 2"}),e.jsx("div",{className:"tab-content",children:e.jsx("p",{className:"textSubtitle",children:"ANALISIS DE RIESGO, CERTIFICADOS DE APOYO Y DOCUMENTOS SOPORTE REQUERIDOS"})})]}),e.jsxs("div",{id:"tab3",className:"tab",children:[e.jsx("a",{href:"#tab3",children:"Seccion 3"}),e.jsx("div",{className:"tab-content",children:e.jsx("p",{className:"textSubtitle",children:"MONITOREO DE GASES"})})]})]})})}),Ql=()=>{b.useForm();const s=Re(),t=D(g=>g.permits.permits),l=je();r.useState(!0);const[x,c]=r.useState(!1),[a,n]=r.useState(!1);r.useState(null);const[i,o]=r.useState(0),[d,h]=r.useState({status:"pending",section1:{completed:!1},section2:{completed:!1},section3:{completed:!1},section4:{completed:!1},section5:{completed:!1},section6:{completed:!1},more:{}}),[v,{isSuccess:f,error:p,reset:j}]=vl(),w=()=>{const g=(t==null?void 0:t.length)>0?t[t.length-1].formNumber:0,m=t.find(S=>S.formNumber===g);(m==null?void 0:m.formNumber)>0&&(m==null?void 0:m.status)!=="pending"?(v(d).then(S=>{s(Qe.setPermit(S.data.data))}),o(g+1),u(g+1)):g===0?(v(d).then(S=>{s(Qe.setPermit(S.data.data))}),o(g),u(g+1)):(console.log("Permiso creado completado",m),s(Qe.setPermit(m)),o(m==null?void 0:m.formNumber),u(m==null?void 0:m.formNumber))},k=()=>{w(),n(!1),c(!1)},u=g=>{const m=JSON.stringify({id:g,value:null});l(`/form/${m}`)};return e.jsx(e.Fragment,{children:e.jsx("div",{className:"",children:e.jsx("div",{className:"col-md",children:e.jsx($,{type:"primary",className:"",onClick:k,children:"Nuevo permiso"})})})})},Wl=()=>{const s=je(),t=D(E=>E.users.user),[l,x]=r.useState([]),[c,a]=r.useState([]),[n,i]=r.useState(!0),[o,d]=r.useState(null),{data:h,isLoading:v,error:f}=gl(),[p,j]=r.useState(!1),[w,k]=r.useState(!1),[u,g]=r.useState(!1),{data:m,isSuccess:S,error:N}=fl(o,{skip:n});r.useEffect(()=>{const E=JSON.parse(localStorage.getItem("tempForm"));(E==null?void 0:E.length)>0&&x(E)},[]),r.useEffect(()=>{if(h&&h.data&&t){const E=h.data.map(U=>({key:U._id,formNumber:U.formNumber,status:U.status,date:W(U.createdAt).format("DD/MM/YYYY HH:MM"),company:U.company||"N/A",location:U.location}));let y=[];t.email!=="root@mail.com"?y=E.filter(U=>U.location===t.location._id):y=E,console.log(y),a(y)}},[h,t]),console.log(c);const A=e.jsxs("div",{className:"",children:[e.jsx("p",{className:"",children:"Completar formulario"}),e.jsx("p",{className:"",children:"ó Editar antes de su aprobación"})]}),I=[{title:"Número",dataIndex:"formNumber",key:"formNumber",render:E=>e.jsx("a",{children:E})},{title:"Fecha",dataIndex:"date",key:"date"},{title:"Estado",dataIndex:"status",key:"status"},{title:"Compañía",dataIndex:"company",key:"company"},{title:"Acciones",key:"action",render:(E,y)=>e.jsxs(Me,{size:"middle",children:[ye.includes(t==null?void 0:t.role)&&y.status==="pending"&&e.jsx(Z,{title:"Editar / Completar",content:A,children:e.jsx(Le,{style:{fontSize:20,color:"#008000",marginRight:10},onClick:()=>T(y)})}),e.jsx(Z,{title:"Eliminar",children:e.jsx(At,{style:{fontSize:20,color:"#FF0000",marginRight:10},onClick:()=>M(y)})}),ye.includes(t==null?void 0:t.role)&&y.status==="waiting"&&e.jsx(Z,{title:"Aprobar",children:e.jsx(Ke,{style:{fontSize:20,color:"#0000FF"},onClick:()=>P(y)})}),ye.includes(t==null?void 0:t.role)&&y.status==="approved"&&e.jsx(Z,{title:"Completar",children:e.jsx(It,{style:{fontSize:20,color:"#008000"},onClick:()=>G(y)})}),ye.includes(t==null?void 0:t.role)&&y.status==="completed"&&e.jsx(Z,{title:"Vista Previa",children:e.jsx(Ft,{style:{fontSize:20,color:"#FA9C0C"},onClick:()=>_(y)})})]})}],T=E=>{d(E.key),i(!1)},P=E=>{d(E.key),i(!1),j(!0)},G=E=>{d(E.key),i(!1),k(!0)},_=E=>{d(E.key),i(!1),g(!0)};r.useEffect(()=>{if(m){let E={};p?(E=JSON.stringify({id:m==null?void 0:m.formNumber,value:"5"}),s(`/form/${E}`)):w?(E=JSON.stringify({id:m==null?void 0:m.formNumber,value:"8"}),s(`/form/${E}`)):u?(E=JSON.stringify({id:m==null?void 0:m.formNumber,value:""}),s(`/preview/${E}`)):(E=JSON.stringify({id:m==null?void 0:m.formNumber,value:null}),s(`/form/${E}`))}},[S]);const M=E=>{console.log(E)};return e.jsx(e.Fragment,{children:e.jsx("div",{className:"container",children:e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-12",children:e.jsx(pe,{dataSource:c,columns:I,scroll:{y:400}})})})})})},Jl=()=>{const[s,t]=r.useState(!0);r.useState(!1);const l=x=>{switch(x){case 1:t(!0);break;default:t(!0);break}};return e.jsx("div",{className:"w-100 h-100 d-flex justify-content-center align-items-cente",children:e.jsxs("div",{className:"",style:{width:"90%",height:"80%"},children:[e.jsx("div",{className:"tabs",children:e.jsx("ul",{className:"tab-container",children:e.jsx("li",{id:"tab1",className:s?"tab activeItem activeList":"tab",children:e.jsx("a",{onClick:()=>l(1),children:"Administración de permisos"})})})}),e.jsx("div",{className:"blockBorder",children:s&&e.jsx(e.Fragment,{children:e.jsxs("div",{children:[e.jsx(re,{className:"",children:e.jsx("div",{className:"text-center pt-2 w-100",children:e.jsx(Ql,{})})}),e.jsx(re,{className:"pt-3",children:e.jsx(ee,{span:24,children:e.jsx(Wl,{})})})]})})})]})})},Kl={width:"100%",height:"100%",padding:"0px 10px 0px 10px",marginTop:"20px"},Xl={display:"flex",justifyContent:"space-between",padding:"0px 10px 0px 10px",marginTop:"20px",marginBottom:"10px"},Zl={fontSize:"20px",fontWeight:500,color:"blue"},en={fontSize:"20px",fontWeight:100,color:"black"},sn={marginLeft:"10px",fontSize:"20px",fontWeight:400,color:"red",border:"1px solid lightgrey",padding:"0px 20px 0px 20px",borderRadius:"5px"},tn={display:"flex",justifyContent:"space-between"},us={marginBottom:"10px"},an=()=>{const s="https://hocolapi.joselimardo.com/",t=D(u=>u.permits.permit),{token:l}=oe(),x=r.useRef(null),[c,a]=r.useState(!1),[n,i]=r.useState(!1),[o,{isSuccess:d,error:h,reset:v}]=ce(),f=async(u,g)=>{const m=await bs("upload",l,u);if(m.status===200){const S=`${s}/${m.data.url}`;p(S)}else console.log("ERROR PDF >>>",m)},p=async u=>{if(console.log("CREATE EVIDENCE:",u),!(t!=null&&t.more.file)){const g=await Ht("create-evidence",l,{file:u});if(console.log(g),g.status===201){console.log("RESPONSE:",g);const m={...t,more:{...t.more,evidence:g.data.file,pdf:u}};o({id:t._id,data:m}),v()}else if(u){const m={...t,more:{...t.more,pdf:u}};o({id:t._id,data:m}),v()}else te({title:"Error al crear la evidencia",content:"Ha ocurrido un error al crear la evidencia"})}},j=()=>{var g;const u=(g=t==null?void 0:t.more)==null?void 0:g.evidence;u&&window.open(u,"_blank")},w=()=>{var g;const u=(g=t==null?void 0:t.more)==null?void 0:g.pdf;console.log("URL:",u),u&&window.open(u,"_blank")};r.useEffect(()=>{var u;(u=t==null?void 0:t.more)!=null&&u.evidence||k()},[]),r.useEffect(()=>{d&&(a(!0),J({title:"Permiso creado correctamente",content:"El permiso ha sido creado y se ha generado la evidencia"}))},[d]),r.useEffect(()=>{h&&(i(!0),te({title:"Error al crear el permiso",content:"Ha ocurrido un error al crear el permiso"}))},[h]);const k=()=>{Ot(x.current).then(u=>{const g=`permiso${t.formNumber}.pdf`,m=u.toDataURL("image/png",.8),S=new Tt,N=210,A=u.height*N/u.width;S.addImage(m,"PNG",0,5,N,A);const I=S.output("blob"),T=new FormData;T.append("file",I,g),S.save(g),f(T)})};return e.jsxs("div",{children:[e.jsxs("div",{ref:x,style:Kl,children:[e.jsxs("div",{style:Xl,children:[e.jsx("div",{style:Zl,children:"NORMA CONTROL DE TRABAJO"}),e.jsxs("div",{style:tn,children:[e.jsx("div",{style:en,children:"PERMISO DE TRABAJO GENERAL"}),e.jsx("div",{style:sn,children:t==null?void 0:t.formNumber})]})]}),e.jsx("div",{style:us,children:e.jsx(Gs,{section1:t==null?void 0:t.section1})}),e.jsx("div",{style:us,children:e.jsx(Qs,{section2:t==null?void 0:t.section2})}),e.jsx("div",{children:e.jsx(Ws,{section3:t==null?void 0:t.section3})}),e.jsx("div",{children:e.jsx(Js,{section4:t==null?void 0:t.section4})})]}),e.jsx("div",{className:"",children:e.jsx(Z,{title:"Ver PDF",children:e.jsx(as,{onClick:w,icon:e.jsx(Pt,{style:{color:"red"}}),style:{right:94},children:"Descargar PDF"})})}),e.jsx("div",{className:"",children:e.jsx(Z,{title:"Ver Evidencia",children:e.jsx(as,{onClick:j,icon:e.jsx(Rt,{style:{color:"green"}}),style:{right:24},children:"Ver Evidencia"})})})]})};function ln(){const{isLoggedIn:s,logout:t}=oe(),[l,x]=r.useState(!1);r.useEffect(()=>{localStorage.setItem("lastActivity",Date.now().toString());const i=2*60*60*1e3,o=setTimeout(()=>{x(!0),t()},i),d=()=>{localStorage.setItem("lastActivity",Date.now().toString()),clearTimeout(o),setTimeout(()=>{x(!0),t()},i)};return document.addEventListener("mousemove",d),document.addEventListener("keydown",d),()=>{document.removeEventListener("mousemove",d),document.removeEventListener("keydown",d),clearTimeout(o)}},[]),r.useEffect(()=>{l===!0&&tl({title:"Sesión expirada",content:"Su sesión ha expirado. Por favor, vuelva a iniciar sesión."})},[l]);const c=ls(ns(e.jsx(se,{element:e.jsx(_l,{}),children:e.jsxs(se,{element:e.jsx(sl,{}),errorElement:e.jsx(Ra,{}),children:[e.jsx(se,{path:"/",element:e.jsx(Pa,{})}),e.jsx(se,{path:"/settings",element:e.jsx(xl,{})}),e.jsx(se,{path:"/assets-settings",element:e.jsx(Yl,{})}),e.jsx(se,{path:"/reports",element:e.jsx(pl,{})}),e.jsx(se,{path:"/form/:id",element:e.jsx(Pl,{})}),e.jsx(se,{path:"/hot-work",element:e.jsx(Gl,{})}),e.jsx(se,{path:"/add-user",element:e.jsx(Bs,{})}),e.jsx(se,{path:"/permissions",element:e.jsx(Jl,{})}),e.jsx(se,{path:"/preview/:id",element:e.jsx(an,{})}),e.jsx(se,{path:"*",element:e.jsx(rs,{})})]})}))),a=ls(ns(e.jsxs(se,{children:[e.jsx(se,{path:"/",element:e.jsx(Dl,{})}),e.jsx(se,{path:"*",element:e.jsx(rs,{})})]}))),n=s?c:a;return e.jsx(e.Fragment,{children:e.jsx(Mt,{router:n})})}Oe.defaults.baseURL="https://hocolapi.joselimardo.com/api";console.log("API SERVER: ",Oe.defaults.baseURL);Lt.createRoot(document.getElementById("root")).render(e.jsx(Dt.StrictMode,{children:e.jsx(Ut,{store:Ve,children:e.jsx(Ea,{children:e.jsx(ln,{})})})}));
