import{j as e,L as xs,c as it,r as ot,f as ct,a as Pe,b as ps,d as js,e as ke,g as Te,h as Re,i as r,u as Me,k as D,M as ne,B as dt,C as ut,X as mt,Y as ht,T as xt,l as pt,m as jt,n as Ve,S as Ke,o as Ze,E as Xe,p as Ne,P as ft,q as gt,s as vt,F as Nt,t as yt,v as bt,H as St,w as wt,x as he,y as $,z as Ct,A as Et,D as kt,G as Oe,I as At,J as ls,U as It,K as Ft,O as fs,N as w,Q as G,R as gs,V as ye,W as He,Z as ge,_ as ee,$ as vs,a0 as Ns,a1 as ys,a2 as es,a3 as bs,a4 as Ss,a5 as De,a6 as X,a7 as Ee,a8 as Le,a9 as ie,aa as se,ab as J,ac as Ot,ad as Pt,ae as ns,af as Tt,ag as ws,ah as Cs,ai as Rt,aj as Mt,ak as Dt,al as Lt,am as Es,an as ks,ao as Be,ap as As,aq as Is,ar as rs,as as is,at as Ut,au as le,av as qt,aw as $t,ax as _t}from"./vendor-e1N5FcBm.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))h(c);new MutationObserver(c=>{for(const l of c)if(l.type==="childList")for(const n of l.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&h(n)}).observe(document,{childList:!0,subtree:!0});function a(c){const l={};return c.integrity&&(l.integrity=c.integrity),c.referrerPolicy&&(l.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?l.credentials="include":c.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function h(c){if(c.ep)return;c.ep=!0;const l=a(c);fetch(c.href,l)}})();const os=()=>e.jsx(e.Fragment,{children:e.jsxs("div",{className:"d-flex flex-column justify-content-center align-items-center",children:[e.jsx("h1",{children:"404"}),e.jsx("p",{children:"Page not found"}),e.jsx("br",{className:""}),e.jsx("p",{children:"Something is wrong, the page you trying to acces do not exist"}),e.jsx("p",{children:"Or you have not enought rights"}),e.jsx("br",{className:""}),e.jsx(xs,{to:"/",children:"Go to Home"})]})}),zt="https://hocolapi.joselimardo.com/api",ve=it({baseQuery:ot(ct({baseUrl:zt,prepareHeaders:(t,{getState:s})=>{const a=s().auth.token;if(a)return t.set("Authorization",`Bearer ${a}`),t.set("Content-Type","application/json"),t}})),keepUnusedDataFor:60,refetchOnMountOrArgChange:!0,refetchOnFocus:!0,refetchOnReconnect:!0,tagTypes:["Users","Tenants","Assets","Locations"],endpoints:t=>({})}),Vt=t=>Pe.create({baseURL:"https://hocolapi.joselimardo.com/api",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`}}),Ht=Pe.create({baseURL:"https://hocolapi.joselimardo.com/api",headers:{"Content-Type":"application/json"}}),Bt=t=>Pe.create({baseURL:"https://hocolapi.joselimardo.com/api",headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${t}`}}),Fs=async(t,s,a)=>{try{return await Vt(s).post(`/${t}`,a)}catch(h){return h}},Yt=async t=>{try{const s=await Ht.post("/auth/login",t);if(s.data.token){const a=ps(s.data.token),h={loading:!1,isLoggedIn:!0,token:s.data.token,active:a.user_active,deleted:a.user_is_deleted,error:null};sessionStorage.setItem("session",JSON.stringify(h,null,2))}return s.data}catch(s){throw s}},ss=async(t,s,a)=>{console.log("DATOS RECIBIDOS",t,s,a);try{const h=await Bt(s).post(`/${t}`,a);return console.log("RESPUESTA",h),h}catch(h){throw h}};let Se=JSON.parse(sessionStorage.getItem("session"));const ze=js("auth/loginUser",async(t,s)=>{try{return await Yt(t)}catch(a){return s.rejectWithValue(a.response.data)}}),Os=js("auth/logoutUser",async(t,s)=>{try{sessionStorage.removeItem("session")}catch(a){return s.rejectWithValue(a.response)}}),Gt={loading:Se?Se.loading:!1,isLoggedIn:Se?Se.isLoggedIn:!1,token:Se?Se.token:null,error:Se?Se.error:null},Qt=ke({name:"auth",initialState:Gt,extraReducers:t=>{t.addCase(ze.pending,s=>{s.loading=!0,s.isLoggedIn=!1,s.token=null,s.error=null}).addCase(ze.fulfilled,(s,a)=>{s.loading=!1,s.isLoggedIn=!0,s.token=a.payload.token,s.error=null}).addCase(ze.rejected,(s,a)=>{s.loading=!1,s.isLoggedIn=!1,s.token=null,s.error=a.payload}).addCase(Os.fulfilled,s=>{s.loading=!1,s.isLoggedIn=!1,s.token=null,s.error=null})}}),Wt=Qt.reducer,Jt=t=>t.auth.token,Kt=t=>t.auth.isLoggedIn,Ps=Te({}),Xt=Ps.getInitialState(),re=ve.injectEndpoints({endpoints:t=>({getUsers:t.query({query:()=>"/users",providesTags:["Users"]}),getUser:t.query({query:s=>`/users/${s}`}),getUserId:t.query({query:s=>`/users/${s}`}),getMe:t.query({query:()=>"/users/me",extraOptions:{maxRetries:0}}),addNewUser:t.mutation({query:s=>({url:"/users",method:"POST",body:s}),invalidatesTags:["Users"],extraOptions:{maxRetries:0}}),updateUser:t.mutation({query:s=>({url:`/users/${s.id}`,method:"PUT",body:{...s}}),invalidatesTags:["Users"]}),deleteUser:t.mutation({query:({id:s})=>({url:`/users/${s}`,method:"DELETE"}),invalidatesTags:["Users"]}),softDeleteUser:t.mutation({query:s=>({url:"/users/soft_delete/",method:"PUT",body:{...s}}),invalidatesTags:["Users"]}),changePassword:t.mutation({query:s=>({url:"/users/change_password/",method:"POST",body:{...s}}),invalidatesTags:["Users"]}),resetPassword:t.mutation({query:s=>({url:`/users/reset_password/${s}`,method:"POST"}),invalidatesTags:["Users"]})})}),{useGetUsersQuery:Zt,useGetUserQuery:ea,useGetUserIdQuery:sa,useGetMeQuery:rn,useAddNewUserMutation:ta,useUpdateUserMutation:Ts,useDeleteUserMutation:on,useSoftDeleteUserMutation:cn,useChangePasswordMutation:dn,useResetPasswordMutation:un}=re,aa=re.endpoints.getUsers.select(),la=Re(aa,t=>t.data);Ps.getSelectors(t=>la(t)??Xt);const na={users:[],user:null,userId:null,loadingId:!1,errorId:null,loading:!1,error:null},Rs=ke({name:"users",initialState:na,reducers:{setUser(t,s){t.user=s.payload},setUsers(t,s){t.users=s.payload}},extraReducers:t=>{t.addMatcher(re.endpoints.getUsers.matchFulfilled,(s,{payload:a})=>{s.users=a.users,s.loading=!1,s.error=null}),t.addMatcher(re.endpoints.getUsers.matchPending,s=>{s.loading=!0,s.error=null}),t.addMatcher(re.endpoints.getUsers.matchRejected,(s,{payload:a})=>{s.loading=!1,s.error=a}),t.addMatcher(re.endpoints.getUser.matchFulfilled,(s,{payload:a})=>{s.user=a[0],s.loading=!1,s.error=null}),t.addMatcher(re.endpoints.getUserId.matchFulfilled,(s,{payload:a})=>{s.userId=a[0],s.loading=!1,s.error=null}),t.addMatcher(re.endpoints.getMe.matchPending,s=>{s.loading=!0,s.error=null}),t.addMatcher(re.endpoints.getMe.matchRejected,(s,{payload:a})=>{s.loading=!1,s.error=a}),t.addMatcher(re.endpoints.getMe.matchFulfilled,(s,{payload:a})=>{s.user=a.user,s.loading=!1,s.error=null}),t.addMatcher(re.endpoints.getUser.matchPending,s=>{s.loading=!0,s.error=null}),t.addMatcher(re.endpoints.getUser.matchRejected,(s,{payload:a})=>{s.loading=!1,s.error=a}),t.addMatcher(re.endpoints.getUserId.matchPending,s=>{s.loadingId=!0,s.errorId=null}),t.addMatcher(re.endpoints.getUserId.matchRejected,(s,{payload:a})=>{s.loadingId=!1,s.errorId=a})}}),cs=Rs.actions,ra=Rs.reducer,Ms=Te({}),ia=Ms.getInitialState(),je=ve.injectEndpoints({endpoints:t=>({getLocations:t.query({query:()=>"/locations",providesTags:["Locations"]}),getLocation:t.query({query:s=>`/locations/${s}`,providesTags:["Locations"]}),addLocation:t.mutation({query:s=>({url:"/locations",method:"POST",body:s}),invalidatesTags:["Locations"],extraOptions:{maxRetries:0}}),updateLocation:t.mutation({query:s=>({url:`/locations/${s.id}`,method:"PUT",body:{...s}}),invalidatesTags:["Locations"]})})}),{useGetLocationQuery:oa,useGetLocationsQuery:Ge,useAddLocationMutation:ca,useUpdateLocationMutation:Ds}=je,da=je.endpoints.getLocations.select(),ua=Re(da,t=>t.data);Ms.getSelectors(t=>ua(t)??ia);const ma={locations:[],location:null,loading:!1,error:null},Ls=ke({name:"locations",initialState:ma,reducers:{setLocation(t,s){t.location=s.payload},setLocations(t,s){t.locations=s.payload.data}},extraReducers:t=>{t.addMatcher(je.endpoints.getLocations.matchFulfilled,(s,{payload:a})=>{s.locations=a.data,s.loading=!1,s.error=null}),t.addMatcher(je.endpoints.getLocations.matchPending,s=>{s.loading=!0,s.error=null}),t.addMatcher(je.endpoints.getLocations.matchRejected,(s,{payload:a})=>{s.loading=!1,s.error=a}),t.addMatcher(je.endpoints.getLocation.matchFulfilled,(s,{payload:a})=>{s.location=a.data,s.loading=!1,s.error=null}),t.addMatcher(je.endpoints.getLocation.matchPending,s=>{s.loading=!0,s.error=null}),t.addMatcher(je.endpoints.getLocation.matchRejected,(s,{payload:a})=>{s.loading=!1,s.error=a})}}),ds=Ls.actions,ha=Ls.reducer,Us=Te({}),xa=Us.getInitialState(),we=ve.injectEndpoints({endpoints:t=>({getTenants:t.query({query:()=>"/tenants",providesTags:["Tenants"]}),getTenant:t.query({query:s=>`/tenants/${s}`}),addTenant:t.mutation({query:s=>({url:"/tenants",method:"POST",body:s}),invalidatesTags:["Tenants"],extraOptions:{maxRetries:0}}),deleteTenant:t.mutation({query:s=>({url:`/tenants/${s}`,method:"DELETE"}),invalidatesTags:["Tenants"],extraOptions:{maxRetries:0}}),updateTenant:t.mutation({query:s=>({url:`/tenants/${s.id}`,method:"PUT",body:s}),invalidatesTags:["Tenants"],extraOptions:{maxRetries:0}})})}),{useGetTenantQuery:pa,useGetTenantsQuery:qs,useAddTenantMutation:ja,useDeleteTenantMutation:fa,useUpdateTenantMutation:$s}=we,ga=we.endpoints.getTenants.select(),va=Re(ga,t=>t.data);Us.getSelectors(t=>va(t)??xa);const Na={tenants:[],tenant:null,loading:!1,error:null},_s=ke({name:"tenants",initialState:Na,reducers:{setTenant(t,s){t.tenant=s.payload},setTenants(t,s){t.tenants=s.payload.data}},extraReducers:t=>{t.addMatcher(we.endpoints.getTenants.matchFulfilled,(s,{payload:a})=>{s.tenants=a.data,s.loading=!1,s.error=null}),t.addMatcher(we.endpoints.getTenants.matchPending,s=>{s.loading=!0,s.error=null}),t.addMatcher(we.endpoints.getTenants.matchRejected,(s,{payload:a})=>{s.loading=!1,s.error=a}),t.addMatcher(we.endpoints.getTenant.matchFulfilled,(s,{payload:a})=>{s.tenant=a.data,s.loading=!1,s.error=null}),t.addMatcher(we.endpoints.getTenant.matchPending,s=>{s.loading=!0,s.error=null}),t.addMatcher(we.endpoints.getTenant.matchRejected,(s,{payload:a})=>{s.loading=!1,s.error=a})}}),us=_s.actions,ya=_s.reducer,zs=Te({}),ba=zs.getInitialState(),fe=ve.injectEndpoints({endpoints:t=>({getAssets:t.query({query:()=>"/assets",providesTags:["Assets"]}),getAsset:t.query({query:s=>`/assets/${s}`,providesTags:["Assets"]}),addAsset:t.mutation({query:s=>({url:"/assets",method:"POST",body:s}),invalidatesTags:["Assets"],extraOptions:{maxRetries:0}}),updateAsset:t.mutation({query:({id:s,data:a})=>({url:`/assets/${s}`,method:"PUT",body:a}),invalidatesTags:["Assets"],providesTags:["Assets"]})})}),{useGetAssetQuery:Vs,useGetAssetsQuery:Hs,useAddAssetMutation:Sa,useUpdateAssetMutation:ts}=fe,wa=fe.endpoints.getAssets.select();fe.endpoints.getAsset.select();const Ca=Re(wa,t=>t.data);zs.getSelectors(t=>Ca(t)??ba);const Ea={assets:[],asset:null,loading:!1,error:null},Bs=ke({name:"assets",initialState:Ea,reducers:{setAsset(t,s){t.asset=s.payload},setAssets(t,s){t.assets=s.payload.data}},extraReducers:t=>{t.addMatcher(fe.endpoints.getAssets.matchFulfilled,(s,{payload:a})=>{s.assets=a.data,s.loading=!1,s.error=null}),t.addMatcher(fe.endpoints.getAssets.matchPending,s=>{s.loading=!0,s.error=null}),t.addMatcher(fe.endpoints.getAssets.matchRejected,(s,{payload:a})=>{s.loading=!1,s.error=a}),t.addMatcher(fe.endpoints.getAsset.matchFulfilled,(s,{payload:a})=>{s.asset=a,s.loading=!1,s.error=null}),t.addMatcher(fe.endpoints.getAsset.matchPending,s=>{s.loading=!0,s.error=null}),t.addMatcher(fe.endpoints.getAsset.matchRejected,(s,{payload:a})=>{s.loading=!1,s.error=a})}}),ms=Bs.actions,ka=Bs.reducer,Ys=r.createContext(),Gs=r.createContext(),Aa=({children:t})=>{const s=Me(),[a,h]=r.useState(!1),c=D(Kt),l=D(Jt),[n,o]=r.useState(null),[p,d]=r.useState(!0),[i,N]=r.useState(null),[f,x]=r.useState(null),{data:j,error:E,isLoading:A,isSuccess:u}=ea(f,{skip:p});r.useEffect(()=>{const v=()=>{const C=window.matchMedia("(max-width: 768px)");h(C.matches)};return v(),window.addEventListener("resize",v),()=>window.removeEventListener("resize",v)},[]),r.useEffect(()=>{if(l){const v=ps(l);N({role:v.role,email:v.email,tenantId:v.tenantId}),x(v.id),d(!1)}},[l]),r.useEffect(()=>{u&&(o(j),j&&j[0].name?N({...i,name:j[0].name,lastName:j[0].lastname||"n/a"}):console.error("User object or user.name or user.lastName is undefined."))},[u,j]);const g=async v=>{await s(ze(v)).then(C=>{var O;console.log("login",C),((O=C.error)==null?void 0:O.message)==="Rejected"&&ne.error({title:"Invalid login attempt",content:`${C.payload.message}`})})},m=()=>{d(!0),s(ms.setAssets([])),s(ms.setAsset(null)),s(ds.setLocations([])),s(ds.setLocation(null)),s(us.setTenants([])),s(us.setTenant(null)),s(cs.setUsers([])),s(cs.setUser(null)),s(ve.util.resetApiState())},S=async()=>{await s(Os()).then(()=>{d(!0),m()})};if(A)return e.jsx("div",{children:"We are loading data, please wait..."});const k={isLoggedIn:c,token:l,login:g,logout:S,credentials:i},F={isMobile:a};return e.jsx(Ys.Provider,{value:k,children:e.jsx(Gs.Provider,{value:F,children:t})})},de=()=>r.useContext(Ys),Ia=[{name:"Enero",permisos:4e3,pv:2400,amt:2400},{name:"Febrero",permisos:3e3,pv:1398,amt:2210},{name:"Marzo",permisos:2e3,pv:9800,amt:2290},{name:"Abril",permisos:2780,pv:3908,amt:2e3},{name:"Mayo",permisos:1890,pv:4800,amt:2181},{name:"Junio",permisos:2390,pv:3800,amt:2500}];function Qs(){return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"h-100 w-100 p-3",children:[" ",e.jsx("h6",{className:"text-start ",children:"Cantidad de permisos por mes"}),e.jsxs(dt,{width:400,height:200,data:Ia,margin:{top:5,right:30,left:20,bottom:5},children:[e.jsx(ut,{strokeDasharray:"3 3"}),e.jsx(mt,{dataKey:"name"}),e.jsx(ht,{}),e.jsx(xt,{}),e.jsx(pt,{}),e.jsx(jt,{dataKey:"permisos",fill:"#82ca9d"})]})]})})}const Fa=()=>e.jsxs("div",{className:"row",children:[e.jsx("h6",{className:"mb-3",children:"Estadísticas en tiempo real"}),e.jsx("div",{className:"col",children:e.jsx("div",{className:"d-flex justify-content-center",children:e.jsx(Ve,{bordered:!0,style:{width:300},children:e.jsx(Ke,{title:"Completados",value:2e4,precision:0,valueStyle:{color:"#3f8600"},prefix:e.jsx(Ze,{}),suffix:""})})})}),e.jsx("div",{className:"col",children:e.jsx("div",{className:"d-flex justify-content-center",children:e.jsx(Ve,{bordered:!0,style:{width:300},children:e.jsx(Ke,{title:"En proceso",value:560,precision:0,valueStyle:{color:"#cf1322"},prefix:e.jsx(Xe,{}),suffix:""})})})})]}),Oa=()=>{const c=[{impreso:{permisos:2e4,hojas:1e5,impresas:1e5}},{digital:{permisos:2e4,hojas:1e5,impresas:2e4}}].map((n,o)=>({key:o,modo:Object.keys(n)[0],permisos:n[Object.keys(n)[0]].permisos,hojas:n[Object.keys(n)[0]].hojas,impresas:n[Object.keys(n)[0]].impresas})).map(n=>({...n,resmas:(n.impresas/500).toFixed(2),peso:(n.impresas/500*2.3).toFixed(2),co2:(n.impresas/500*2.3*1.84/1e3).toFixed(2)})),l=[{title:"Modo",dataIndex:"modo",key:"modo",render:n=>e.jsx("a",{style:{color:"blue",fontWeight:600},children:n+" -->"})},{title:"Permisos",dataIndex:"permisos",key:"permisos",render:n=>e.jsx("a",{children:n})},{title:"Hojas",dataIndex:"hojas",key:"hojas",render:n=>e.jsx("a",{children:n})},{title:"Impresas",dataIndex:"impresas",key:"impresas",render:n=>e.jsx("a",{children:n})},{title:"Resmas",dataIndex:"resmas",key:"resmas",render:n=>e.jsx("a",{children:n})},{title:"Peso (kg)",dataIndex:"peso",key:"peso",render:n=>e.jsx("a",{children:n})},{title:"CO2 (kg)",dataIndex:"co2",key:"co2",render:n=>e.jsx("a",{style:{color:"green",fontWeight:600},children:n})}];return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"p-3",children:[e.jsx("h6",{className:"mb-3",children:"Reduccion en huella de carbono"}),e.jsx("div",{className:"row justify-content-center",children:e.jsx("div",{className:"col-10",children:e.jsx(Ne,{columns:l,dataSource:c,pagination:!1})})})]})})};function $e(t){const{title:s,value:a,color:h,prefix:c,sufix:l}=t;return e.jsx("div",{className:"col-md-6 p-3 h-50",children:e.jsx("div",{className:"box-shadow w-100 h-100",children:e.jsx(Ke,{className:"statistic",title:s,value:a,precision:0,valueStyle:{color:h},prefix:c,suffix:l})})})}const Pa=()=>{const c=[{impreso:{permisos:2e4,hojas:1e5,impresas:1e5}},{digital:{permisos:2e4,hojas:1e5,impresas:2e4}}].map((l,n)=>({key:n,modo:Object.keys(l)[0],permisos:l[Object.keys(l)[0]].permisos,hojas:l[Object.keys(l)[0]].hojas,impresas:l[Object.keys(l)[0]].impresas})).map(l=>({...l,resmas:(l.impresas/500).toFixed(2),peso:(l.impresas/500*2.3).toFixed(2),co2:(l.impresas/500*2.3*1.84/1e3).toFixed(2)}));return e.jsx(e.Fragment,{children:e.jsx("div",{className:"container h-100 p-3",children:e.jsxs("div",{className:"h-100 d-flex flex-wrap",children:[e.jsxs("div",{className:"w-100  d-flex flex-wrap h-50",children:[e.jsxs("div",{className:"d-flex col-md-7 flex-wrap",children:[e.jsx($e,{title:"Completados",value:2e4,color:"#3f8600",prefix:e.jsx(Ze,{})}),e.jsx($e,{title:"En proceso",value:560,color:"#cf1322",prefix:e.jsx(Xe,{})}),e.jsx($e,{title:"En proceso",value:560,color:"#cf1322",prefix:e.jsx(Xe,{})}),e.jsx($e,{title:"Porcentaje de reducción de huella de carbono:",value:((c[0].co2-c[1].co2)/c[0].co2*100).toFixed(2),color:"#cf1322",prefix:"",sufix:e.jsx(ft,{})})]}),e.jsx("div",{className:"col-md-5 p-3",children:e.jsx("div",{className:"box-shadow w-100 h-100",children:e.jsx(Qs,{})})})]}),e.jsx("div",{className:"w-100 d-flex flex-wrap h-50",children:e.jsx("div",{className:"col-md-12 p-3",children:e.jsx("div",{className:"box-shadow w-100 h-100",children:e.jsx(Oa,{})})})})]})})})},Ta=()=>e.jsx(e.Fragment,{children:e.jsx("div",{className:"container",children:e.jsxs("div",{className:"",style:{marginTop:"20px"},children:[e.jsx("h3",{style:{color:"blue"},children:"Estadísticas"}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col box1 me-1",children:e.jsx("div",{className:"d-flex justify-content-center mt-5",children:e.jsx(Qs,{})})}),e.jsx("div",{className:"col box1 ms-1",children:e.jsx("div",{className:"mt-5",children:e.jsx(Fa,{})})})]})]})})}),Ra=()=>{const{credentials:t}=de(),s=t==null?void 0:t.role;return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"h-100 ",children:[s==="root"&&e.jsx(Pa,{}),s==="autoridadArea"&&e.jsx(Ta,{})]})})};function Ma(){const t=gt();return console.error(t),e.jsxs("div",{id:"error-page",children:[e.jsx("h1",{children:"Oops!"}),e.jsx("p",{children:"Sorry, an unexpected error has occurred."}),e.jsx("p",{children:e.jsx("i",{children:t.statusText||t.message})})]})}const Da=()=>r.useContext(Gs),La=[{label:"Settings",key:"settings",icon:e.jsx(vt,{style:{fontSize:20}}),children:[]}],Ua=[{label:"Permisos",key:"permissions",icon:e.jsx(Nt,{style:{fontSize:20}}),children:[]}],qa=[{label:"Reports",key:"reports",icon:e.jsx(yt,{style:{fontSize:20}}),children:[]}],$a=[{label:"Logout",key:"logout",icon:e.jsx(bt,{style:{fontSize:20,color:"#faad14"}}),children:[]}],_a=[{label:"Home",key:"/",icon:e.jsx(St,{style:{fontSize:20}}),children:[]}],za=[{label:"Assets",key:"assets-settings",icon:e.jsx(wt,{style:{fontSize:20}}),children:[]}],Ae=(t,s,a,h,c,l)=>({key:s,icon:a,children:h,label:t,type:c,disabled:l}),Va=Ua.map(t=>Ae(t.label,t.key,t.icon)),Ha=qa.map(t=>Ae(t.label,t.key,t.icon)),Ba=La.map(t=>Ae(t.label,t.key,t.icon)),Ya=$a.map(t=>Ae(t.label,t.key,t.icon)),Ga=_a.map(t=>Ae(t.label,t.key,t.icon)),Qa=za.map(t=>Ae(t.label,t.key,t.icon)),{Sider:Wa}=Oe,Ja=[Ga[0],Ba[0],Qa[0],Va[0],Ha[0],Ya[0]],Ka=()=>{const t=he(),{logout:s}=de(),[a,h]=r.useState(!0);let c={};a?c={backgroundColor:"#2E202F",textAlign:"center",paddingTop:20,paddingBottom:10}:c={backgroundColor:"#2E202F",textAlign:"right",paddingTop:20,paddingBottom:10};const l={backgroundColor:"#fff",height:"100vh",zIndex:1},n={backgroundColor:"#2E202F",color:"#fff",borderRadius:"0px 0px 20px 0px",maxWidth:200,minHeight:"95%"},o=d=>{h(d)},p=()=>{t("/"),s()};return e.jsxs(Wa,{breackpoint:"md",trigger:null,collapsible:!0,collapsed:a,onCollapse:o,style:l,children:[e.jsx("div",{style:c,className:"itemButton",children:e.jsx($,{type:"text",icon:a?e.jsx(Ct,{style:{fontSize:20,color:"#fff "}}):e.jsx(Et,{style:{fontSize:20,color:"#fff"}}),onClick:()=>h(!a)})}),e.jsx(kt,{theme:"dark",style:n,mode:"inline",items:Ja,onClick:({key:d})=>{d==="logout"?p():d==="openClose"?h(!a):t(d)},selectable:!0})]})},Ws="/assets/LogoHorizontal-5AtYdVo8.svg",Xa=()=>{const t=he(),s=D(l=>l.permits.permits),a=s.some(l=>l.status==="waiting"),h=s.some(l=>l.status==="approved"),c=()=>{t("/permissions")};return e.jsxs("div",{className:"d-flex gap-3",children:[a&&e.jsx($,{className:"notification",onClick:c,children:"¡Hay permisos pendientes de autorización!"}),h&&e.jsx($,{className:"notification",onClick:c,children:"¡Hay permisos para Completar!"})]})},{Header:Za}=Oe,_e=["#f56a00","#7265e6","#ffbf00","#00a2ae"],el=()=>{const[t,s]=r.useState("U"),[a,h]=r.useState(_e[1]);he();const{isLoggedIn:c,credentials:l}=de(),n=()=>{const p=Math.floor(Math.random()*4);h(p<_e.length-1?_e[p+1]:_e[0])},o=p=>p.split(" ").map(N=>N[0].toUpperCase()).join("");return r.useEffect(()=>{l!=null&&l.name&&(l!=null&&l.lastName)?s(o(`${l==null?void 0:l.name} ${l==null?void 0:l.lastName}`)):s("U")},[c,l]),e.jsxs(Za,{className:"header",children:[e.jsx(xs,{to:"/",children:e.jsx(At,{preview:!1,width:150,src:Ws})}),e.jsx(Xa,{}),e.jsx("div",{className:"",style:{paddingRight:20,paddingLeft:20},children:c?e.jsx(ls,{style:{backgroundColor:a,cursor:"pointer"},size:35,onClick:n,children:t}):e.jsx(ls,{style:{backgroundColor:a,cursor:"pointer"},size:35,icon:e.jsx(It,{style:{fontSize:35}}),onClick:n})})]})},sl=()=>{const{isMobile:t}=Da();console.log("isMobile::: ",t);const{Header:s,Content:a,Footer:h}=Oe,{token:{colorBgContainer:c}}=Ft.useToken(),l={margin:"0px",textAlign:"center",height:"100vh",width:"100%"},n={background:c,width:"100%"},o={background:c,textAlign:"center",display:"flex",justifyContent:"center",alignItems:"center"},p={display:"flex",alignContent:"center",alignItems:"center",background:"#fff"};return e.jsxs(Oe,{className:"conatiner-fluid layout",children:[e.jsx(el,{}),e.jsxs(Oe,{style:p,children:[e.jsx(Ka,{}),e.jsx("div",{style:n,children:e.jsx(a,{style:l,children:e.jsx(fs,{})})})]}),e.jsx(h,{style:o,children:"MyPropChain © 2024 all rights reserved"})]})},{RangePicker:Js}=ye,Ue=({fields:t,onFinish:s,formName:a,name:h,buttonTitle:c,layout:l,twoColumns:n})=>{l||(l="vertical");const o="DD/MM/YYYY HH:mm",p={borderRadius:"5px",height:"35px",border:"none"};return e.jsxs(w,{form:a,name:h,onFinish:s,layout:l,labelCol:{span:10},wrapperCol:{span:24},style:{maxWidth:600},className:n?"two-column-form":"one-column-form",children:[t.map((d,i)=>e.jsxs(w.Item,{label:h==="login"?e.jsx("label",{className:"font-label",children:d.label}):d.label,name:d.name,rules:d.type==="confirmPassword"?[{required:!0,message:`Please input a ${d.label}`},{min:8,message:"Password must be at least 8 characters"},({getFieldValue:N})=>({validator(f,x){return!x||N("password")===x?Promise.resolve():Promise.reject(new Error("The two passwords that you entered do not match!"))}})]:h==="userForm"&&d.name==="location"?[{required:!1},{type:`${d.type}`}]:[{required:!0,message:`Please input ${d.label}`},{type:`${d.type}`},d.type==="password"&&{min:8,message:"Password must be at least 8 characters"}],children:[d.type==="text"&&e.jsx(G,{id:d.name,placeholder:d.placeholder,style:{...p}}),d.type==="inputnumber"&&e.jsx(gs,{min:"0",max:"1",step:"0.01",stringMode:!0,style:{...p,width:"100%"},id:d.name,placeholder:d.placeholder}),d.type==="number"&&e.jsx(G,{type:"number",id:d.name,placeholder:d.placeholder,style:{...p}}),d.type==="email"&&e.jsx(G,{type:"email",id:d.name,placeholder:d.placeholder,style:{...p}}),d.type==="date"&&e.jsx(ye,{id:d.name,format:o,style:{...p}}),d.type==="datetime"&&e.jsx(Js,{id:d.name,placeholder:d.placeholder,style:{...p}}),d.type==="password"&&e.jsx(G.Password,{id:d.name,placeholder:d.placeholder,style:{...p}}),d.type==="confirmPassword"&&e.jsx(G.Password,{id:d.name,placeholder:d.placeholder,style:{...p}}),d.type==="textarea"&&e.jsx(G.TextArea,{id:d.name,style:{...p}}),d.type==="select"&&e.jsx(He,{id:d.name,options:d.options,placeholder:d.placeholder,style:{...p}}),d.type==="radio"&&e.jsx(ge,{id:d.name,style:{...p}}),d.type==="checkbox"&&e.jsx(ee,{id:d.name,style:{...p}}),d.type==="switch"&&e.jsx(vs,{id:d.name,style:{...p}}),d.type==="slider"&&e.jsx(Ns,{id:d.name,style:{...p}}),d.type==="rate"&&e.jsx(ys,{id:d.name,style:{...p}}),d.type==="upload"&&e.jsx(es,{id:d.name,style:{...p}}),d.type==="button"&&e.jsx($,{id:d.name,style:{...p}}),d.type==="treeselect"&&e.jsx(bs,{id:d.name,style:{...p}}),d.type==="timepicker"&&e.jsx(Ss,{id:d.name,style:{...p}})]},i)),e.jsx(w.Item,{children:h==="login"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mt-4 d-flex justify-content-center",style:{display:"flex",flexDirection:"row"},children:e.jsx($,{htmlType:"submit",className:"button-login",children:c})}),e.jsx("div",{className:"d-flex justify-content-center",children:e.jsxs("p",{className:"forget-password",children:["¿Olvisate tu contraseña?"," ",e.jsx("span",{className:"get-password",children:"¡Recupérala!"})]})})]}):e.jsxs("div",{className:"",style:{display:"flex",flexDirection:"row"},children:[e.jsx($,{type:"primary",htmlType:"submit",children:c}),e.jsx($,{type:"",htmlType:"reset",style:{marginLeft:"20px"},children:"Reset"})]})})]})},Qe=({fields:t,onFinish:s,formName:a,initialValues:h,buttonTitle:c,form:l,layout:n,disabled:o,twoColumns:p})=>{n||(n="vertical");const d=async()=>{await l.setFieldsValue(h)};return r.useEffect(()=>{h?d():l.resetFields()},[h,l]),e.jsxs(w,{form:l,name:a,onFinish:s,initialValues:h,layout:n,labelCol:{span:8},wrapperCol:{span:24},style:{maxWidth:600},className:p?"two-column-form":"one-column-form",children:[t.map((i,N)=>e.jsxs(w.Item,{label:i.label,name:i.name,rules:[{required:!0,message:`Please input ${i.label}`},{type:`${i.type}`}],children:[i.type==="text"&&e.jsx(G,{disabled:o||!1}),i.type==="inputnumber"&&e.jsx(gs,{min:"0",max:"1",step:"0.01",stringMode:!0,style:{width:"100%"},id:i.name}),i.type==="number"&&e.jsx(G,{type:"number",id:i.name,value:i.value}),i.type==="email"&&e.jsx(G,{type:"email",id:i.name,value:i.value,disabled:o||!1}),i.type==="date"&&e.jsx(ye,{id:i.name,value:i.value}),i.type==="datetime"&&e.jsx(Js,{id:i.name,value:i.value}),i.type==="password"&&e.jsx(G.Password,{id:i.name,value:i.value}),i.type==="textarea"&&e.jsx(G.TextArea,{id:i.name}),i.type==="select"&&e.jsx(He,{id:i.name,value:i.value,options:i.options,disabled:o||!1}),i.type==="radio"&&e.jsx(ge,{id:i.name,value:i.value}),i.type==="checkbox"&&e.jsx(ee,{id:i.name,value:i.value}),i.type==="switch"&&e.jsx(vs,{id:i.name,value:i.value}),i.type==="slider"&&e.jsx(Ns,{id:i.name,value:i.value}),i.type==="rate"&&e.jsx(ys,{id:i.name,value:i.value}),i.type==="upload"&&e.jsx(es,{id:i.name,value:i.value}),i.type==="button"&&e.jsx($,{id:i.name,value:i.value}),i.type==="treeselect"&&e.jsx(bs,{id:i.name,value:i.value}),i.type==="timepicker"&&e.jsx(Ss,{id:i.name,value:i.value})]},N)),e.jsx(w.Item,{children:e.jsxs("div",{className:"",style:{display:"flex",flexDirection:"row"},children:[e.jsx($,{type:"primary",htmlType:"submit",children:c}),e.jsx($,{type:"",htmlType:"reset",style:{marginLeft:"20px"},children:"Reset"})]})})]})},te=({title:t,content:s})=>{ne.error({title:t,content:s})},K=({title:t,content:s})=>{ne.success({title:t,content:s})},tl=({title:t,content:s})=>{ne.info({title:t,content:s})},We=({title:t,content:s,onCancel:a,onOk:h,isModalOpen:c,buttonTitle:l,cancelTitle:n})=>e.jsx(ne,{title:t,open:c,onCancel:a,footer:[e.jsx($,{onClick:a,children:n||"Cancelar"},"cancel"),e.jsx($,{type:"primary",onClick:h,className:"button-add",children:l||"Ok"},"ok")],children:e.jsx("p",{children:s})}),Ks=()=>{var q;const t=D(M=>M.tenants.tenants),[s]=w.useForm(),[a,h]=r.useState(!1);r.useState(null);const[c,l]=r.useState(!1),[n,o]=r.useState(!1),[p,d]=r.useState(null),[i,{isSuccess:N,error:f,reset:x}]=ta(),{data:j=[],isSuccessLocation:E,errorLocation:A,isFetching:u,refetch:g}=Ge({}),m=(q=j==null?void 0:j.data)==null?void 0:q.map(M=>({value:M._id,label:M.locationName+"-"+M.city})),S=[{value:"admin",label:"Admin"},{value:"user",label:"User"},{value:"root",label:"Root"},{value:"operator",label:"Operator"},{value:"contractor",label:"Contractor"},{value:"autoridadEstatal",label:"Autoridad Estatal"},{value:"autoridadMunicipal",label:"Autoridad Municipal"},{value:"autoridadArea",label:"Autoridad de Area"},{value:"autoridadAreaLocal",label:"Autoridad de Area Local"},{value:"otraAutoridad",label:"Otra Autoridad"}],F=[{label:"Tenant",name:"tenant",type:"select",placeholder:"Tenant",options:t==null?void 0:t.map(M=>({value:M._id,label:M.name}))},{label:"Nombre",name:"name",type:"text",placeholder:"Nombre"},{label:"Apellido",name:"lastname",type:"text",placeholder:"Apellido"},{label:"Role",name:"role",type:"select",placeholder:"Role",options:S},{label:"Location",name:"location",type:"select",placeholder:"Location",options:m},{label:"Email",name:"email",type:"email",placeholder:"Email"},{label:"Password",name:"password",type:"password",placeholder:"Password"},{label:"Confirm password",name:"confirmPassword",type:"confirmPassword",placeholder:"Confirm password"}],v=()=>{o(!1),l(!1),h(!0)},C=()=>{o(!1),l(!1),s.resetFields(),h(!1)},O=()=>{o(!1),l(!1),s.resetFields(),h(!1)},T=M=>{const I={...M,isActive:!0};i(I).unwrap(),x()};return r.useEffect(()=>{N&&(l(!0),d("User added successfully"),h(!1),K({title:"Success",content:"User added successfully"}))},[N]),r.useEffect(()=>{f&&(o(!0),d("Error adding user"),h(!1),te({title:"Error",content:"Error adding user"}))},[f]),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"",children:e.jsx("div",{className:"col-md",children:e.jsx($,{type:"primary",className:"button-add",onClick:v,children:"Add User"})})}),e.jsx(ne,{open:a,forceRender:!0,title:"Add user",onOk:C,onCancel:O,cancelButtonProps:{form:s,key:"cancel",htmlType:"reset"},footer:[e.jsx($,{type:"default",onClick:O,children:"Exit"},"exit")],children:e.jsx(Ue,{fields:F,onFinish:T,name:"userForm",buttonTitle:"Submit",formName:s})})]})},al=({userId:t,setUserId:s})=>{var _;const a=D(R=>R.tenants.tenants),[h]=w.useForm(),[c,l]=r.useState(!1),[n,o]=r.useState(!1),[p,d]=r.useState(!0),[i,N]=r.useState(!1),[f,x]=r.useState(null),[j,E]=r.useState(null),[A,u]=r.useState(!1),{data:g,isSuccess:m,isError:S}=sa(t,{skip:p}),[k,{isSuccess:F,error:v,reset:C}]=Ts(),{data:O=[],isSuccessLocation:T,errorLocation:q,isFetching:M,refetch:I}=Ge({}),y=(_=O==null?void 0:O.data)==null?void 0:_.map(R=>({value:R._id,label:R.locationName+"-"+R.city}));r.useEffect(()=>{t&&d(!1),console.log("record:::::",t)},[t]);const L=[{value:"admin",label:"Admin"},{value:"user",label:"User"},{value:"root",label:"Root"},{value:"operator",label:"Operator"},{value:"contractor",label:"Contractor"},{value:"autoridadEstatal",label:"Autoridad Estatal"},{value:"autoridadMunicipal",label:"Autoridad Municipal"},{value:"autoridadArea",label:"Autoridad de Area"},{value:"autoridadAreaLocal",label:"Autoridad de Area Local"},{value:"otraAutoridad",label:"Otra Autoridad"}],U=[{label:"Tenant",name:"tenant",type:"select",placeholder:"Tenant",options:a==null?void 0:a.map(R=>({value:R._id,label:R.name}))},{label:"Nombre",name:"name",type:"text",placeholder:"Nombre"},{label:"Apellido",name:"lastname",type:"text",placeholder:"Apellido"},{label:"Role",name:"role",type:"select",placeholder:"Role",options:L},{label:"Location",name:"location",type:"select",placeholder:"Location",options:y},{label:"Email",name:"email",type:"email",placeholder:"Email"}],B=()=>{N(!1),o(!1),l(!0)},V=()=>{N(!1),o(!1),h.resetFields(),s(null),l(!1)},W=()=>{N(!1),o(!1),h.resetFields(),l(!1),s(null)},P=()=>{h.validateFields().then(R=>{var ae,pe,ue,me;let Q={};(ae=R.location)!=null&&ae.value&&((pe=R.tenant)!=null&&pe.value)?Q={...R,id:t,tenant:R.tenant.value,location:R.location.value}:(ue=R.location)!=null&&ue.value?Q={...R,id:t,location:R.location.value}:(me=R.tenant)!=null&&me.value?Q={...R,id:t,tenant:R.tenant.value}:Q={...R,id:t},u(!0),C(),k(Q).unwrap()}).catch(R=>{te({title:"Error",content:"Error updating user"})})};return r.useEffect(()=>{var R;if(m){const Q={...g[0],tenant:{label:g[0].tenant.name,value:g[0].tenant._id}};(R=g[0])!=null&&R.location?x({...Q,location:y.find(ae=>ae.value===g[0].location._id)}):x({...Q}),B()}S&&E("Error getting user"),F&&(E("User updated successfully"),o(!0),s(null),l(!1),K({title:"Success",content:"User updated successfully"})),v&&(E("Error updating user"),N(!0),s(null),l(!1),te({title:"Error",content:"Error updating user"}))},[m,S,F,v]),e.jsx(e.Fragment,{children:e.jsx(ne,{open:c,forceRender:!0,title:"Add user",onOk:V,onCancel:W,cancelButtonProps:{form:userForm,key:"cancel",htmlType:"reset"},footer:[e.jsx($,{type:"default",onClick:W,children:"Exit"},"exit")],children:e.jsx(Qe,{form:h,formName:"userUpdateForm",fields:U,initialValues:f,buttonTitle:"Update",onFinish:P,disabled:A})})})},ll=()=>{var W;r.useState([]);const[t,s]=r.useState(null),[a,h]=r.useState(""),[c,l]=r.useState(""),[n,o]=r.useState(!1),[p,d]=r.useState(null),i=D(P=>P.users.user),N=D(P=>P.tenants.tenants);r.useState(!0);const[f,x]=r.useState(!1);Me();const[j,E]=r.useState({}),[A,u]=r.useState({}),g=(P,_,R)=>{console.log("Various parameters",P,_,R),E(_),u(R)},{data:m=[],isSuccess:S,error:k,isFetching:F,refetch:v}=Zt({}),[C,{isSuccess:O,error:T,reset:q}]=Ts(),M=N==null?void 0:N.map(P=>({text:P.name,value:P.name})),I=(W=m==null?void 0:m.users)==null?void 0:W.map(P=>{var _,R;return{key:P._id,name:P.name+" "+P.lastname,email:P.email,role:P.role,tenant:(_=P.tenant)==null?void 0:_.name,location:((R=P.location)==null?void 0:R.locationName)||"No aplica",enabled:P.isActive}}),y=[{title:"Name",dataIndex:"name",key:"name",render:P=>e.jsx("a",{children:P}),sorter:(P,_)=>{var R,Q;return((R=P.name)==null?void 0:R.length)-((Q=_.name)==null?void 0:Q.length)}},{title:"Email",dataIndex:"email",key:"email"},{title:"Role",dataIndex:"role",key:"role"},{title:"Location",dataIndex:"location",key:"location"},{title:"Organizacion",dataIndex:"tenant",key:"tenant",filters:M,filteredValue:j.tenant||null,onFilter:(P,_)=>_.tenant.includes(P),sorter:(P,_)=>{var R,Q;return((R=P.tenant)==null?void 0:R.length)-((Q=_.tenant)==null?void 0:Q.length)},sortOrder:A.columnKey==="tenant"?A.order:null,ellipsis:!0},(i==null?void 0:i.role)==="root"&&{title:"Action",key:"action",render:(P,_)=>_.email!=="root@mail.com"?e.jsxs(De,{size:"middle",children:[_.enabled===!1?e.jsx(X,{title:"Activar usuario",children:e.jsx(Ee,{style:{fontSize:20,color:"#FF0000",marginRight:10},onClick:()=>V("Activar usuario","activar",!0,_)})}):e.jsx(X,{title:"Desactivar usuario",children:e.jsx(Ee,{style:{fontSize:20,color:"#00CC99",marginRight:10},onClick:()=>V("Desactivar usuario","desactivar",!1,_)})}),e.jsx(X,{title:"Editar usuario",children:e.jsx(Le,{style:{fontSize:20,color:"#333F50",marginRight:10},onClick:()=>L(_)})})]}):null}].filter(Boolean),L=P=>{s(P.key)},H=P=>{x(!1),C({id:P.key,isActive:!1}).unwrap(),K({title:"Success",content:"User deactivated successfully"})},U=P=>{x(!1),C({id:P.key,isActive:!0}).unwrap(),K({title:"Success",content:"User activated successfully"})},B=P=>P.enabled?"":"inactive-row",V=(P,_,R,Q)=>{x(!0),h(P),l(_),o(R),d(Q)};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"container",children:e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-12",children:e.jsx(Ne,{dataSource:I,columns:y,onChange:g,handleUpdate:L,rowClassName:B,scroll:{y:300,x:1e3}})})})}),t&&e.jsx(al,{userId:t,setUserId:()=>s()}),e.jsx(We,{title:a,content:`¿Está seguro que desea ${c} al usuario ${p==null?void 0:p.name}?`,isModalOpen:f,onCancel:()=>x(!1),onOk:n?()=>U(p):()=>H(p),buttonTitle:c.charAt(0).toUpperCase()+c.slice(1)}),";"]})},nl=()=>(qs(),e.jsxs(e.Fragment,{children:[e.jsxs(ie,{children:[e.jsx(se,{span:12,className:"text-center",children:e.jsx("h4",{style:{fontFamily:"Montserrat"},children:"Users administration"})}),e.jsx(se,{span:12,className:"text-center",children:e.jsx(Ks,{})})]}),e.jsx(ie,{className:"pt-3",children:e.jsx(se,{span:24,children:e.jsx(ll,{})})})]})),Ce=["autoridadArea","autoridadMunicipal","autoridadEstatal","autoridadAreaLocal","otraAutoridad","contractor","root"],Xs=["owner","contractor","client"],rl=()=>{const[t]=w.useForm(),[s,a]=r.useState(!1),[h,c]=r.useState(!1),[l,n]=r.useState(!1),[o,p]=r.useState(null),[d,{isSuccess:i,error:N,reset:f}]=ja(),j=[{label:"Tipo",name:"tenantType",type:"select",placeholder:"Tipo",options:Xs.map(m=>({label:m,value:m}))},{label:"Nombre",name:"tenantName",type:"text",placeholder:"Nombre"},{label:"Nombre Legal",name:"tenantLegalname",type:"text",placeholder:"Nombre"},{label:"Email",name:"tenantEmail",type:"email",placeholder:"Email"}],E=()=>{n(!1),c(!1),a(!0)},A=()=>{n(!1),c(!1),t.resetFields(),a(!1)},u=()=>{n(!1),c(!1),t.resetFields(),a(!1)},g=m=>{const S={name:m.tenantName,legalName:m.tenantLegalname,email:m.tenantEmail,isActive:!0,type:m.tenantType};d(S).unwrap(),f()};return r.useEffect(()=>{i&&(c(!0),p("Tenant added successfully"),a(!1),K({title:"Success",content:"Tenant added successfully"}))},[i]),r.useEffect(()=>{N&&(n(!0),p("Error adding tenant"),a(!1),te({title:"Error",content:"Error adding tenant"}))},[N]),e.jsxs(e.Fragment,{children:[e.jsx($,{type:"primary",className:"button-add",onClick:E,children:"Add new tenant"}),e.jsx(ne,{open:s,forceRender:!0,title:"Add tenant",onOk:A,onCancel:u,cancelButtonProps:{form:t,key:"cancel",htmlType:"reset"},footer:[e.jsx($,{type:"default",onClick:u,children:"Exit"},"exit")],children:e.jsx(Ue,{fields:j,onFinish:g,name:"tenantForm",buttonTitle:"Submit",formName:t})})]})},il=({tenantId:t,setTenantId:s})=>{const[a]=w.useForm(),[h,c]=r.useState(!1),[l,n]=r.useState(null),[o,p]=r.useState(null),[d,i]=r.useState(!0),[N,f]=r.useState(!1),[x,j]=r.useState(!1),{data:E,isSuccess:A,isError:u}=pa(t,{skip:d}),[g,m]=r.useState(!1),[S,{isSuccess:k,error:F,reset:v}]=$s(),O=[{label:"Tipo",name:"type",type:"select",placeholder:"Tipo",options:Xs.map(I=>({label:I,value:I}))},{label:"Nombre",name:"name",type:"text",placeholder:"Nombre"},{label:"Nombre Legal",name:"legalName",type:"text",placeholder:"Nombre"},{label:"Email",name:"email",type:"email",placeholder:"Email"}];r.useEffect(()=>{t&&(i(!1),T())},[t]);const T=()=>{j(!1),f(!1),c(!0)},q=()=>{a.validateFields().then(I=>{const y={...I,id:t,more:{type:I.type}};m(!0),v(),S(y).unwrap()}).catch(I=>{console.log("Validate Failed:",I)})},M=()=>{j(!1),f(!1),c(!1),s(null),a.resetFields()};return r.useEffect(()=>{A&&n({...E[0],type:E[0].more.type}),u&&p("Error getting tenant"),k&&(p("Tenant updated successfully"),f(!0),c(!1),s(null),K({title:"Success",content:"Tenant updated successfully"})),F&&(p("Error updating tenant"),j(!0),c(!1),s(null),te({title:"Error",content:"Error updating tenant"}))},[A,u,k,F]),e.jsx("div",{children:e.jsx(ne,{title:"Update Tenant",open:h,onOk:q,onCancel:M,cancelButtonProps:{form:a,key:"cancel",htmlType:"reset"},footer:[e.jsx($,{type:"default",onClick:M,children:"Exit"},"exit")],children:e.jsx(Qe,{form:a,formName:"tenantEditForm",fields:O,initialValues:l,buttonTitle:"Update",onFinish:q,disabled:g})})})},ol=()=>{var H;const[t,s]=r.useState(null),[a,h]=r.useState(""),[c,l]=r.useState(""),[n,o]=r.useState(!1),[p,d]=r.useState(!1),[i,N]=r.useState(null),f=D(U=>U.users.user),{data:x=[],isSuccess:j,error:E,isFetching:A,refetch:u}=qs({}),[g,{isSuccess:m,isError:S}]=fa(),[k,{isSuccess:F,error:v,reset:C}]=$s(),O=(H=x==null?void 0:x.data)==null?void 0:H.map(U=>({key:U._id,name:U.name,email:U.email,enabled:U.isActive})),T=[{title:"Name",dataIndex:"name",key:"name",render:U=>e.jsx("a",{children:U})},{title:"Email",dataIndex:"email",key:"email"},(f==null?void 0:f.role)==="root"&&{title:"Action",key:"action",render:(U,B)=>B.email!=="root@mail.com"?e.jsxs(De,{size:"middle",children:[B.enabled===!1?e.jsx(X,{title:"Activar tenant",children:e.jsx(Ee,{style:{fontSize:20,color:"#FF0000",marginRight:10},onClick:()=>y("Activar tenant","activar",!0,B)})}):e.jsx(X,{title:"Desactivar tenant",children:e.jsx(Ee,{style:{fontSize:20,color:"#00CC99",marginRight:10},onClick:()=>y("Desactivar tenant","desactivar",!1,B)})}),e.jsx(X,{title:"Editar usuario",children:e.jsx(Le,{style:{fontSize:20,color:"#333F50",marginRight:10},onClick:()=>q(B)})})]}):null}],q=U=>{s(U.key)},M=U=>{o(!1),k({id:U.key,isActive:!1}).unwrap(),K({title:"Success",content:"Tenant deactivated successfully"})},I=U=>{o(!1),k({id:U.key,isActive:!0}).unwrap(),K({title:"Success",content:"Tenant activated successfully"})},y=(U,B,V,W)=>{o(!0),h(U),l(B),d(V),N(W)},L=U=>U.enabled?"":"inactive-row";return r.useEffect(()=>{m?(K({title:"Success",content:"Tenant deleted successfully"}),u()):S&&te({title:"Error",content:"Error deleting tenant"})},[m,S]),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"container",children:e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-12",children:e.jsx(Ne,{dataSource:O,columns:T,rowClassName:L})})})}),t&&e.jsx(il,{tenantId:t,setTenantId:()=>s()}),e.jsx(We,{title:a,content:`¿Está seguro que desea ${c} al tenant ${i==null?void 0:i.name}?`,isModalOpen:n,onCancel:()=>o(!1),onOk:p?()=>I(i):()=>M(i),buttonTitle:c.charAt(0).toUpperCase()+c.slice(1)}),";"]})},cl=()=>e.jsxs(e.Fragment,{children:[e.jsxs(ie,{children:[e.jsx(se,{span:12,className:"text-center",children:e.jsx("h4",{children:"Tenants administration"})}),e.jsx(se,{span:12,className:"text-center",children:e.jsx(rl,{})})]}),e.jsx(ie,{className:"pt-3",children:e.jsx(se,{span:24,children:e.jsx(ol,{})})})]}),dl=()=>{const t=D(C=>C.tenants.tenants),[s]=w.useForm(),{credentials:a}=de(),[h,c]=r.useState(!1),l=D(C=>C.users.user);r.useState(null);const[n,o]=r.useState(!1),[p,d]=r.useState(!1),[i,N]=r.useState(null),[f,{isSuccess:x,error:j,reset:E}]=ca(),A=a==null?void 0:a.role,g={label:"Tenant",name:"tenant",type:"select",placeholder:"Tenant",options:t==null?void 0:t.map(C=>({value:C._id,label:C.name}))},m=[{label:"Nombre",name:"locationName",type:"text",placeholder:"Nombre"},{label:"Descripción",name:"description",type:"text",placeholder:"Descripcion"},{label:"Ciudad",name:"city",type:"text",placeholder:"Ciudad"},{label:"Departamento",name:"state",type:"text",placeholder:"Departamento"},{label:"Pais",name:"country",type:"text",placeholder:"Pais"}];A==="root"&&m.unshift(g);const S=()=>{d(!1),o(!1),c(!0)},k=()=>{d(!1),o(!1),s.resetFields(),c(!1)},F=()=>{d(!1),o(!1),s.resetFields(),c(!1)},v=C=>{console.log(C);const O={...C,more:{isActive:!0}};l.role!="root"&&(O.tenant=a==null?void 0:a.tenantId),f(O).unwrap(),E()};return r.useEffect(()=>{x&&(o(!0),N("Location added successfully"),c(!1),K({title:"Success",content:"Location added successfully"}))},[x]),r.useEffect(()=>{j&&(d(!0),N("Error adding location"),c(!1),te({title:"Error",content:"Error adding location"}))},[j]),e.jsxs(e.Fragment,{children:[e.jsx($,{type:"primary",className:"button-add",onClick:S,children:"Add location"}),e.jsx(ne,{open:h,forceRender:!0,title:"Add location",onOk:k,onCancel:F,cancelButtonProps:{form:s,key:"cancel",htmlType:"reset"},footer:[e.jsx($,{type:"default",onClick:F,children:"Exit"},"exit")],children:e.jsx(Ue,{fields:m,onFinish:v,name:"locationForm",buttonTitle:"Submit",formName:s})})]})},ul=({locationId:t,setLocationId:s})=>{const a=D(B=>B.tenants.tenants),[h]=w.useForm(),{credentials:c}=de(),[l,n]=r.useState(!1);D(B=>B.users.user),r.useState(null);const[o,p]=r.useState(!0),[d,i]=r.useState(null),[N,f]=r.useState(!1),{data:x,isSuccess:j,isError:E}=oa(t,{skip:o}),[A,u]=r.useState(!1),[g,m]=r.useState(!1),[S,k]=r.useState(null),[F,{isSuccess:v,error:C,reset:O}]=Ds(),T=c==null?void 0:c.role;r.useEffect(()=>{t&&p(!1),console.log("record:::::",t)},[t]);const M={label:"Tenant",name:"tenant",type:"select",placeholder:"Tenant",options:a==null?void 0:a.map(B=>({value:B._id,label:B.name}))},I=[{label:"Nombre",name:"locationName",type:"text",placeholder:"Nombre"},{label:"Descripción",name:"description",type:"text",placeholder:"Descripcion"},{label:"Ciudad",name:"city",type:"text",placeholder:"Ciudad"},{label:"Departamento",name:"state",type:"text",placeholder:"Departamento"},{label:"Pais",name:"country",type:"text",placeholder:"Pais"}];T==="root"&&I.unshift(M);const y=()=>{m(!1),u(!1),n(!0)},L=()=>{m(!1),u(!1),userUpdateForm.resetFields(),s(null),n(!1)},H=()=>{m(!1),u(!1),h.resetFields(),n(!1),s(null)},U=()=>{h.validateFields().then(B=>{let V={};V={...B,id:t},f(!0),O(),F(V).unwrap()}).catch(B=>{te({title:"Error",content:"Error updating user"})})};return r.useEffect(()=>{if(j){console.log("location:::::",x);const B={...x};i({...B}),y()}E&&k("Error getting location"),v&&(k("Location updated successfully"),u(!0),s(null),n(!1),K({title:"Success",content:"Location updated successfully"})),C&&(k("Error updating location"),m(!0),s(null),n(!1),te({title:"Error",content:"Error updating location"}))},[v,C,j,E]),e.jsx(e.Fragment,{children:e.jsx(ne,{open:l,forceRender:!0,title:"Update location",onOk:L,onCancel:H,cancelButtonProps:{form:h,key:"cancel",htmlType:"reset"},footer:[e.jsx($,{type:"default",onClick:H,children:"Exit"},"exit")],children:e.jsx(Qe,{form:h,formName:"loactionForm",fields:I,initialValues:d,buttonTitle:"Update",onFinish:U,disabled:N})})})},ml=()=>{var I;const[t,s]=r.useState(""),[a,h]=r.useState(""),[c,l]=r.useState(!1),[n,o]=r.useState(null),[p,d]=r.useState(!1),i=D(y=>y.users.user),[N,f]=r.useState(null),{data:x=[],isSuccess:j,error:E,isFetching:A,refetch:u}=Ge({}),[g,{isSuccess:m,error:S,reset:k}]=Ds(),F=(I=x==null?void 0:x.data)==null?void 0:I.map(y=>({key:y._id,name:y.locationName,city:y.city,state:y.state,country:y.country,enabled:(y==null?void 0:y.isActive)||!1})),v=[{title:"Name",dataIndex:"name",key:"name",render:y=>e.jsx("a",{children:y})},{title:"Ciudad",dataIndex:"city",key:"city"},{title:"Departamento",dataIndex:"state",key:"state"},(i==null?void 0:i.role)==="root"&&{title:"Action",key:"action",render:(y,L)=>L.email!=="root@mail.com"?e.jsxs(De,{size:"middle",children:[L.enabled===!1?e.jsx(X,{title:"Activar localización",children:e.jsx(Ee,{style:{fontSize:20,color:"#FF0000",marginRight:10},onClick:()=>q("Activar usuario","activar",!0,L)})}):e.jsx(X,{title:"Desactivar localización",children:e.jsx(Ee,{style:{fontSize:20,color:"#00CC99",marginRight:10},onClick:()=>q("Desactivar localización","desactivar",!1,L)})}),e.jsx(X,{title:"Editar localización",children:e.jsx(Le,{style:{fontSize:20,color:"#333F50",marginRight:10},onClick:()=>C(L)})})]}):null}].filter(Boolean),C=y=>{f(y.key)},O=y=>{d(!1),g({id:y.key,isActive:!1}).unwrap(),K({title:"Success",content:"Location deactivated successfully"})},T=y=>{d(!1),g({id:y.key,isActive:!0}).unwrap(),K({title:"Success",content:"Location activated successfully"})},q=(y,L,H,U)=>{d(!0),s(y),h(L),l(H),o(U)},M=y=>y.enabled?"":"inactive-row";return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"container",children:e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-12",children:e.jsx(Ne,{dataSource:F,columns:v,rowClassName:M})})})}),N&&e.jsx(ul,{locationId:N,setLocationId:()=>f()}),e.jsx(We,{title:t,content:`¿Está seguro que desea ${a} la localización ${n==null?void 0:n.name}?`,isModalOpen:p,onCancel:()=>d(!1),onOk:c?()=>T(n):()=>O(n),buttonTitle:a.charAt(0).toUpperCase()+a.slice(1)}),";"]})},hl=()=>e.jsxs(e.Fragment,{children:[e.jsxs(ie,{children:[e.jsx(se,{span:12,className:"text-center",children:e.jsx("h4",{children:"Location administration"})}),e.jsx(se,{span:12,className:"text-center",children:e.jsx(dl,{})})]}),e.jsx(ie,{className:"pt-3",children:e.jsx(se,{span:24,children:e.jsx(ml,{})})})]}),xl=()=>{const t=D(p=>p.users.user),[s,a]=r.useState(!0),[h,c]=r.useState(!1),[l,n]=r.useState(!1);console.log("USER",t);const o=p=>{switch(p){case 1:a(!0),c(!1),n(!1);break;case 2:a(!1),c(!0),n(!1);break;case 3:a(!1),c(!1),n(!0);break;default:a(!0),c(!1),n(!1);break}};return e.jsxs("div",{className:"container-fluid",children:[e.jsx("div",{className:"tabs",children:e.jsxs("ul",{className:"tab-container",children:[e.jsx("li",{id:"tab1",className:s?"tab activeItem activeList":"tab",children:e.jsx("a",{onClick:()=>o(1),children:"Users settings"})}),(t==null?void 0:t.role)==="root"&&e.jsx("li",{id:"tab2",className:h?"tab activeItem activeList":"tab",children:e.jsx("a",{onClick:()=>o(2),children:"Tenants settings"})}),(t==null?void 0:t.role)==="root"&&e.jsx("li",{id:"tab3",className:l?"tab activeItem activeList":"tab",children:e.jsx("a",{onClick:()=>o(3),children:"Location settings"})})]})}),e.jsxs("div",{className:"blockBorder",children:[s&&e.jsx(nl,{}),h&&(t==null?void 0:t.role)==="root"&&e.jsx(cl,{}),l&&(t==null?void 0:t.role)==="root"&&e.jsx(hl,{})]})]})},pl=()=>e.jsx("div",{children:"Reports"}),Zs=Te({}),jl=Zs.getInitialState(),oe=ve.injectEndpoints({endpoints:t=>({getPermits:t.query({query:()=>"/permits",providesTags:["Permits"]}),getPermit:t.query({query:s=>`/permits/${s}`,providesTags:["Permits"]}),addPermit:t.mutation({query:s=>({url:"/permits",method:"POST",body:s}),invalidatesTags:["Permits"],extraOptions:{maxRetries:0}}),updatePermit:t.mutation({query:({id:s,data:a})=>({url:`/permits/${s}`,method:"PUT",body:a}),invalidatesTags:["Permits"],extraOptions:{maxRetries:0}})})}),{useGetPermitQuery:fl,useGetPermitsQuery:gl,useAddPermitMutation:vl,useUpdatePermitMutation:xe}=oe,Nl=oe.endpoints.getPermits.select(),yl=Re(Nl,t=>t.data);Zs.getSelectors(t=>yl(t)??jl);const bl={permits:[],permit:null,loading:!1,error:null},et=ke({name:"permits",initialState:bl,reducers:{setPermit(t,s){t.permit=s.payload},setPermits(t,s){t.permits=s.payload.data}},extraReducers:t=>{t.addMatcher(oe.endpoints.getPermits.matchFulfilled,(s,{payload:a})=>{s.permits=a.data,s.loading=!1,s.error=null}),t.addMatcher(oe.endpoints.getPermits.matchPending,s=>{s.loading=!0,s.error=null}),t.addMatcher(oe.endpoints.getPermits.matchRejected,(s,{payload:a})=>{s.loading=!1,s.error=a}),t.addMatcher(oe.endpoints.getPermit.matchFulfilled,(s,{payload:a})=>{s.permit=a,s.loading=!1,s.error=null}),t.addMatcher(oe.endpoints.getPermit.matchPending,s=>{s.loading=!0,s.error=null}),t.addMatcher(oe.endpoints.getPermit.matchRejected,(s,{payload:a})=>{s.loading=!1,s.error=a}),t.addMatcher(oe.endpoints.updatePermit.matchFulfilled,(s,{payload:a})=>{s.permit=a.data,s.loading=!1,s.error=null}),t.addMatcher(oe.endpoints.updatePermit.matchPending,s=>{s.loading=!0,s.error=null}),t.addMatcher(oe.endpoints.updatePermit.matchRejected,(s,{payload:a})=>{s.loading=!1,s.error=a})}}),Je=et.actions,Sl=et.reducer,wl=({setValue:t,number:s,setShow:a,show:h})=>{var ue,me,z;const[c]=w.useForm();Me();const l=D(b=>b.permits.permit),n=D(b=>b.users.user),[o,p]=r.useState({}),[d,i]=r.useState(s),[N,f]=r.useState(null);r.useState(!0);const[x,j]=r.useState([]),[E,A]=r.useState(null),[u,g]=r.useState(!1),[m,{isSuccess:S,error:k,reset:F}]=xe(),{data:v,isSuccess:C,error:O,isFetching:T,refetch:q}=Hs({}),{data:M=[],isSuccessLocation:I,errorLocation:y,isFetching:L,refetch:H}=Ge({}),U="DD/MM/YYYY HH:mm",B=(ue=v==null?void 0:v.data)==null?void 0:ue.map(b=>{var Y,Z;return{key:b._id,name:b.assetName,internalId:b.internalId,location:(Y=b.location)==null?void 0:Y._id,city:(Z=b.location)==null?void 0:Z.city}});r.useEffect(()=>{var b,Y;if((l==null?void 0:l.formNumber)===parseInt(s)){const Z={...l==null?void 0:l.section1,date:J((b=l==null?void 0:l.section1)==null?void 0:b.date),equipment:(Y=l==null?void 0:l.section1)==null?void 0:Y.equipment};(l==null?void 0:l.status)==="waiting"&&Ce.includes(n==null?void 0:n.role)?g(!0):g(!1),c.setFieldsValue(Z)}},[]);const V=b=>{let Y={},Z={};typeof b.area=="object"?(Y=b.area,Z=b.equipment):(Y=W.find(ce=>ce.value===b.area),Z=x.find(ce=>ce.value===b.equipment));const be={...l,section1:{...b,area:Y,equipment:Z,completed:!0},location:Y.value};m({id:l._id,data:be}).then(ce=>{ce.data.status===200&&(a(2),t("2"))}),u&&(a(2),t("2"))},W=(me=M==null?void 0:M.data)==null?void 0:me.map(b=>({value:b._id,label:b.city})),P=(z=v==null?void 0:v.data)==null?void 0:z.map(b=>({value:b._id,label:b.assetName})),_=[{label:"Alto",value:"alto",style:{color:"red"}},{label:"Medio",value:"medio",style:{color:"orange"}}],R=b=>{f(b.target.value)},Q=b=>{if(!b)A(null),j([]);else if(B.length>0){A(null),j([]);const Z=ae(b).map(be=>({value:be.key,label:be.name,internalId:be.internalId}));j(Z)}},ae=b=>B.filter(Y=>Y.location===b),pe=(b,Y)=>((Y==null?void 0:Y.label)??"").toLowerCase().includes(b.toLowerCase());return e.jsxs("div",{className:"container-fluid pageContainer",children:[e.jsx("hr",{}),e.jsxs("div",{className:"d-flex justify-content-between ps-2 pe-2",children:[e.jsx("div",{className:"textSubtitle",children:"INFORMACION GENERAL"}),e.jsxs("div",{className:"textSubtitle",children:["Permiso Número: ",d]})]}),e.jsx("hr",{}),e.jsx("div",{style:{marginRight:50,marginTop:30},children:e.jsxs(w,{form:c,name:"seccion1",layout:"vertical",onFinish:V,initialValues:o,children:[e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col",children:e.jsx("div",{className:"d-flex flex-row justify-content-start",children:e.jsx(w.Item,{label:"Fecha de Solicitud",name:"date",rules:[{required:!0,message:"Please input!"}],children:e.jsx(ye,{format:U,disabled:u})})})}),e.jsx("div",{className:"col",children:e.jsx(w.Item,{label:"Compañía que requiere el servicio",name:"company",rules:[{required:!0,message:"Please input!"}],children:e.jsx(G,{disabled:u})})})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col",children:e.jsx(w.Item,{label:"Instalación",name:"location",rules:[{required:!0,message:"Please input!"}],children:e.jsx(G,{disabled:u})})}),e.jsx("div",{className:"col",children:e.jsx(w.Item,{label:"Area",name:"area",rules:[{required:!0,message:"Please input!"}],children:e.jsx(He,{showSearch:!0,options:W,placeholder:"Seleccione área",style:{textAlign:"left"},disabled:u,onChange:Q,filterOption:pe})})})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col",children:e.jsx(w.Item,{label:"Equipos a intervenir",name:"equipment",rules:[{required:!0,message:"Please input!"}],children:e.jsx(He,{showSearch:!0,options:P,placeholder:"Seleccion equipo",style:{textAlign:"left"},disabled:u,onChange:Q,filterOption:pe})})}),e.jsx("div",{className:"col",children:e.jsx(w.Item,{label:"Alcance del trabajo",name:"alcance",rules:[{required:!0,message:"Please input!"}],children:e.jsx(G,{disabled:u})})})]}),e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col",children:[e.jsx("div",{className:"d-flex flex-row justify-content-start",children:e.jsx(w.Item,{label:"Nivel Potencial de Peligro Identificado",name:"warning",rules:[{required:!0,message:"Please input!"}],children:e.jsx(ge.Group,{options:_,optionType:"button",onChange:R,disabled:u})})}),e.jsxs(Ot,{children:[N==="alto"&&e.jsxs("p",{className:"textSubtitle",children:["Nivel de Peligro:"," ",e.jsx("span",{style:{color:"red"},children:N.toUpperCase()})]}),N==="medio"&&e.jsxs("p",{className:"textSubtitle",children:["Nivel de Peligro:"," ",e.jsx("span",{style:{color:"orange"},children:N.toUpperCase()})]})]})]}),e.jsx("div",{className:"col",children:e.jsx(w.Item,{label:"Equipos y Herramientas a Usar",name:"tools",rules:[{required:!0,message:"Please input!"}],children:e.jsx(G,{disabled:u})})})]}),e.jsx("div",{className:"d-flex justify-content-end mt-4",children:e.jsx(w.Item,{children:e.jsx($,{type:"primary",htmlType:"submit",className:"float-right",children:"Seguir"})})})]})})]})},Cl=({value:t,setValue:s,number:a,setShow:h,show:c})=>{const[l,n]=w.useForm(),o=D(b=>b.permits.permit),p=D(b=>b.users.user),d=D(b=>b.auth.token),[i,N]=r.useState(a);r.useState(!1);const[f,x]=r.useState(!1),[j,E]=r.useState(!1),[A,u]=r.useState(!1),[g,m]=r.useState(!1),[S,k]=r.useState(!1),[F,v]=r.useState(!1),[C,O]=r.useState(!1),[T,q]=r.useState(!1),[M,I]=r.useState(!1),[y,L]=r.useState(!1),[H,U]=r.useState(!1),[B,V]=r.useState(!1),[W,{isSuccess:P,error:_,reset:R}]=xe();r.useEffect(()=>{if((o==null?void 0:o.formNumber)===parseInt(a)){const b={...o==null?void 0:o.section2};l.setFieldsValue(b),x(b.check1),q(b.check2),E(b.check3),u(b.check4),m(b.check5),k(b.check6),v(b.check7),O(b.check8),I(b.check9),L(b.check10),(o==null?void 0:o.status)==="waiting"&&Ce.includes(p==null?void 0:p.role)?U(!0):U(!1)}},[]);const Q=b=>{const Y={...o,section2:{...b,completed:!0}};W({id:o._id,data:Y}).then(Z=>{Z.data.status===200&&(h(3),s("3"))}),H&&(h(3),s("3"))},ae=()=>{V(!0)},pe=()=>{V(!1)},ue=()=>{V(!1)},me=async b=>{const{onSuccess:Y,onError:Z,file:be}=b;try{const ce=new FormData;ce.append("file",be);for(const[qe,Ie]of ce.entries())Ie instanceof File?(console.log(`${qe}: ${Ie.name}`),console.log(`${qe}: ${Ie.size} bytes`),console.log(`${qe}: ${Ie.type}`)):console.log(`${qe}: ${Ie}`);const as=await ss("upload",d,ce);console.log("file upload: >>> ",as),Y(as.data,be)}catch(ce){Z(ce)}},z=b=>{b.file.status!=="uploading"&&console.log(b.file,b.fileList),b.file.status==="done"?ns.success(`${b.file.name} file uploaded successfully`):b.file.status==="error"&&ns.error(`${b.file.name} file upload failed.`)};return e.jsxs("div",{className:"container-fluid pageContainer",children:[e.jsx("hr",{}),e.jsxs("div",{className:"d-flex justify-content-between ps-2 pe-2",children:[e.jsx("div",{className:"textSubtitle",children:"ANALISIS DE RIESGOS, CERTIFICADOS DE APOYO Y DOCUMENTOS SOPORTE REQUERIDOS"}),e.jsxs("div",{className:"textSubtitle",children:["Permiso Número: ",i]})]}),e.jsx("hr",{}),e.jsx("div",{style:{marginRight:10},children:e.jsxs(w,{form:l,name:"seccion2",layout:"horizontal",onFinish:Q,children:[e.jsxs("div",{children:[e.jsx("p",{className:"textFormItalic w-100",children:"ANALISIS DE RIESGOS REQUERIDOS"}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col",children:e.jsxs("div",{className:"d-flex flex-row",children:[e.jsx(w.Item,{label:"Análisis de Seguridad en el Trabajo - AST",name:"check1",valuePropName:"checked",rules:[{required:!1,message:"Please input!"}],children:e.jsx(ee,{onChange:()=>x(!f),checked:f,disabled:H})}),e.jsx(w.Item,{label:"Nro.",name:"astNumber",style:{paddingLeft:20},rules:[f&&{required:!0,message:"Please input!"}],children:e.jsx(G,{disabled:!f})})]})}),e.jsx("div",{className:"col",children:e.jsx("div",{className:"d-flex flex-row",children:e.jsx(w.Item,{label:"Análisis de Peligro en la Etapa de Planificación - APEP",name:"apep",children:e.jsxs(ge.Group,{disabled:H,children:[e.jsx(ge,{value:"si",children:" Si "}),e.jsx(ge,{value:"no",children:" No "})]})})})})]})]}),e.jsx("div",{className:"row",children:e.jsx("div",{className:"col",children:e.jsxs("div",{className:"d-flex flex-row",children:[e.jsx(w.Item,{label:"Otro",name:"check2",valuePropName:"checked",rules:[{required:!1,message:"Please input!"}],children:e.jsx(ee,{onChange:()=>q(!T),checked:T,disabled:H})}),e.jsx(w.Item,{label:"Cual?",name:"oAnalysisDescription",style:{paddingLeft:20},rules:[T&&{required:!0,message:"Please input!"}],children:e.jsx(G,{disabled:!T})})]})})}),e.jsxs("div",{children:[e.jsx("p",{className:"textFormItalic w-100",children:"CERTIFICADOS DE APOYO REQUERIDOS"}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col",children:e.jsxs("div",{className:"d-flex flex-row",children:[e.jsx(w.Item,{label:"Certificado Apoyo de Trabajo en Caliente",name:"check3",valuePropName:"checked",rules:[{required:!1,message:"Please input!"}],children:e.jsx(ee,{onChange:()=>E(!j),checked:j,disabled:H})}),e.jsx(w.Item,{label:"Nro.",name:"atcNumber",style:{paddingLeft:20},rules:[j&&{required:!0,message:"Please input!"}],children:e.jsx(G,{disabled:!j})})]})}),e.jsx("div",{className:"col",children:e.jsxs("div",{className:"d-flex flex-row",children:[" ",e.jsx(w.Item,{label:"Certificado Apoyo de Radiaciones",name:"check4",valuePropName:"checked",rules:[{required:!1,message:"Please input!"}],children:e.jsx(ee,{onChange:()=>u(!A),checked:A,disabled:H})}),e.jsx(w.Item,{label:"Nro.",name:"certARNumber",style:{paddingLeft:20},rules:[A&&{required:!0,message:"Please input!"}],children:e.jsx(G,{disabled:!A})})]})})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col",children:e.jsxs("div",{className:"d-flex flex-row",children:[e.jsx(w.Item,{label:"Certificado Apoyo de Excavación",name:"check5",valuePropName:"checked",rules:[{required:!1,message:"Please input!"}],children:e.jsx(ee,{onChange:()=>m(!g),checked:g,disabled:H})}),e.jsx(w.Item,{label:"Nro.",name:"certAENumber",style:{paddingLeft:20},rules:[g&&{required:!0,message:"Please input!"}],children:e.jsx(G,{disabled:!g})})]})}),e.jsx("div",{className:"col",children:e.jsxs("div",{className:"d-flex flex-row",children:[" ",e.jsx(w.Item,{label:"Certificado Apoyo Trabajo en Altura",name:"check6",valuePropName:"checked",rules:[{required:!1,message:"Please input!"}],children:e.jsx(ee,{onChange:()=>k(!S),checked:S,disabled:H})}),e.jsx(w.Item,{label:"Nro.",name:"certATANumber",style:{paddingLeft:20},rules:[S&&{required:!0,message:"Please input!"}],children:e.jsx(G,{disabled:!S})})]})})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col",children:e.jsxs("div",{className:"d-flex flex-row",children:[e.jsx(w.Item,{label:"Certificado Apoyo Izaje de Carga",name:"check7",valuePropName:"checked",rules:[{required:!1,message:"Please input!"}],children:e.jsx(ee,{onChange:()=>v(!F),checked:F,disabled:H})}),e.jsx(w.Item,{label:"Nro.",name:"certAICNumber",style:{paddingLeft:20},rules:[F&&{required:!0,message:"Please input!"}],children:e.jsx(G,{disabled:!F})})]})}),e.jsx("div",{className:"col",children:e.jsxs("div",{className:"d-flex flex-row",children:[" ",e.jsx(w.Item,{label:"Certificado Apoyo de Espacios Confinados",name:"check8",valuePropName:"checked",rules:[{required:!1,message:"Please input!"}],children:e.jsx(ee,{onChange:()=>O(!C),checked:C,disabled:H})}),e.jsx(w.Item,{label:"Nro.",name:"certAECNumber",style:{paddingLeft:20},rules:[C&&{required:!0,message:"Please input!"}],children:e.jsx(G,{disabled:!C})})]})})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col",children:e.jsxs("div",{className:"d-flex flex-row",children:[e.jsx(w.Item,{label:"Certificado Apoyo Ahislamiento de Energías",name:"check9",valuePropName:"checked",rules:[{required:!1,message:"Please input!"}],children:e.jsx(ee,{onChange:()=>I(!M),checked:M,disabled:H})}),e.jsx(w.Item,{label:"Nro.",name:"certAAENumber",style:{paddingLeft:20},rules:[M&&{required:!0,message:"Please input!"}],children:e.jsx(G,{disabled:!M})})]})}),e.jsx("div",{className:"col",children:e.jsxs("div",{className:"d-flex flex-row",children:[" ",e.jsx(w.Item,{label:"Otro",name:"check10",valuePropName:"checked",rules:[{required:!1,message:"Please input!"}],children:e.jsx(ee,{onChange:()=>L(!y),checked:y,disabled:H})}),e.jsx(w.Item,{label:"Cual",name:"certOtherDesc",style:{paddingLeft:20},rules:[y&&{required:!0,message:"Please input!"}],children:e.jsx(G,{disabled:!y})})]})})]}),e.jsxs("div",{className:"",children:[e.jsx("p",{className:"textFormItalic w-100",children:"DOCUMENTOS SOPORTE REQUERIDOS"}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col",children:e.jsx("div",{className:"d-flex flex-row",children:e.jsx(w.Item,{label:"Preoperacionales Equipos y Herramientas",name:"reqDocsPEH",valuePropName:"checked",rules:[{required:!1,message:"Please input!"}],children:e.jsx(ee,{disabled:H})})})}),e.jsx("div",{className:"col",children:e.jsxs("div",{className:"d-flex flex-row",children:[" ",e.jsx(w.Item,{label:"Procedimientos/Instructivos",name:"reqDocsPI",valuePropName:"checked",rules:[{required:!1,message:"Please input!"}],children:e.jsx(ee,{disabled:H})})]})}),e.jsx("div",{className:"col",children:e.jsxs("div",{className:"d-flex flex-row",children:[" ",e.jsx(w.Item,{label:"FDS Productos químicos",name:"reqDocsFDS",valuePropName:"checked",rules:[{required:!1,message:"Please input!"}],children:e.jsx(ee,{disabled:H})})]})}),e.jsx("div",{className:"col",children:e.jsx("div",{className:"d-flex flex-row",children:e.jsx(w.Item,{label:"Otro",name:"reqDocsOther",valuePropName:"checked",rules:[{required:!1,message:"Please input!"}],children:e.jsx(ee,{disabled:H})})})})]})]})]}),e.jsxs("div",{className:"d-flex justify-content-between mt-5",children:[e.jsx("div",{className:"",children:e.jsx($,{style:{borderColor:"blue",color:"blue"},onClick:ae,children:"Subir Documentos de Apoyo"})}),e.jsx("div",{className:"",children:e.jsx(w.Item,{children:e.jsx($,{type:"primary",htmlType:"submit",className:"float-right",children:"Seguir"})})})]})]})}),e.jsx(ne,{title:"Seleccionar Documentos de Apoyo",open:B,onOk:pe,onCancel:ue,children:e.jsx(es,{customRequest:me,onChange:z,maxCount:5,children:e.jsx($,{icon:e.jsx(Pt,{}),children:"Clic para seleccionar"})})})]})},El=({value:t,setValue:s,number:a,show:h,setShow:c})=>{const[l]=w.useForm(),n=D(m=>m.permits.permit),o=D(m=>m.users.user),[p,d]=r.useState(a);r.useState(!1),r.useState(!0);const[i,N]=r.useState(!1),f="DD/MM/YYYY HH:mm",[x,{isSuccess:j,error:E,reset:A}]=xe();r.useEffect(()=>{var m,S,k,F,v,C,O,T,q,M,I,y,L,H;if((n==null?void 0:n.formNumber)===parseInt(a)){const U={calibrationDate:(m=n==null?void 0:n.section3)!=null&&m.calibrationDate?J((S=n==null?void 0:n.section3)==null?void 0:S.calibrationDate):null,verificationDate:(k=n==null?void 0:n.section3)!=null&&k.verificationDate?J((F=n==null?void 0:n.section3)==null?void 0:F.verificationDate):null,row1Col1:(v=n==null?void 0:n.section3)!=null&&v.row1Col1?J((C=n==null?void 0:n.section3)==null?void 0:C.row1Col1):null,row1Col2:(O=n==null?void 0:n.section3)!=null&&O.row1Col2?J((T=n==null?void 0:n.section3)==null?void 0:T.row1Col2):null,row1Col3:(q=n==null?void 0:n.section3)!=null&&q.row1Col3?J((M=n==null?void 0:n.section3)==null?void 0:M.row1Col3):null,row1Col4:(I=n==null?void 0:n.section3)!=null&&I.row1Col4?J((y=n==null?void 0:n.section3)==null?void 0:y.row1Col4):null,row1Col5:(L=n==null?void 0:n.section3)!=null&&L.row1Col5?J((H=n==null?void 0:n.section3)==null?void 0:H.row1Col5):null},B={...n==null?void 0:n.section3,...U};l.setFieldsValue(B),(n==null?void 0:n.status)==="waiting"&&Ce.includes(o==null?void 0:o.role)?N(!0):N(!1)}},[]);const u=(m,S,k,F,v,C,O)=>e.jsx(e.Fragment,{children:k==="checkbox"?e.jsx(w.Item,{label:m,name:S,valuePropName:"checked",rules:[{type:k,message:`The input is not valid ${k}`},{required:v,message:`Please input a ${m}`}],children:e.jsx(ee,{onChange:C,indeterminate:!1,disabled:O})},S):e.jsxs(w.Item,{name:S,label:m,rules:[{type:k,message:`The input is not valid ${k}`},{required:v,message:`Please input a ${m}`}],children:[k==="select"&&e.jsx(Select,{placeholder:`Input ${m}`,options:F,disabled:select}),k==="text"&&S!=="idEquipment"&&e.jsx(G,{placeholder:`Input ${m||"data"}`,disabled:O}),k==="text"&&S==="idEquipment"&&e.jsx(G,{placeholder:`Input ${m||"data"}`,disabled:O}),k==="radio"&&e.jsx(ge.Group,{options:F,disabled:O}),k==="date"&&e.jsx(ye,{format:f,disabled:O})]},S)}),g=m=>{const S={...n,status:"pending",section3:{...m,completed:!0}};x({id:n._id,data:S}).then(k=>{k.data.status===200&&(c(4),s("4"))}),i&&(c(4),s("4"))};return e.jsxs("div",{className:"container-fluid pageContainer",children:[e.jsx("hr",{}),e.jsxs("div",{className:"d-flex justify-content-between ps-2 pe-2",children:[e.jsx("div",{className:"textSubtitle",children:"MONITOREO DE GASES"}),e.jsxs("div",{className:"textSubtitle",children:["Permiso Número: ",p]})]}),e.jsx("hr",{}),e.jsx("div",{style:{marginRight:10},children:e.jsxs(w,{form:l,name:"section3",onFinish:g,layout:"horizontal",initialValues:{idEquipment:n==null?void 0:n.section1.equipment.internalId},children:[e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col",children:e.jsx("div",{className:"d-flex",children:u("No Requerido","noRequired","checkbox",null,!1,null,i)})}),e.jsx("div",{className:"col",children:e.jsx("div",{className:"d-flex",children:u("Inicial","starter","checkbox",null,!1,null,i)})}),e.jsx("div",{className:"col",children:e.jsx("div",{className:"d-flex",children:u("Aleatorio","random","checkbox",null,!1,null,i)})}),e.jsx("div",{className:"col",children:e.jsx("div",{className:"d-flex",children:u("Continuo","continue","checkbox",null,!1,null,i)})}),e.jsx("div",{className:"col",children:e.jsx("div",{className:"d-flex",children:u("Registro cada(Min)","byMinutes","checkbox",null,!1,null,i)})})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-4",children:e.jsx("div",{className:"d-flex",children:u("Nombre Inspector de Atmósfera","atmInspector","text",null,null,null,i)})}),e.jsx("div",{className:"col-3",children:e.jsx("div",{className:"d-flex",children:u("#Serial Equipo","idEquipment","text",null,null,null,i)})}),e.jsx("div",{className:"col",children:e.jsx("div",{className:"d-flex",children:u("Fecha Calibración","calibrationDate","date",null,null,null,i)})}),e.jsx("div",{className:"col",children:e.jsx("div",{className:"d-flex",children:u("Fecha Verificación","verificationDate","date",null,null,null,i)})})]}),e.jsxs("div",{className:"row gasHeight",children:[e.jsx("div",{className:"col-2",children:e.jsx("div",{className:"",children:"Fecha y Hora:"})}),e.jsxs("div",{className:"col-10",children:[" ",e.jsxs("div",{className:"d-flex flex-row justify-content-end",children:[u(null,"row1Col1","date",null,null,null,i),u(null,"row1Col2","date",null,null,null,i),u(null,"row1Col3","date",null,null,null,i),u(null,"row1Col4","date",null,null,null,i),u(null,"row1Col5","date",null,null,null,i)]})]})]}),e.jsxs("div",{className:"row gasHeight",children:[e.jsx("div",{className:"col-2",children:e.jsx("div",{className:"",children:"%LEL | 0%"})}),e.jsxs("div",{className:"col-10",children:[" ",e.jsxs("div",{className:"d-flex flex-row justify-content-end",children:[u(null,"row2Col1","text",null,null,null,i),u(null,"row2Col2","text",null,null,null,i),u(null,"row2Col3","text",null,null,null,i),u(null,"row2Col4","text",null,null,null,i),u(null,"row2Col5","text",null,null,null,i)]})]})]}),e.jsxs("div",{className:"row gasHeight",children:[e.jsx("div",{className:"col-2",children:e.jsx("div",{className:"",children:"%02 | 19.5% a 22.5%"})}),e.jsxs("div",{className:"col-10",children:[" ",e.jsxs("div",{className:"d-flex flex-row justify-content-end",children:[u(null,"row3Col1","text",null,null,null,i),u(null,"row3Col2","text",null,null,null,i),u(null,"row3Col3","text",null,null,null,i),u(null,"row3Col4","text",null,null,null,i),u(null,"row3Col5","text",null,null,null,i)]})]})]}),e.jsxs("div",{className:"row gasHeight",children:[e.jsx("div",{className:"col-2",children:e.jsx("div",{className:"",children:"CO (ppm) | s25"})}),e.jsxs("div",{className:"col-10",children:[" ",e.jsxs("div",{className:"d-flex flex-row justify-content-end",children:[u(null,"row4Col1","text",null,null,null,i),u(null,"row4Col2","text",null,null,null,i),u(null,"row4Col3","text",null,null,null,i),u(null,"row4Col4","text",null,null,null,i),u(null,"row4Col5","text",null,null,null,i)]})]})]}),e.jsxs("div",{className:"row gasHeight",children:[e.jsx("div",{className:"col-2",children:e.jsx("div",{className:"",children:"H2s (ppm) | s1"})}),e.jsxs("div",{className:"col-10",children:[" ",e.jsxs("div",{className:"d-flex flex-row justify-content-end",children:[u(null,"row5Col1","text",null,null,null,i),u(null,"row5Col2","text",null,null,null,i),u(null,"row5Col3","text",null,null,null,i),u(null,"row5Col4","text",null,null,null,i),u(null,"row5Col5","text",null,null,null,i)]})]})]}),e.jsxs("div",{className:"row gasHeight",children:[e.jsx("div",{className:"col-2",children:e.jsx("div",{className:"",children:"OTRO"})}),e.jsxs("div",{className:"col-10",children:[" ",e.jsxs("div",{className:"d-flex flex-row justify-content-end",children:[u(null,"row6Col1","text",null,null,null,i),u(null,"row6Col2","text",null,null,null,i),u(null,"row6Col3","text",null,null,null,i),u(null,"row6Col4","text",null,null,null,i),u(null,"row6Col5","text",null,null,null,i)]})]})]}),e.jsxs("div",{className:"row gasHeight",children:[e.jsx("div",{className:"col-2",children:e.jsx("div",{className:"",children:"FIRMA INSPECTOR"})}),e.jsxs("div",{className:"col-10",children:[" ",e.jsxs("div",{className:"d-flex flex-row justify-content-end",children:[u(null,"row7Col1","text",null,null,null,i),u(null,"row7Col2","text",null,null,null,i),u(null,"row7Col3","text",null,null,null,i),u(null,"row7Col4","text",null,null,null,i),u(null,"row7Col5","text",null,null,null,i)]})]})]}),e.jsx("div",{className:"d-flex justify-content-end mt-5",children:e.jsx(w.Item,{children:e.jsx($,{type:"primary",htmlType:"submit",className:"float-right",children:"Seguir"})})})]})})]})};function Fe(t){function s(C,O){return C>>>O|C<<32-O}for(var a=Math.pow,h=a(2,32),c="length",l,n,o="",p=[],d=t[c]*8,i=Fe.h=Fe.h||[],N=Fe.k=Fe.k||[],f=N[c],x={},j=2;f<64;j++)if(!x[j]){for(l=0;l<313;l+=j)x[l]=j;i[f]=a(j,.5)*h|0,N[f++]=a(j,1/3)*h|0}for(t+="";t[c]%64-56;)t+="\0";for(l=0;l<t[c];l++){if(n=t.charCodeAt(l),n>>8)return;p[l>>2]|=n<<(3-l)%4*8}for(p[p[c]]=d/h|0,p[p[c]]=d,n=0;n<p[c];){var E=p.slice(n,n+=16),A=i;for(i=i.slice(0,8),l=0;l<64;l++){var u=E[l-15],g=E[l-2],m=i[0],S=i[4],k=i[7]+(s(S,6)^s(S,11)^s(S,25))+(S&i[5]^~S&i[6])+N[l]+(E[l]=l<16?E[l]:E[l-16]+(s(u,7)^s(u,18)^u>>>3)+E[l-7]+(s(g,17)^s(g,19)^g>>>10)|0),F=(s(m,2)^s(m,13)^s(m,22))+(m&i[1]^m&i[2]^i[1]&i[2]);i=[k+F|0].concat(i),i[4]=i[4]+k|0}for(l=0;l<8;l++)i[l]=i[l]+A[l]|0}for(l=0;l<8;l++)for(n=3;n+1;n--){var v=i[l]>>n*8&255;o+=(v<16?0:"")+v.toString(16)}return o}const st=({prefix:t,user:s,initialValues:a,onSubmit:h,disabled:c})=>{const[l,n]=r.useState({}),[o,p]=r.useState(!1),[d]=w.useForm();r.useEffect(()=>{if(a===null&&c===!1){n(!1);const N={[`name${t}`]:s==null?void 0:s.name,[`sign${t}`]:s.name,[`date${t}`]:J()};console.log("entrooooo",N),n(N),d.setFieldsValue(N),p(!0)}else n(!1),n(a),d.setFieldsValue(a),p(!0)},[t,s,a,c]);const i=(N,f,x,j)=>e.jsxs(w.Item,{name:`${f}${t}`,label:N,rules:[{required:j,message:`Please input a ${N}`}],className:"field-input-content",children:[x==="text"&&e.jsx(G,{placeholder:`Input ${N||"data"}`,disabled:c}),x==="date"&&e.jsx(ye,{disabled:c,placeholder:"dd/mm/aaaa",className:"px-3"})]},`${f}${t}`);return o&&e.jsxs(w,{form:d,name:"signForm",className:"w-100 h-100 d-flex row justify-content-center",layout:"vertical",onFinish:h,children:[i("Nombre","name","text",!0),i("Firma","sign","text",!0),i("Fecha","date","date",!0),c&&a!==null?e.jsx("span",{children:"Firmado"}):e.jsx($,{className:"buton-card-singing",type:"primary",htmlType:"submit",disabled:c,children:"Firmar"})]})},tt=({section1:t})=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"d-flex flex-direction-row",children:[e.jsx("span",{className:"p-1 bg-secondary text-white text-center section-title",style:{width:"13%"},children:"SECCION 1"}),e.jsxs("div",{className:"section-title d-flex justify-content-start align-items-center",style:{width:"87%"},children:[" ","INFORMACIÓN GENERAL"]})]}),e.jsxs("div",{className:"row section-label",children:[e.jsxs("div",{className:"col",children:[e.jsxs("p",{children:["Fecha de solicitud:"," ",e.jsx("span",{children:J(t==null?void 0:t.updatedAt).format("DD/MM/YYYY")})]}),e.jsxs("p",{className:"ps-2",children:["Hora: ",e.jsx("span",{children:J(t==null?void 0:t.updatedAt).format("HH:mm")})]})]}),e.jsx("div",{className:"col",children:e.jsxs("p",{children:["Compañia que requiere el servicio: ",e.jsx("span",{children:t==null?void 0:t.company})]})}),e.jsx("div",{className:"col",children:e.jsxs("p",{children:["Instalación: ",e.jsx("span",{children:t==null?void 0:t.location})]})}),e.jsx("div",{className:"col",children:e.jsxs("p",{children:["Area: ",e.jsx("span",{children:t==null?void 0:t.area.label})]})})]}),e.jsxs("div",{className:"row section-label mt-2",children:[e.jsx("div",{className:"col",children:e.jsxs("p",{children:["Equipos a intervenir: ",e.jsx("span",{children:t==null?void 0:t.equipment.label})]})}),e.jsx("div",{className:"col",children:e.jsxs("p",{children:["Alcance del trabajo: ",e.jsx("span",{children:t==null?void 0:t.alcance})]})}),e.jsx("div",{className:"col",children:e.jsxs("p",{children:["Nivel potencial de peligro identificado:"," ",e.jsx("span",{children:t==null?void 0:t.warning})]})}),e.jsx("div",{className:"col",children:e.jsxs("p",{children:["Equipos y herramientas a usar: ",e.jsx("span",{children:t==null?void 0:t.tools})]})})]})]}),at=({section2:t})=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"d-flex flex-direction-row",children:[e.jsx("span",{className:"p-1 bg-secondary text-white text-center section-title",style:{width:"13%"},children:"SECCION 2"}),e.jsxs("div",{className:"section-title d-flex justify-content-start align-items-center",style:{width:"87%"},children:[" ","ANÁLISIS DE RIESGOS, CERTIFICADOS DE APOYO Y DOCUMENTO DE APOYO REQUERIDOS"]})]}),e.jsx("div",{className:"section-subtitle",children:"ANÁLISIS DE RIESGOS REQUERIDOS"}),e.jsxs("div",{className:"row section-label mb-2",children:[e.jsx("div",{className:"col",children:e.jsxs("p",{children:["Análisis de seguridad en el trabajo - AST:"," ",e.jsxs("span",{className:"",children:[t!=null&&t.check1?"si":"No aplica"," ",t==null?void 0:t.astNumber]})]})}),e.jsx("div",{className:"col",children:e.jsxs("p",{children:["Análisis de peligro en la etapa de Planificación - APP:"," ",e.jsx("span",{className:"",children:t!=null&&t.apep?t.apep:"No aplica"})]})}),e.jsx("div",{className:"col",children:e.jsxs("p",{children:["Otro: ",t!=null&&t.check2?"si":"N/A",e.jsxs("span",{className:"ps-2",children:["Cual? : ",t!=null&&t.oAnalysisDescription?t.oAnalysisDescription:"No aplica"]})]})})]}),e.jsx("div",{className:"section-subtitle",children:"CERTIFICADOS DE APOYO REQUERIDOS"}),e.jsxs("div",{className:"row section-label mt-2",children:[e.jsx("div",{className:"col",children:e.jsxs("p",{children:["Certificado de apoyo Trabajo en Caliente: ",e.jsx("span",{children:t!=null&&t.caliente?t==null?void 0:t.caliente:"No aplica"})]})}),e.jsx("div",{className:"col",children:e.jsxs("p",{children:["Certificado de apoyo de Raciaciones: ",e.jsx("span",{children:t!=null&&t.raciaciones?t==null?void 0:t.raciaciones:"No aplica"})]})}),e.jsx("div",{className:"col",children:e.jsxs("p",{children:["Certificado de apoyo de Excavación: ",e.jsx("span",{children:t!=null&&t.excavacion?t==null?void 0:t.excavacion:"No aplica"})]})})]}),e.jsxs("div",{className:"row section-label mt-2",children:[e.jsx("div",{className:"col",children:e.jsxs("p",{children:["Certificado de apoyo Trabajo en Altura: ",e.jsx("span",{children:t!=null&&t.altura?t==null?void 0:t.altura:"No aplica"})]})}),e.jsx("div",{className:"col",children:e.jsxs("p",{children:["Certificado de apoyo Izaje de Carga: ",e.jsx("span",{children:t!=null&&t.izaje?t==null?void 0:t.izaje:"No aplica"})]})}),e.jsx("div",{className:"col",children:e.jsxs("p",{children:["Certificado de apoyo Espacios Confinados: ",e.jsx("span",{children:t!=null&&t.confinados?t==null?void 0:t.confinados:"No aplica"})]})})]}),e.jsxs("div",{className:"row section-label mt-2",children:[e.jsx("div",{className:"col",children:e.jsxs("p",{children:["Otro? : ",e.jsx("span",{children:t!=null&&t.check3?"si":"N/A"})]})}),(t==null?void 0:t.oSupportDescription)&&e.jsx("div",{className:"col",children:e.jsxs("p",{children:["Cual? : ",e.jsx("span",{children:t==null?void 0:t.oSupportDescription})]})})]})]}),lt=({section3:t})=>{const s="DD/MM/YYYY",a=t.row1Col1!==null,h=["Fecha y Hora:","%LEL | 0%","%02 | 19.5% a 22.5%","CO (ppm) | s25","H2s (ppm) | s1","OTRO","FIRMA INSPECTOR"],c=[];for(let o=1;o<=7;o++){const p=[h[o-1],o===1?t[`row${o}Col1`]?J(t[`row${o}Col1`]).format(s):"":t[`row${o}Col1`],o===1?t[`row${o}Col2`]?J(t[`row${o}Col2`]).format(s):"":t[`row${o}Col2`],o===1?t[`row${o}Col3`]?J(t[`row${o}Col3`]).format(s):"":t[`row${o}Col3`],o===1?t[`row${o}Col4`]?J(t[`row${o}Col4`]).format(s):"":t[`row${o}Col4`],o===1?t[`row${o}Col5`]?J(t[`row${o}Col5`]).format(s):"":t[`row${o}Col5`]];p.pop(),c.push(p)}const l=[{title:"",dataIndex:"label",key:"label",width:200},{title:"",dataIndex:"0",key:"0"},{title:"",dataIndex:"1",key:"1"},{title:"",dataIndex:"2",key:"2"},{title:"",dataIndex:"3",key:"3"},{title:"",dataIndex:"4",key:"4"}],n=c.map((o,p)=>({key:p,label:o[0],...o.slice(1)}));return a&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"d-flex flex-direction-row",children:[e.jsx("span",{className:"p-1 bg-secondary text-white text-center section-title",style:{width:"13%"},children:"SECCION 3"}),e.jsx("div",{className:"section-title d-flex justify-content-start align-items-center",style:{width:"87%"},children:"MONITOREO DE GASES"})]}),e.jsxs("div",{className:"row section-label mb-2",children:[e.jsxs("div",{className:"col",children:[e.jsx("p",{children:"No requerido :"}),e.jsx("span",{children:t!=null&&t.noRequired?"Si":"No aplica"})]}),e.jsxs("div",{className:"col",children:[e.jsx("p",{children:"Inicial :"}),e.jsx("span",{children:t!=null&&t.starter?"Si":"No aplica"})]}),e.jsxs("div",{className:"col",children:[e.jsx("p",{children:"Aleatorio :"}),e.jsx("span",{children:t!=null&&t.random?"Si":"No aplica"})]}),e.jsxs("div",{className:"col",children:[e.jsx("p",{children:"Continuo:"}),e.jsx("span",{children:t!=null&&t.continue?"Si":"No aplica"})]}),e.jsxs("div",{className:"col",children:[e.jsx("p",{children:"Registro cada(Min) :"}),e.jsx("span",{children:t!=null&&t.byMinutes?"Si":"No aplica"})]})]}),e.jsxs("div",{className:"row section-label mb-2",children:[e.jsxs("div",{className:"col",children:[e.jsx("p",{children:"Nombre Inspector de Atmósfera :"}),e.jsx("span",{children:t!=null&&t.atmInspector?t.atmInspector:"No aplica"})]}),e.jsxs("div",{className:"col",children:[e.jsx("p",{children:"#Serial Equipo :"}),e.jsx("span",{children:t!=null&&t.idEquipment?t.idEquipment:"No aplica"})]}),e.jsxs("div",{className:"col",children:[e.jsx("p",{children:"Fecha Calibración :"}),e.jsx("span",{children:t!=null&&t.calibrationDate?J(t.calibrationDate).format(s):"No aplica"})]}),e.jsxs("div",{className:"col",children:[e.jsx("p",{children:"Fecha Verificación :"}),e.jsx("span",{children:t!=null&&t.verificationDate?t.verificationDate:"No aplica"})]})]}),e.jsx("div",{className:"container-fluid pageContainer",children:e.jsx("div",{style:{marginRight:10},children:e.jsx(Ne,{dataSource:n,columns:l,pagination:!1,bordered:!0,size:"small"})})})]})},nt=({section4:t})=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"d-flex flex-direction-row",children:[e.jsx("span",{className:"p-1 bg-secondary text-white text-center section-title",style:{width:"13%"},children:"SECCION 4"}),e.jsxs("div",{className:"section-title d-flex justify-content-start align-items-center",style:{width:"87%"},children:[" ","REVISIÓN CONDICIONES PREINICIO DE TRABAJO"]})]}),e.jsxs("div",{className:"row section-label",children:[e.jsx("div",{className:"",children:e.jsxs("p",{children:["El personal manfiesta encontrase en buenas condiciones de salud:"," ",e.jsx("span",{children:(t==null?void 0:t.healthy)===!0?"Si":"No aplica"})]})}),e.jsx("div",{className:"",children:e.jsxs("p",{children:["Se ha completado el aislamiento, bloqueo y etiquetado: ",e.jsx("span",{children:(t==null?void 0:t.isnulate)==="si"?"Si":"No aplica"})]})}),e.jsx("div",{className:"row section-label",children:e.jsx("div",{className:"",children:e.jsxs("p",{children:["Los equipos se encuentran en condiciones seguras para se intervenidos: ",e.jsx("span",{children:(t==null?void 0:t.safety)==="si"?"Si":"No aplica"})]})})})]})]}),kl=({user:t,initialValues:s,values:a})=>{he();const[h,{isSuccess:c,error:l,reset:n}]=xe(),o=D(f=>f.permits.permit),[p,d]=r.useState(!!s),i=(f,x)=>{const j={...o,status:"pending",section5:{...o.section5,[x]:{...f},completed:!0}};h({id:o._id,data:j}).then(E=>{E.data.status===200&&(d(!0),console.log("Received values of form: ",E.data),K({content:"Se ha firmado exitosamente",title:"Permiso Aprobado"}),n())})},N={nameAe:t==null?void 0:t.name,signAe:t==null?void 0:t.name,dateAe:J()};return e.jsxs(e.Fragment,{children:[e.jsx("div",{children:e.jsx(tt,{section1:o==null?void 0:o.section1})}),e.jsx("div",{children:e.jsx(at,{section2:o==null?void 0:o.section2})}),e.jsx("div",{children:e.jsx(lt,{section3:o==null?void 0:o.section3})}),e.jsx("div",{children:e.jsx(nt,{section4:o!=null&&o.section4.completed?o==null?void 0:o.section4:a})}),e.jsx("div",{className:"d-flex mt-3",style:{justifyContent:"center"},children:e.jsx(Ve,{style:{width:300},children:e.jsx(st,{prefix:"Ae",user:t,initialValues:s?{...s,dateAe:J(s==null?void 0:s.dateAe)}:N,onSubmit:f=>i(f,"section53"),disabled:p})})})]})},Al=({value:t,setValue:s,number:a,show:h,setShow:c})=>{var L,H,U,B;const l=he(),[n,o]=r.useState(!1),[p,d]=r.useState({}),[i,N]=r.useState(null),[f]=w.useForm(),x=D(V=>V.permits.permit),j=D(V=>V.users.user),[E,A]=r.useState({}),[u,g]=r.useState(a);r.useState(!1);const[m,S]=r.useState(!1),k="DD/MM/YYYY HH:mm",[F,{isSuccess:v,error:C,reset:O}]=xe();r.useEffect(()=>{if((x==null?void 0:x.formNumber)===parseInt(a)){const V={...x==null?void 0:x.section4};f.setFieldsValue(V),(x==null?void 0:x.status)==="waiting"&&Ce.includes(j==null?void 0:j.role),S(!1)}},[]);const T=[{label:"Si",value:"si"},{label:"N/A",value:"na"}],q=(V,W,P,_,R,Q,ae)=>e.jsx(e.Fragment,{children:P==="checkbox"?e.jsx(w.Item,{label:V,name:W,valuePropName:"checked",rules:[{type:P,message:`The input is not valid ${P}`},{required:R,message:`Please input a ${V}`}],children:e.jsx(ee,{onChange:Q,indeterminate:!1,disabled:ae})},W):e.jsxs(w.Item,{name:W,label:V,rules:[{type:P,message:`The input is not valid ${P}`},{required:R,message:`Please input a ${V}`}],children:[P==="select"&&e.jsx(Select,{placeholder:`Input ${V}`,options:_,disabled:select}),P==="text"&&e.jsx(G,{placeholder:`Input ${V||"data"}`,disabled:ae}),P==="radio"&&e.jsx(ge,{disabled:ae}),P==="radiogroup"&&e.jsx(ge.Group,{options:_,disabled:ae}),P==="date"&&e.jsx(ye,{format:k,disabled:ae})]},W)}),M=V=>{var Q;const W=[x==null?void 0:x.formNumber],P=[(Q=x==null?void 0:x.section1.equipment)==null?void 0:Q.label.trim().split(" ").join("")],_=W.concat(P),R=Fe(_);d(V),N(R),o(!0)},I=(V,W)=>{const P=`https://api.stamping.io/util/keys/create/?pwd=${V}&token=1ff366eb140491c61d626af1238b09b5a284e143bf713026f3b8ca4038d`;fetch(P).then(_=>_.json()).then(_=>{const R={...x,status:"waiting",section4:{...W,completed:!0},more:{publicKey:_.RSA.publicKey,privateKey:_.RSA.privateKey}};y(R)})},y=V=>{F({id:x._id,data:V}).then(W=>{W.data.status===200&&(K({title:"Solicitud Enviada",content:"La solicitud fue enviada exitosamente"}),l("/permissions"))}),O()};return e.jsxs("div",{className:"container-fluid pageContainer",children:[e.jsx("hr",{}),e.jsxs("div",{className:"d-flex justify-content-between ps-2 pe-2",children:[e.jsx("div",{className:"textSubtitle",children:"REVISION CONDICIONES PREINICIO DE TRABAJO"}),e.jsxs("div",{className:"textSubtitle",children:["Permiso Número: ",u]})]}),e.jsx("hr",{}),e.jsx("div",{style:{marginRight:10},children:e.jsxs(w,{form:f,layout:"horizonatl",name:"section4",initialValues:E,onValuesChange:()=>{A(f.getFieldsValue())},onFinish:M,children:[e.jsx("div",{className:"row",children:e.jsx("div",{className:"col",children:e.jsxs("div",{className:"d-flex justify-content-start align-items-baseline",children:[e.jsx("div",{className:"",children:"EL PERSONAL MANIFIESTA ENCONTRARSE EN BUENAS CONDICIONES DE SALUD"}),e.jsx("div",{className:"ms-4",children:q("","healthy","checkbox",null,!0,null,m)})]})})}),e.jsx("div",{className:"row",children:e.jsx("div",{className:"col",children:e.jsxs("div",{className:"d-flex justify-content-start align-items-baseline",children:[e.jsx("div",{className:"",children:"SE HA COMPLETADO EL AISLAMIENTO, BLOQUEO Y ETIQUETADO"}),e.jsx("div",{className:"ms-4",children:q("","isnulate","radiogroup",T,!0,null,m)})]})})}),e.jsx("div",{className:"row",children:e.jsx("div",{className:"col",children:e.jsxs("div",{className:"d-flex justify-content-start align-items-baseline",children:[e.jsx("div",{className:"",children:"LOS EQUIPOS SE ENCUENTRAN EN CONDICIONES SEGURAS PARA SER ITERVENIDOS"}),e.jsx("div",{className:"ms-4",children:q("","safety","radiogroup",T,!1,null,m)})]})})}),e.jsx("div",{className:"d-flex justify-content-end mt-5",children:e.jsx(w.Item,{children:e.jsx($,{type:"primary",htmlType:"submit",className:"float-right",children:"Enviar Solicitud"})})})]})}),e.jsx(ne,{title:e.jsx("h2",{className:"d-flex justify-content-center mb-4",children:"Resumen permiso de trabajo general"}),centered:!0,open:n,onOk:()=>I(i,p),onCancel:()=>o(!1),width:1e3,okText:"Enviar solicitud",cancelText:"Editar",okButtonProps:{disabled:(L=x==null?void 0:x.section4)==null?void 0:L.completed},cancelButtonProps:{disabled:(H=x==null?void 0:x.section4)==null?void 0:H.completed},children:e.jsx(kl,{user:j,initialValues:(U=x==null?void 0:x.section5)!=null&&U.section53?(B=x==null?void 0:x.section5)==null?void 0:B.section53:null,values:p})})]})},Il=()=>{const t=he(),s=D(f=>f.permits.permit),a=D(f=>f.users.user),[h,c]=r.useState({}),[l,{isSuccess:n,error:o,reset:p}]=xe();r.useEffect(()=>{d(a==null?void 0:a.role)},[a]);const d=f=>{const x={};switch(f){case"autoridadArea":x.disabledAda=!1,x.disabledAal=!0,x.disabledAe=!0,x.disabledOa=!0;break;case"autoridadMunicipal":x.disabledAda=!0,x.disabledAal=!1,x.disabledAe=!0,x.disabledOa=!0;break;case"contractor":x.disabledAda=!0,x.disabledAal=!0,x.disabledAe=!1,x.disabledOa=!0;break;default:x.disabledAda=!0,x.disabledAal=!0,x.disabledAe=!0,x.disabledOa=!1;break}c(x)},i=(f,x)=>{const j={...s,status:"approved",section5:{...s.section5,[x]:{...f},completed:!0}};s.section4.completed?l({id:s._id,data:j}).then(E=>{E.data.status===200&&(console.log("Received values of form: ",E.data),K({content:"Se ha aprobado el permiso",title:"Permiso Aprobado"}),p(),t("/permissions"))}):te({content:"El formulario no está completo",title:"Firma denegada"})},N=[{prefix:"Ada",label:"Autoridad de Area",section:"section51"},{prefix:"Aal",label:"Autoridad de Area Local",section:"section52"},{prefix:"Ae",label:"Autoridad Ejecutante",section:"section53"},{prefix:"Oa",label:"Otra Autoridad",section:"section54"}];return e.jsxs("div",{className:"container-fluid pageContainer p-0 h-100 ",children:[e.jsx("hr",{}),e.jsxs("div",{className:"d-flex justify-content-between ps-2 pe-2",children:[e.jsx("div",{className:"textSubtitle",children:"APROBACION"}),e.jsxs("div",{className:"textSubtitle",children:["Permiso Número: ",s==null?void 0:s.formNumber]})]}),e.jsx("hr",{}),e.jsx("div",{className:"d-flex column h-75 w-100 justify-content-center ",children:e.jsx("div",{className:"row gap-4 align-content-center flex-nowrap overflow-hidden overflow-x-scroll p-3 scroll-myProp",style:{width:"90%",height:"98%"},children:N.map(f=>{var E,A,u;const x={...(E=s==null?void 0:s.section5)==null?void 0:E[f.section]};let j=!1;return x&&((A=s==null?void 0:s.section5)!=null&&A[f.section])&&(x[`date${f.prefix}`]=J(x[`date${f.prefix}`])||"",j=Object.keys(x).length>0),e.jsxs("div",{className:`col box-shadow p-3 col-md-4 card-container-singing ${j||h[`disabled${f.prefix}`]?"disabled":""}`,children:[e.jsxs("h6",{className:"title-card-singing",children:[f.label," ",j&&e.jsx(Tt,{})," "]}),e.jsx("div",{className:"bar-card-singing"}),e.jsx(st,{className:" ",prefix:f.prefix,user:a,initialValues:(u=s==null?void 0:s.section5)!=null&&u[f.section]?x:null,onSubmit:g=>i(g,f.section),disabled:j||h[`disabled${f.prefix}`]})]},f.prefix)})})})]})},Fl=()=>{w.useForm();const t=D(h=>h.permits.permit);D(h=>h.users.user),r.useState({}),xe(),r.useEffect(()=>{},[]);const s=[{title:"Motivo",dataIndex:"motivo",key:"motivo"},{title:"Hora",dataIndex:"date",key:"date"},{title:"Firma AE",dataIndex:"signAe",key:"signAe"},{title:"Firma AAL",dataIndex:"signAal",key:"signAal"}],a=[{title:"Fecha",dataIndex:"rdate",key:"rdate"},{title:"Hora Inicio",dataIndex:"rstart",key:"rstart"},{title:"Hora Fin",dataIndex:"rend",key:"rend"},{title:"Firma AE",dataIndex:"signAe",key:"signAe"},{title:"Firma AAL",dataIndex:"signAal",key:"signAal"}];return e.jsxs("div",{className:"container-fluid pageContainer",children:[e.jsx("hr",{}),e.jsxs("div",{className:"d-flex justify-content-between ps-2 pe-2",children:[e.jsx("div",{className:"textSubtitle",children:"SUSPENSIONES Y REVALIDACIONES"}),e.jsxs("div",{className:"textSubtitle",children:["Permiso Número: ",t==null?void 0:t.formNumber]})]}),e.jsx("hr",{}),e.jsxs("div",{style:{marginRight:10},children:[e.jsxs("div",{className:"row",children:[e.jsx("p",{className:"mb-2",children:"Suspenciones"}),e.jsx(Ne,{columns:s,dataSource:t==null?void 0:t.suspensions,pagination:!1})]}),e.jsxs("div",{className:"row",children:[e.jsx("p",{className:"mb-2 mt-2",children:"Revalidaciones"}),e.jsx(Ne,{columns:a,dataSource:t==null?void 0:t.suspensions,pagination:!1})]}),e.jsxs("div",{className:"d-flex justify-content-around mt-5",children:[e.jsx($,{type:"primary",htmlType:"submit",className:"float-right",children:"Suspenciones"}),e.jsx($,{type:"primary",htmlType:"submit",className:"float-right",children:"Revalidaciones"})]})]})]})},Ol=()=>{const[t]=w.useForm(),s=D(A=>A.permits.permit);D(A=>A.users.user);const[a,h]=r.useState({}),[c,l]=r.useState(!1),[n,o]=r.useState(!0),[p,d]=r.useState(!0),[i,N]=r.useState(!0);xe();const f="DD/MM/YYYY HH:mm",x=A=>{A==="check1"&&o(!n),A==="check2"&&d(!p),A==="check3"&&N(!i)};r.useEffect(()=>{},[]);const j=(A,u,g,m,S,k,F)=>e.jsx(e.Fragment,{children:g==="checkbox"?e.jsx(w.Item,{label:A,name:u,valuePropName:"checked",rules:[{type:g,message:`The input is not valid ${g}`},{required:S,message:`Please input a ${A}`}],children:e.jsx(ee,{onChange:()=>x(k),indeterminate:!1,disabled:F})},u):e.jsxs(w.Item,{name:u,label:A,rules:[{type:g,message:`The input is not valid ${g}`},{required:S,message:`Please input a ${A}`}],children:[g==="text"&&e.jsx(G,{placeholder:`Input ${A||"data"}`,disabled:F}),g==="date"&&e.jsx(ye,{format:f,disabled:F})]},u)}),E=A=>{console.log("Submit: ",A),{...s,section7:{...A}}};return e.jsxs("div",{className:"container-fluid pageContainer",children:[e.jsx("hr",{}),e.jsxs("div",{className:"d-flex justify-content-between ps-2 pe-2",children:[e.jsx("div",{className:"textSubtitle",children:"REGISTRO ACOMPAÑAMIENTO DURANTE EJECUCION"}),e.jsxs("div",{className:"textSubtitle",children:["Permiso Número: ",s==null?void 0:s.formNumber]})]}),e.jsx("hr",{}),e.jsx("div",{style:{marginRight:10},children:e.jsxs(w,{form:t,layout:"horizonatl",name:"section7",initialValues:a,onValuesChange:()=>{h(t.getFieldsValue())},onFinish:E,children:[e.jsx("div",{className:"row",children:e.jsx("div",{className:"col",children:e.jsxs("div",{className:"d-flex justify-content-start align-items-baseline",children:[e.jsx("div",{className:"",children:"VISITA LIDERAZGO"}),e.jsx("div",{className:"ms-4",children:j("","visit","checkbox",null,!1,"check1",c)}),e.jsx("div",{className:"ms-4",children:j("Nombre","vname","text",null,!1,null,n)}),e.jsx("div",{className:"ms-4",children:j("Firma","vsign","text",null,!1,null,n)}),e.jsx("div",{className:"ms-4",children:j("Fecha","vdate","date",null,!0,null,n)})]})})}),e.jsx("div",{className:"row",children:e.jsx("div",{className:"col",children:e.jsxs("div",{className:"d-flex justify-content-start align-items-baseline",children:[e.jsx("div",{className:"",children:"CONVERSACION Y/O REFLEXXION"}),e.jsx("div",{className:"ms-4",children:j("","reflection","checkbox",null,!0,"check2",c)}),e.jsx("div",{className:"ms-4",children:j("Nombre","rname","text",null,!1,null,p)}),e.jsx("div",{className:"ms-4",children:j("Firma","rsign","text",null,!1,null,p)}),e.jsx("div",{className:"ms-4",children:j("Fecha","rdate","date",null,!1,null,p)})]})})}),e.jsx("div",{className:"row",children:e.jsx("div",{className:"col",children:e.jsxs("div",{className:"d-flex justify-content-start align-items-baseline",children:[e.jsx("div",{className:"",children:"REVISION DEL PERMISO"}),e.jsx("div",{className:"ms-4",children:j("","check","checkbox",null,!1,"check3",c)}),e.jsx("div",{className:"ms-4",children:j("Nombre","cname","text",null,!1,null,i)}),e.jsx("div",{className:"ms-4",children:j("Firma","csign","text",null,!1,null,i)}),e.jsx("div",{className:"ms-4",children:j("Fecha","cdate","date",null,!1,null,i)})]})})}),e.jsx("div",{className:"d-flex justify-content-end mt-5",children:e.jsx(w.Item,{children:e.jsx($,{type:"primary",htmlType:"submit",className:"float-right",children:"Enviar Registro"})})})]})})]})},Pl=()=>{const t=he(),[s,a,h,c]=w.useForm(),l=D(m=>m.permits.permit),n=D(m=>m.users.user),[o,p]=r.useState({});r.useState(""),r.useState([]);const[d,{isSuccess:i,error:N,reset:f}]=xe(),x="DD/MM/YYYY HH:mm";r.useEffect(()=>{const m={nameAda:n==null?void 0:n.name,signAda:n==null?void 0:n.name,dateAda:J(),nameAal:n==null?void 0:n.name,signAal:n==null?void 0:n.name,dateAal:J(),nameAe:n==null?void 0:n.name,signAe:n==null?void 0:n.name,dateAe:J(),nameOa:n==null?void 0:n.name,signOa:n==null?void 0:n.name,dateOa:J()};s.setFieldsValue(m),p(m)},[]);const j=(m,S,k,F,v,C,O)=>e.jsx(e.Fragment,{children:e.jsxs(w.Item,{name:S,label:m,rules:[{type:k,message:`The input is not valid ${k}`},{required:v,message:`Please input a ${m}`}],className:"field-input-content",children:[k==="text"&&e.jsx(G,{placeholder:`Input ${m||"data"}`,disabled:O}),k==="date"&&e.jsx(ye,{format:x,disabled:O})]},S)}),E=m=>{const S={...l,status:"completed",section8:{...m,completed:!0}};d({id:l._id,data:S}).then(k=>{k.data.status===200&&(K({title:"Trabajo completado",content:"El trabajo ha sido completado con éxito"}),t(`/preview/${l==null?void 0:l.formNumber}`))})},A=m=>{console.log("Received values of form: ",m)},u=m=>{console.log("Received values of form: ",m)},g=m=>{console.log("Received values of form: ",m)};return e.jsxs("div",{className:"container-fluid pageContainer",children:[e.jsx("hr",{}),e.jsxs("div",{className:"d-flex justify-content-between ps-2 pe-2",children:[e.jsx("div",{className:"textSubtitle",children:"CIERRE"}),e.jsxs("div",{className:"textSubtitle",children:["Permiso Número: ",l==null?void 0:l.formNumber]})]}),e.jsx("hr",{}),e.jsx("div",{className:"d-flex column h-75 w-100 justify-content-center ",children:e.jsxs("div",{className:"row gap-4 align-content-center flex-nowrap overflow-hidden overflow-x-scroll p-3 scroll-myProp",style:{width:"90%",height:"98%"},children:[e.jsxs("div",{className:"col box-shadow p-3 col-md-4 card-container-singing",children:[e.jsx("h6",{className:"title-card-singing",children:"Autoridad de Area"}),e.jsx("div",{className:"bar-card-singing"}),e.jsxs(w,{form:s,name:"section81",layout:"vertical",initialValues:o,onFinish:E,className:"w-100 h-100 d-flex row justify-content-center",children:[j("Nombre","nameAda","text","",!0,"",!1),j("Firma","signAda","text","",!0,"",!1),j("Fecha","dateAda","date","",!0,"",!1),e.jsx($,{className:"buton-card-singing",type:"primary",htmlType:"submit",children:"Firmar"})]})]}),e.jsxs("div",{className:"col box-shadow p-3 col-md-4 card-container-singing ",children:[e.jsx("h6",{className:"title-card-singing",children:"Autoridad de Area Local"}),e.jsx("div",{className:"bar-card-singing"}),e.jsxs(w,{form:a,name:"section82",layout:"vertical",initialValues:o,onFinish:A,className:"w-100 h-100 d-flex row justify-content-center",children:[j("Nombre","nameAal","text","",!0,"",!1),j("Firma","signAal","text","",!0,"",!1),j("Fecha","dateAal","date","",!0,"",!1),e.jsx($,{className:"buton-card-singing",type:"primary",htmlType:"submit",children:"Firmar"})]})]}),e.jsxs("div",{className:"col box-shadow p-3 col-md-4 card-container-singing ",children:[e.jsx("h6",{className:"title-card-singing",children:"Autoridad Ejecutante"}),e.jsx("div",{className:"bar-card-singing"}),e.jsxs(w,{form:h,name:"section83",layout:"vertical",initialValues:o,onFinish:u,className:"w-100 h-100 d-flex row justify-content-center",children:[j("Nombre","nameAe","text","",!0,"",!1),j("Firma","signAe","text","",!0,"",!1),j("Fecha","dateAe","date","",!0,"",!1),e.jsx($,{className:"buton-card-singing",type:"primary",htmlType:"submit",children:"Firmar"})]})]}),e.jsxs("div",{className:"col box-shadow p-3 col-md-4 card-container-singing ",children:[e.jsx("h6",{className:"title-card-singing",children:"Otra Autoridad"}),e.jsx("div",{className:"bar-card-singing"}),e.jsxs(w,{form:c,name:"section84",layout:"vertical",initialValues:o,onFinish:g,className:"w-100 h-100 d-flex row justify-content-center",children:[j("Nombre","nameOa","text","",!0,"",!1),j("Firma","signOa","text","",!0,"",!1),j("Fecha","dateOa","date","",!0,"",!1),e.jsx($,{className:"buton-card-singing",type:"primary",htmlType:"submit",children:"Firmar"})]})]})]})})]})},Tl=()=>{const{id:t}=ws();D(v=>v.users.user);const[s,a]=r.useState("1"),[h,c]=r.useState(1),l=JSON.parse(t),[n,o]=r.useState(!0),[p,d]=r.useState(!1),[i,N]=r.useState(!1),[f,x]=r.useState(!1),[j,E]=r.useState(!1),[A,u]=r.useState(!1),[g,m]=r.useState(!1),[S,k]=r.useState(!1),F=v=>{switch(v){case 1:o(!0),d(!1),N(!1),x(!1),E(!1),u(!1),m(!1),k(!1);break;case 2:o(!1),d(!0),N(!1),x(!1),E(!1),u(!1),m(!1),k(!1);break;case 3:o(!1),d(!1),N(!0),x(!1),E(!1),u(!1),m(!1),k(!1);break;case 4:o(!1),d(!1),N(!1),x(!0),E(!1),u(!1),m(!1),k(!1);break;case 5:o(!1),d(!1),N(!1),x(!1),E(!0),u(!1),m(!1),k(!1);break;case 6:o(!1),d(!1),N(!1),x(!1),E(!1),u(!0),m(!1),k(!1);break;case 7:o(!1),d(!1),N(!1),x(!1),E(!1),u(!1),m(!0),k(!1);break;case 8:o(!1),d(!1),N(!1),x(!1),E(!1),u(!1),m(!1),k(!0);break;default:o(!0),d(!1);break}};return r.useEffect(()=>{l!=null&&l.value&&(a(l.value),c(parseInt(l.value)))},[l.value]),r.useEffect(()=>{F(h)},[h]),r.useState("small"),e.jsx("div",{className:"w-100 h-100 d-flex justify-content-center align-items-cente",children:e.jsxs("div",{className:"",style:{width:"90%",height:"80%"},children:[e.jsx("div",{className:"tabs",children:e.jsxs("ul",{className:"tab-container ",children:[e.jsx("li",{id:"tab1",className:n?"tab permission activeItem activeList":"tab permission",children:e.jsx("a",{className:"sectionRed",onClick:()=>F(1),children:"Sección 1"})}),e.jsx("li",{id:"tab2",className:p?"tab permission activeItem activeList":"tab permission ",children:e.jsx("a",{className:"sectionRed",onClick:()=>F(2),children:"Sección 2"})}),e.jsx("li",{id:"tab3",className:i?"tab permission  activeItem activeList":"tab permission ",children:e.jsx("a",{className:"sectionRed",onClick:()=>F(3),children:"Sección 3"})}),e.jsx("li",{id:"tab4",className:f?"tab permission  activeItem activeList":"tab permission ",children:e.jsx("a",{className:"sectionRed",onClick:()=>F(4),children:"Sección 4"})}),e.jsx("li",{id:"tab5",className:j?"tab permission  activeItem activeList":"tab permission ",children:e.jsx("a",{className:"sectionGreen",onClick:()=>F(5),children:"Sección 5"})}),e.jsx("li",{id:"tab6",className:A?"tab permission  activeItem activeList":"tab permission ",children:e.jsx("a",{className:"sectionGreen",onClick:()=>F(6),children:"Sección 6"})}),e.jsx("li",{id:"tab7",className:g?"tab permission  activeItem activeList":"tab permission ",children:e.jsx("a",{className:"sectionBlue",onClick:()=>F(7),children:"Sección 7"})}),e.jsx("li",{id:"tab8",className:S?"tab permission  activeItem activeList":"tab permission ",children:e.jsx("a",{className:"sectionBlue",onClick:()=>F(8),children:"Sección 8"})})]})}),e.jsxs("div",{className:"blockBorder",children:[n&&e.jsx(wl,{value:s,setValue:a,number:l==null?void 0:l.id,show:h,setShow:c}),p&&e.jsx(Cl,{value:s,setValue:a,number:l==null?void 0:l.id,show:h,setShow:c}),i&&e.jsx(El,{value:s,setValue:a,number:l==null?void 0:l.id,show:h,setShow:c}),f&&e.jsx(Al,{value:s,setValue:a,number:l==null?void 0:l.id,show:h,setShow:c}),j&&e.jsx(Il,{value:s,setValue:a,number:l==null?void 0:l.id,show:h,setShow:c}),A&&e.jsx(Fl,{value:s,setValue:a,number:l==null?void 0:l.id,show:h,setShow:c}),g&&e.jsx(Ol,{value:s,setValue:a,number:l==null?void 0:l.id,show:h,setShow:c}),S&&e.jsx(Pl,{value:s,setValue:a,number:l==null?void 0:l.id,show:h,setShow:c})]})]})})},Rl=({children:t})=>e.jsx(e.Fragment,{children:e.jsx("div",{className:"container-fluid layoutContainer",children:e.jsx("div",{className:"subContent",children:e.jsx("div",{className:"abs-center",children:e.jsxs(ie,{children:[e.jsx(se,{className:"colStyle",children:e.jsx("div",{className:"",style:{marginBottom:20,marginTop:20},children:e.jsx("img",{src:Ws,alt:"",className:"brandLogo"})})}),e.jsx(se,{className:"colStyle",children:e.jsxs(Ve,{className:"card-login",children:[e.jsx("p",{className:"montserrat-login",children:"¡Bienvenido!"}),e.jsx("p",{className:"text-login",children:"Inicia sesión a continuación con tu usuario y contraseña"}),e.jsx("div",{className:"formContainer login-form ",children:t})]})})]})})})})}),Ml=()=>{const{loading:t}=D(l=>l.auth),{login:s}=de(),[a]=w.useForm(),h=[{label:"Correo",name:"email",type:"email",placeholder:"Correo"},{label:"Contraseña",name:"password",type:"password",placeholder:"Contraseña"}],c=l=>{const n={email:l.email,password:l.password};s(n)};return e.jsx(e.Fragment,{children:e.jsx(Ue,{fields:h,onFinish:c,formName:a,buttonTitle:t?"Iniciando...":"INICIAR SESIÓN",name:"login"})})},Dl=()=>e.jsx(e.Fragment,{children:e.jsx(Rl,{children:e.jsx(Ml,{})})}),Ll=["vehicle","property","equipment","machinery","other"],Ul=({assetId:t,setAssetId:s})=>{const[a]=w.useForm();de();const h=D(y=>y.locations.locations),[c,l]=r.useState(!1),[n,o]=r.useState(!0),[p,d]=r.useState(!1),[i,N]=r.useState(null),[f,x]=r.useState(!1),[j,E]=r.useState(null);r.useState(null);const[A,u]=r.useState(!1),{data:g,isSuccess:m,isError:S}=Vs(t,{skip:n}),[k,{isSuccess:F,error:v,reset:C}]=ts();h==null||h.map(y=>({label:y.locationName,value:y._id})),r.useEffect(()=>{t&&o(!1)},[t]);const O=[{label:"Nombre",name:"assetName",type:"text",placeholder:"Nombre"},{label:"Serial Equipo",name:"internalId",type:"text",placeholder:"Serial del equipo"},{label:"Tipo",name:"assetType",type:"select",placeholder:"Tipo",options:Ll.map(y=>({label:y,value:y}))},{label:"Ubicacion",name:"location",type:"select",placeholder:"Ubicacion",options:h.map(y=>({label:y.locationName,value:y._id}))}],T=()=>{d(!1),u(!1),l(!0)},q=()=>{d(!1),u(!1),a.resetFields(),s(null),l(!1)},M=()=>{d(!1),u(!1),a.resetFields(),l(!1),s(null)},I=()=>{a.validateFields().then(y=>{x(!0),C(),k({...y,id:t}).unwrap()}).catch(y=>{te({title:"Error",content:"Error updating asset"})})};return r.useEffect(()=>{var y;if(m){const L={...g[0],location:(y=g[0])==null?void 0:y.location._id};N({...L}),T()}S&&E("Error getting asset"),F&&(E("Asset updated successfully"),u(!0),s(null),l(!1),K({title:"Success",content:"User updated successfully"})),v&&(E("Error updating asset"),d(!0),s(null),l(!1),te({title:"Error",content:"Error updating asset"}))},[m,S,F,v]),e.jsx(e.Fragment,{children:e.jsx(ne,{open:c,forceRender:!0,title:"Updat assets",onOk:q,onCancel:M,cancelButtonProps:{form:a,key:"cancel",htmlType:"reset"},footer:[e.jsx($,{type:"default",onClick:M,children:"Exit"},"exit")],children:e.jsx(Qe,{form:a,formName:"assetForm",fields:O,initialValues:i,buttonTitle:"Update",onFinish:I,disabled:f})})})},rt=()=>{var me;r.useState([]);const t=he(),s=D(z=>z.tenants.tenants),[a,h]=r.useState(null),[c,l]=r.useState(""),[n,o]=r.useState(""),[p,d]=r.useState(!1),[i,N]=r.useState(null),f=D(z=>z.users.user),[x,j]=r.useState(!1),[E,A]=r.useState(!0),[u,g]=r.useState(!1);Me();const[m,S]=r.useState({}),[k,F]=r.useState({}),{data:v,isSuccess:C,error:O,isFetching:T,refetch:q}=Hs({}),[M,{isSuccess:I,error:y,reset:L}]=ts(),{data:H,isSuccess:U,error:B}=Vs(a,{skip:E}),V=(z,b,Y)=>{console.log("Various parameters",z,b,Y),S(b),F(Y)};s==null||s.map(z=>({text:z.name,value:z.name}));const W=(me=v==null?void 0:v.data)==null?void 0:me.map(z=>{var b,Y;return{key:z._id,name:z.assetName,internalId:z.internalId,location:(b=z.location)==null?void 0:b.locationName,city:(Y=z.location)==null?void 0:Y.city,enabled:z.isActive}}),P=[{title:"Name",dataIndex:"name",key:"name",render:z=>e.jsx("a",{children:z}),sorter:(z,b)=>{var Y,Z;return((Y=z.name)==null?void 0:Y.length)-((Z=b.name)==null?void 0:Z.length)}},{title:"Serial Equipo",dataIndex:"internalId",key:"internalId"},{title:"Ubicación",dataIndex:"location",key:"location"},{title:"Ciudad",dataIndex:"city",key:"city"},(f==null?void 0:f.role)==="root"&&{title:"Action",key:"action",render:(z,b)=>b.email!=="root@mail.com"?e.jsxs(De,{size:"middle",children:[b.enabled===!1?e.jsx(X,{title:"Activar equipo",children:e.jsx(Ee,{style:{fontSize:20,color:"#FF0000",marginRight:10},onClick:()=>ue("Activar equipo","activar",!0,b)})}):e.jsx(X,{title:"Desactivar equipo",children:e.jsx(Ee,{style:{fontSize:20,color:"#00CC99",marginRight:10},onClick:()=>ue("Desactivar equipo","desactivar",!1,b)})}),e.jsx(X,{title:"Editar equipo",children:e.jsx(Le,{style:{fontSize:20,color:"#333F50",marginRight:10},onClick:()=>_(b)})}),e.jsx(X,{title:"Vista Previa",children:e.jsx(Cs,{style:{fontSize:20,color:"#333F50",marginRight:10},onClick:()=>R(b)})})]}):null}].filter(Boolean),_=z=>{h(z.key)},R=z=>{h(z.key),A(!1),g(!0)};r.useEffect(()=>{U&&(A(!0),g(!0),t(`/asset-preview/${a}`),q())},[U]);const Q=z=>{j(!1),M({id:z.key,isActive:!1}).unwrap(),K({title:"Success",content:"User deactivated successfully"})},ae=z=>{j(!1),M({id:z.key,isActive:!0}).unwrap(),K({title:"Success",content:"User activated successfully"})},pe=z=>z.enabled?"":"inactive-row",ue=(z,b,Y,Z)=>{j(!0),l(z),o(b),d(Y),N(Z)};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"container",children:e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-12",children:e.jsx(Ne,{dataSource:W,columns:P,onChange:V,rowClassName:pe,pagination:{pageSize:6}})})})}),a&&e.jsx(Ul,{assetId:a,setAssetId:()=>h()}),e.jsx(We,{title:c,content:`¿Está seguro que desea ${n} al equipo ${i==null?void 0:i.name}?`,isModalOpen:x,onCancel:()=>j(!1),onOk:p?()=>ae(i):()=>Q(i),buttonTitle:n.charAt(0).toUpperCase()+n.slice(1)}),";"]})},ql=["vehicle","property","equipment","machinery","other"],$l=()=>{const[t]=w.useForm(),{credentials:s}=de(),a=D(T=>T.locations.locations),[h,c]=r.useState(!1);r.useState(null);const[l,n]=r.useState(!1),[o,p]=r.useState(!1),[d,i]=r.useState(null),[N,{isSuccess:f,error:x,reset:j}]=Sa();a==null||a.map(T=>({label:T.locationName,value:T._id}));const E=[{_id:"1",categoryName:"Automóvil"},{_id:"2",categoryName:"Camión"},{_id:"3",categoryName:"Motocicleta"},{_id:"4",categoryName:"SUV"},{_id:"5",categoryName:"Van"}],A=E==null?void 0:E.map(T=>({label:T.categoryName,value:T.categoryName})),u=[{_id:"1",brandName:"Chevrolet"},{_id:"2",brandName:"Ford"},{_id:"3",brandName:"Toyota"},{_id:"4",brandName:"Nissan"},{_id:"5",brandName:"Hyundai"}],g=u==null?void 0:u.map(T=>({label:T.brandName,value:T.brandName})),m=[{_id:"1",modelName:"Sail"},{_id:"2",modelName:"Spark"},{_id:"3",modelName:"Cruze"},{_id:"4",modelName:"Silverado"},{_id:"5",modelName:"Malibu"}],S=m==null?void 0:m.map(T=>({label:T.modelName,value:T.modelName})),k=[{label:"Tipo de activo",name:"assetType",type:"select",placeholder:"Tipo",options:ql.map(T=>({label:T,value:T}))},{label:"Nombre",name:"assetName",type:"text",placeholder:"Nombre"},{label:"ID Interno",name:"internalId",type:"text",placeholder:"Serial del equipo"},{label:"Categoría",name:"assetCategory",type:"select",placeholder:"Categoría",options:A},{label:"Marca",name:"assetMake",type:"select",placeholder:"Marca",options:g},{label:"Modelo",name:"assetModel",type:"select",placeholder:"Modelo",options:S},{label:"Número de chasís",name:"chassisNo",type:"text",placeholder:"Número de chasís"},{label:"Número de motor",name:"engineNo",type:"text",placeholder:"Número de motor"},{label:"Año",name:"assetYear",type:"text",placeholder:"Año"},{label:"Ubicacion",name:"location",type:"select",placeholder:"Ubicacion",options:a.map(T=>({label:T.locationName,value:T._id}))}],F=()=>{p(!1),n(!1),c(!0)},v=()=>{p(!1),n(!1),t.resetFields(),c(!1)},C=()=>{p(!1),n(!1),t.resetFields(),c(!1)},O=T=>{const q={...T,isActive:!0,tenant:s==null?void 0:s.tenantId};N(q).unwrap(),j()};return r.useEffect(()=>{f&&(n(!0),i("Asset created successfully"),c(!1),K({title:"Success",content:"Asset created successfully"})),x&&(p(!0),i("Error creating asset"),c(!1),te({title:"Error",content:"Error creating asset"}))},[f,x]),e.jsxs(e.Fragment,{children:[e.jsx($,{type:"primary",onClick:F,className:"button-add",children:"Add Asset"}),e.jsx(ne,{open:h,forceRender:!0,title:"Add assets",onOk:v,onCancel:C,cancelButtonProps:{form:t,key:"cancel",htmlType:"reset"},footer:[e.jsx($,{type:"default",onClick:C,children:"Exit"},"exit")],width:600,children:e.jsx(Ue,{fields:k,onFinish:O,name:"assetForm",buttonTitle:"Submit",formName:t,twoColumns:!0})})]})},_l=()=>e.jsxs(e.Fragment,{children:[e.jsxs(ie,{children:[e.jsx(se,{span:12,className:"text-center",children:e.jsx("h4",{children:"Assets administration"})}),e.jsx(se,{span:12,className:"text-center",children:e.jsx($l,{})})]}),e.jsx(ie,{className:"pt-3",children:e.jsx(se,{span:24,children:e.jsx(rt,{})})})]}),zl=()=>e.jsx("div",{children:"Maintenance"}),Vl=()=>e.jsxs(e.Fragment,{children:[e.jsxs(ie,{children:[e.jsx(se,{span:12,className:"text-center",children:e.jsx("h4",{children:"Assets maintenance"})}),e.jsx(se,{span:12,className:"text-center",children:e.jsx(zl,{})})]}),e.jsx(ie,{className:"pt-3",children:e.jsx(se,{span:24,children:e.jsx(rt,{})})})]}),Hl=()=>{const[t,s]=r.useState(!0),[a,h]=r.useState(!1),c=l=>{switch(l){case 1:s(!0),h(!1);break;case 2:s(!1),h(!0);break;default:s(!0),h(!1);break}};return e.jsx("div",{className:"w-100 h-100 d-flex justify-content-center align-items-cente",children:e.jsxs("div",{className:"",style:{width:"90%",height:"80%"},children:[e.jsx("div",{className:"tabs",children:e.jsxs("ul",{className:"tab-container",children:[e.jsx("li",{id:"tab1",className:t?"tab activeItem activeList":"tab",children:e.jsx("a",{onClick:()=>c(1),children:"Administración"})}),e.jsx("li",{id:"tab2",className:a?"tab activeItem activeList":"tab",children:e.jsx("a",{onClick:()=>c(2),children:"Mantenimiento"})})]})}),e.jsxs("div",{className:"blockBorder",children:[t&&e.jsx(_l,{}),a&&e.jsx(Vl,{})]})]})})},Ye=Rt({reducer:{auth:Wt,users:ra,tenants:ya,assets:ka,locations:ha,permits:Sl,[ve.reducerPath]:ve.reducer},middleware:t=>t().concat(ve.middleware),devTools:!0});Mt(Ye.dispatch);const Bl=()=>(r.useEffect(()=>{console.log("subscribing");const t=Ye.dispatch(je.endpoints.getLocations.initiate()),s=Ye.dispatch(oe.endpoints.getPermits.initiate());return()=>{console.log("unsubscribing"),t.unsubscribe(),s.unsubscribe()}},[]),e.jsx(fs,{})),Yl=()=>e.jsx("div",{className:"pageContainer",children:e.jsx("div",{className:"tabs",children:e.jsxs("div",{className:"tab-container",children:[e.jsxs("div",{id:"tab1",className:"tab",children:[e.jsx("a",{href:"#tab1",children:"Seccion 1"}),e.jsx("div",{className:"tab-content",children:e.jsx("p",{className:"textSubtitle",children:"INFORMACION GENERAL"})})]}),e.jsxs("div",{id:"tab2",className:"tab",children:[e.jsx("a",{href:"#tab2",children:"Seccion 2"}),e.jsx("div",{className:"tab-content",children:e.jsx("p",{className:"textSubtitle",children:"ANALISIS DE RIESGO, CERTIFICADOS DE APOYO Y DOCUMENTOS SOPORTE REQUERIDOS"})})]}),e.jsxs("div",{id:"tab3",className:"tab",children:[e.jsx("a",{href:"#tab3",children:"Seccion 3"}),e.jsx("div",{className:"tab-content",children:e.jsx("p",{className:"textSubtitle",children:"MONITOREO DE GASES"})})]})]})})}),Gl=()=>{w.useForm();const t=Me(),s=D(g=>g.permits.permits),a=he();r.useState(!0);const[h,c]=r.useState(!1),[l,n]=r.useState(!1);r.useState(null);const[o,p]=r.useState(0),[d,i]=r.useState({status:"pending",section1:{completed:!1},section2:{completed:!1},section3:{completed:!1},section4:{completed:!1},section5:{completed:!1},section6:{completed:!1},more:{}}),[N,{isSuccess:f,error:x,reset:j}]=vl(),E=()=>{const g=(s==null?void 0:s.length)>0?s[s.length-1].formNumber:0,m=s.find(S=>S.formNumber===g);(m==null?void 0:m.formNumber)>0&&(m==null?void 0:m.status)!=="pending"?(N(d).then(S=>{t(Je.setPermit(S.data.data))}),p(g+1),u(g+1)):g===0?(N(d).then(S=>{t(Je.setPermit(S.data.data))}),p(g),u(g+1)):(console.log("Permiso creado completado",m),t(Je.setPermit(m)),p(m==null?void 0:m.formNumber),u(m==null?void 0:m.formNumber))},A=()=>{E(),n(!1),c(!1)},u=g=>{const m=JSON.stringify({id:g,value:null});a(`/form/${m}`)};return e.jsx(e.Fragment,{children:e.jsx("div",{className:"",children:e.jsx("div",{className:"col-md",children:e.jsx($,{type:"primary",className:"",onClick:A,children:"Nuevo permiso"})})})})},Ql=()=>{const t=he(),s=D(I=>I.users.user),[a,h]=r.useState([]),[c,l]=r.useState([]),[n,o]=r.useState(!0),[p,d]=r.useState(null),{data:i,isLoading:N,error:f}=gl(),[x,j]=r.useState(!1),[E,A]=r.useState(!1),[u,g]=r.useState(!1),{data:m,isSuccess:S,error:k}=fl(p,{skip:n});r.useEffect(()=>{const I=JSON.parse(localStorage.getItem("tempForm"));(I==null?void 0:I.length)>0&&h(I)},[]),r.useEffect(()=>{if(i&&i.data&&s){const I=i.data.map(L=>({key:L._id,formNumber:L.formNumber,status:L.status,date:J(L.createdAt).format("DD/MM/YYYY HH:MM"),company:L.company||"N/A",location:L.location}));let y=[];s.email!=="root@mail.com"?y=I.filter(L=>L.location===s.location._id):y=I,l(y)}},[i,s]);const F=e.jsxs("div",{className:"",children:[e.jsx("p",{className:"",children:"Completar formulario"}),e.jsx("p",{className:"",children:"ó Editar antes de su aprobación"})]}),v=[{title:"Número",dataIndex:"formNumber",key:"formNumber",render:I=>e.jsx("a",{children:I})},{title:"Fecha",dataIndex:"date",key:"date"},{title:"Estado",dataIndex:"status",key:"status"},{title:"Compañía",dataIndex:"company",key:"company"},{title:"Acciones",key:"action",render:(I,y)=>e.jsxs(De,{size:"middle",children:[Ce.includes(s==null?void 0:s.role)&&y.status==="pending"&&e.jsx(X,{title:"Editar / Completar",content:F,children:e.jsx(Le,{style:{fontSize:20,color:"#008000",marginRight:10},onClick:()=>C(y)})}),e.jsx(X,{title:"Eliminar",children:e.jsx(Dt,{style:{fontSize:20,color:"#FF0000",marginRight:10},onClick:()=>M(y)})}),Ce.includes(s==null?void 0:s.role)&&y.status==="waiting"&&e.jsx(X,{title:"Aprobar",children:e.jsx(Ze,{style:{fontSize:20,color:"#0000FF"},onClick:()=>O(y)})}),Ce.includes(s==null?void 0:s.role)&&y.status==="approved"&&e.jsx(X,{title:"Completar",children:e.jsx(Lt,{style:{fontSize:20,color:"#008000"},onClick:()=>T(y)})}),Ce.includes(s==null?void 0:s.role)&&y.status==="completed"&&e.jsx(X,{title:"Vista Previa",children:e.jsx(Cs,{style:{fontSize:20,color:"#FA9C0C"},onClick:()=>q(y)})})]})}],C=I=>{d(I.key),o(!1)},O=I=>{d(I.key),o(!1),j(!0)},T=I=>{d(I.key),o(!1),A(!0)},q=I=>{d(I.key),o(!1),g(!0)};r.useEffect(()=>{if(m){let I={};x?(I=JSON.stringify({id:m==null?void 0:m.formNumber,value:"5"}),t(`/form/${I}`)):E?(I=JSON.stringify({id:m==null?void 0:m.formNumber,value:"8"}),t(`/form/${I}`)):u?(I=JSON.stringify({id:m==null?void 0:m.formNumber,value:""}),t(`/preview/${I}`)):(I=JSON.stringify({id:m==null?void 0:m.formNumber,value:null}),t(`/form/${I}`))}},[S]);const M=I=>{console.log(I)};return e.jsx(e.Fragment,{children:e.jsx("div",{className:"container",children:e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-12",children:e.jsx(Ne,{dataSource:c,columns:v,scroll:{y:400}})})})})})},Wl=()=>{const[t,s]=r.useState(!0);r.useState(!1);const a=h=>{switch(h){case 1:s(!0);break;default:s(!0);break}};return e.jsx("div",{className:"w-100 h-100 d-flex justify-content-center align-items-cente",children:e.jsxs("div",{className:"",style:{width:"90%",height:"80%"},children:[e.jsx("div",{className:"tabs",children:e.jsx("ul",{className:"tab-container",children:e.jsx("li",{id:"tab1",className:t?"tab activeItem activeList":"tab",children:e.jsx("a",{onClick:()=>a(1),children:"Administración de permisos"})})})}),e.jsx("div",{className:"blockBorder",children:t&&e.jsx(e.Fragment,{children:e.jsxs("div",{children:[e.jsx(ie,{className:"",children:e.jsx("div",{className:"text-center pt-2 w-100",children:e.jsx(Gl,{})})}),e.jsx(ie,{className:"pt-3",children:e.jsx(se,{span:24,children:e.jsx(Ql,{})})})]})})})]})})},Jl={width:"100%",height:"100%",padding:"0px 10px 0px 10px",marginTop:"20px"},Kl={display:"flex",justifyContent:"space-between",padding:"0px 10px 0px 10px",marginTop:"20px",marginBottom:"10px"},Xl={fontSize:"20px",fontWeight:500,color:"blue"},Zl={fontSize:"20px",fontWeight:100,color:"black"},en={marginLeft:"10px",fontSize:"20px",fontWeight:400,color:"red",border:"1px solid lightgrey",padding:"0px 20px 0px 20px",borderRadius:"5px"},sn={display:"flex",justifyContent:"space-between"},hs={marginBottom:"10px"},tn=()=>{const t="https://hocolapi.joselimardo.com/",s=D(u=>u.permits.permit),{token:a}=de(),h=r.useRef(null),[c,l]=r.useState(!1),[n,o]=r.useState(!1),[p,{isSuccess:d,error:i,reset:N}]=xe(),f=async(u,g)=>{const m=await ss("upload",a,u);if(m.status===200){const S=`${t}/${m.data.url}`;x(S)}else console.log("ERROR PDF >>>",m)},x=async u=>{if(console.log("CREATE EVIDENCE:",u),!(s!=null&&s.more.file)){const g=await Fs("create-evidence",a,{file:u});if(console.log(g),g.status===201){console.log("RESPONSE:",g);const m={...s,more:{...s.more,evidence:g.data.file,pdf:u}};p({id:s._id,data:m}),N()}else if(u){const m={...s,more:{...s.more,pdf:u}};p({id:s._id,data:m}),N()}else te({title:"Error al crear la evidencia",content:"Ha ocurrido un error al crear la evidencia"})}},j=()=>{var g;const u=(g=s==null?void 0:s.more)==null?void 0:g.evidence;u&&window.open(u,"_blank")},E=()=>{var g;const u=(g=s==null?void 0:s.more)==null?void 0:g.pdf;console.log("URL:",u),u&&window.open(u,"_blank")};r.useEffect(()=>{var u;(u=s==null?void 0:s.more)!=null&&u.evidence||A()},[]),r.useEffect(()=>{d&&(l(!0),K({title:"Permiso creado correctamente",content:"El permiso ha sido creado y se ha generado la evidencia"}))},[d]),r.useEffect(()=>{i&&(o(!0),te({title:"Error al crear el permiso",content:"Ha ocurrido un error al crear el permiso"}))},[i]);const A=()=>{Es(h.current).then(u=>{const g=`permiso${s.formNumber}.pdf`,m=u.toDataURL("image/png",.8),S=new ks,k=210,F=u.height*k/u.width;S.addImage(m,"PNG",0,5,k,F);const v=S.output("blob"),C=new FormData;C.append("file",v,g),S.save(g),f(C)})};return e.jsxs("div",{children:[e.jsxs("div",{ref:h,style:Jl,children:[e.jsxs("div",{style:Kl,children:[e.jsx("div",{style:Xl,children:"NORMA CONTROL DE TRABAJO"}),e.jsxs("div",{style:sn,children:[e.jsx("div",{style:Zl,children:"PERMISO DE TRABAJO GENERAL"}),e.jsx("div",{style:en,children:s==null?void 0:s.formNumber})]})]}),e.jsx("div",{style:hs,children:e.jsx(tt,{section1:s==null?void 0:s.section1})}),e.jsx("div",{style:hs,children:e.jsx(at,{section2:s==null?void 0:s.section2})}),e.jsx("div",{children:e.jsx(lt,{section3:s==null?void 0:s.section3})}),e.jsx("div",{children:e.jsx(nt,{section4:s==null?void 0:s.section4})})]}),e.jsx("div",{className:"",children:e.jsx(X,{title:"Ver PDF",children:e.jsx(Be,{onClick:E,icon:e.jsx(As,{style:{color:"red"}}),style:{right:94},children:"Descargar PDF"})})}),e.jsx("div",{className:"",children:e.jsx(X,{title:"Ver Evidencia",children:e.jsx(Be,{onClick:j,icon:e.jsx(Is,{style:{color:"green"}}),style:{right:24},children:"Ver Evidencia"})})})]})},an=()=>{var x,j,E,A,u,g,m,S,k,F;ws();const t="https://hocolapi.joselimardo.com/",s=D(v=>v.assets.asset),{token:a}=de(),h=r.useRef(null),[c,{isSuccess:l,error:n,reset:o}]=ts(),p=async v=>{const C=await ss("upload",a,v);if(C.status===200){const O=`${t}/${C.data.url}`;d(O)}else console.log("ERROR PDF >>>",C)},d=async v=>{var C,O;if(!((O=(C=s[0])==null?void 0:C.more)!=null&&O.file)){const T=await Fs("create-evidence",a,{file:v});if(T.status===201){const q={...s[0],more:{...s[0].more,evidence:T.data.file,pdf:v}};c({id:s[0]._id,data:q}),o()}else if(v){const q={...s[0],more:{...s[0].more,pdf:v}};c({id:s[0]._id,data:q}),o()}else te({title:"Error al crear la evidencia",content:"Ha ocurrido un error al crear la evidencia"})}},i=()=>{if(!h.current){console.error("Reference to DOM element is invalid.");return}Es(h.current).then(v=>{var L;const C=`asset${((L=s[0])==null?void 0:L.internalId)||"default"}.pdf`,O=v.toDataURL("image/png",.8),T=new ks,q=210,M=v.height*q/v.width;T.addImage(O,"PNG",0,5,q,M);const I=T.output("blob"),y=new FormData;y.append("file",I,C),T.save(C),p(y)}).catch(v=>{console.error("Error capturing the element:",v)})};r.useEffect(()=>{var v,C;(C=(v=s[0])==null?void 0:v.more)!=null&&C.evidence||i()},[s[0]._id]),r.useEffect(()=>{l&&K({title:"Activo creado correctamente",content:"El activo ha sido creado y se ha generado la evidencia"})},[l]),r.useEffect(()=>{n&&te({title:"Error al crear el activo",content:"Ha ocurrido un error al crear el activo"})},[n]);const N=()=>{var C,O;const v=(O=(C=s[0])==null?void 0:C.more)==null?void 0:O.evidence;v&&window.open(v,"_blank")},f=()=>{var C,O;const v=(O=(C=s[0])==null?void 0:C.more)==null?void 0:O.pdf;v&&window.open(v,"_blank")};return e.jsxs("div",{children:[e.jsx("div",{ref:h,children:e.jsxs("div",{className:"container",children:[e.jsxs("div",{className:"d-flex flex-direction-row",children:[e.jsxs("span",{className:"p-1 bg-secondary text-white text-center section-title",style:{width:"25%"},children:["Nombre del activo:"," "]}),e.jsx("div",{className:"section-title d-flex justify-content-start align-items-center",style:{width:"75%"},children:s[0].assetName})]}),e.jsxs("div",{className:"container",children:[e.jsxs("div",{className:"row pt-3",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs("p",{className:"section-label",children:["Tipo: ",e.jsx("span",{className:"",children:(x=s[0])==null?void 0:x.assetType})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("p",{className:"section-label",children:["Categoria: ",e.jsx("span",{className:"",children:(j=s[0])==null?void 0:j.assetCategory})]})})]}),e.jsxs("div",{className:"row pt-2",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs("p",{className:"section-label",children:["Marca: ",e.jsx("span",{className:"",children:(E=s[0])==null?void 0:E.assetMake})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("p",{className:"section-label",children:["Modelo: ",e.jsx("span",{className:"",children:(A=s[0])==null?void 0:A.assetModel})]})})]}),e.jsxs("div",{className:"row pt-2",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs("p",{className:"section-label",children:["Año: ",e.jsx("span",{className:"",children:(u=s[0])==null?void 0:u.assetYear})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("p",{className:"section-label",children:["Número de motor:"," ",e.jsx("span",{className:"",children:(g=s[0])==null?void 0:g.engineNo})]})})]}),e.jsxs("div",{className:"row pt-2",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs("p",{className:"section-label",children:["Número de chasis:"," ",e.jsx("span",{className:"",children:(m=s[0])==null?void 0:m.chassisNo})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("p",{className:"section-label",children:["Color: ",e.jsx("span",{className:"",children:"N/A"})]})})]}),e.jsxs("div",{className:"row pt-2",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs("p",{className:"section-label",children:["Placa: ",e.jsx("span",{className:"",children:"N/A"})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("p",{className:"section-label",children:["VIN: ",e.jsx("span",{className:"",children:"N/A"})]})})]}),e.jsxs("div",{className:"row pt-2",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs("p",{className:"section-label",children:["ID interno: ",e.jsx("span",{className:"",children:(S=s[0])==null?void 0:S.internalId})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("p",{className:"section-label",children:["Ubicación:"," ",e.jsx("span",{className:"",children:(F=(k=s[0])==null?void 0:k.location)==null?void 0:F.locationName})]})})]})]})]})}),e.jsx("div",{className:"",children:e.jsx(X,{title:"Ver PDF",children:e.jsx(Be,{onClick:f,icon:e.jsx(As,{style:{color:"red"}}),style:{right:94},children:"Descargar PDF"})})}),e.jsx("div",{className:"",children:e.jsx(X,{title:"Ver Evidencia",children:e.jsx(Be,{onClick:N,icon:e.jsx(Is,{style:{color:"green"}}),style:{right:24},children:"Ver Evidencia"})})})]})};function ln(){const{isLoggedIn:t,logout:s}=de(),[a,h]=r.useState(!1);r.useEffect(()=>{localStorage.setItem("lastActivity",Date.now().toString());const o=2*60*60*1e3,p=setTimeout(()=>{h(!0),s()},o),d=()=>{localStorage.setItem("lastActivity",Date.now().toString()),clearTimeout(p),setTimeout(()=>{h(!0),s()},o)};return document.addEventListener("mousemove",d),document.addEventListener("keydown",d),()=>{document.removeEventListener("mousemove",d),document.removeEventListener("keydown",d),clearTimeout(p)}},[]),r.useEffect(()=>{a===!0&&tl({title:"Sesión expirada",content:"Su sesión ha expirado. Por favor, vuelva a iniciar sesión."})},[a]);const c=rs(is(e.jsx(le,{element:e.jsx(Bl,{}),children:e.jsxs(le,{element:e.jsx(sl,{}),errorElement:e.jsx(Ma,{}),children:[e.jsx(le,{path:"/",element:e.jsx(Ra,{})}),e.jsx(le,{path:"/settings",element:e.jsx(xl,{})}),e.jsx(le,{path:"/assets-settings",element:e.jsx(Hl,{})}),e.jsx(le,{path:"/reports",element:e.jsx(pl,{})}),e.jsx(le,{path:"/form/:id",element:e.jsx(Tl,{})}),e.jsx(le,{path:"/hot-work",element:e.jsx(Yl,{})}),e.jsx(le,{path:"/add-user",element:e.jsx(Ks,{})}),e.jsx(le,{path:"/permissions",element:e.jsx(Wl,{})}),e.jsx(le,{path:"/preview/:id",element:e.jsx(tn,{})}),e.jsx(le,{path:"/asset-preview/:id",element:e.jsx(an,{})}),e.jsx(le,{path:"*",element:e.jsx(os,{})})]})}))),l=rs(is(e.jsxs(le,{children:[e.jsx(le,{path:"/",element:e.jsx(Dl,{})}),e.jsx(le,{path:"*",element:e.jsx(os,{})})]}))),n=t?c:l;return e.jsx(e.Fragment,{children:e.jsx(Ut,{router:n})})}Pe.defaults.baseURL="https://hocolapi.joselimardo.com/api";console.log("API SERVER: ",Pe.defaults.baseURL);qt.createRoot(document.getElementById("root")).render(e.jsx($t.StrictMode,{children:e.jsx(_t,{store:Ye,children:e.jsx(Aa,{children:e.jsx(ln,{})})})}));
